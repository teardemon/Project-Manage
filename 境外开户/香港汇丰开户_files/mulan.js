(function(){var baidu=baidu||{version:"1-1-0"};baidu.ajax=baidu.ajax||{};baidu.ajax.form=function(A,C){C=C||{};var F=A.elements,M=F.length,B=A.getAttribute("method"),E=A.getAttribute("action"),S=C.replacer||function(U,T){return U},P={},R=[],K,O,Q,L,D,G,H,J,I;function N(T,U){R.push(T+"="+U)}for(K in C){if(C.hasOwnProperty(K)){P[K]=C[K]}}for(K=0;K<M;K++){O=F[K];L=O.name;if(!O.disabled&&L){Q=O.type;D=O.value;switch(Q){case"radio":case"checkbox":if(!O.checked){break}case"textarea":case"text":case"password":case"hidden":case"select-one":N(L,S(D,L));break;case"select-multiple":G=O.options;J=G.length;for(H=0;H<J;H++){I=G[H];if(I.selected){N(L,S(I.value,L))}}break}}}P.data=R.join("&");P.method=A.getAttribute("method")||"POST";return baidu.ajax.request(E,P)};baidu.ajax.get=function(B,A){return baidu.ajax.request(B,{onsuccess:A})};baidu.ajax.post=function(B,C,A){return baidu.ajax.request(B,{onsuccess:A,method:"POST",data:C})};baidu.ajax.request=function(D,O){function J(){if(N.readyState==4){try{var Q=N.status}catch(P){E("failure");return }E(Q);if((Q>=200&&Q<300)||Q==304||Q==1223){E("success")}else{E("failure")}window.setTimeout(function(){N.onreadystatechange=new Function();if(G){N=null}},0)}}function C(){if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(P){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(P){}}}if(window.XMLHttpRequest){return new XMLHttpRequest()}}function E(Q){Q="on"+Q;var P=B[Q],R=baidu.ajax[Q];if(P){if(Q!="onsuccess"){P(N)}else{P(N,N.responseText)}}else{if(R){if(Q=="onsuccess"){return }R(N)}}}O=O||{};var I=O.data||"",G=!(O.async===false),H=O.username||"",M=O.password||"",A=(O.method||"GET").toUpperCase(),F=O.headers||{},B={},L,N;for(L in O){B[L]=O[L]}F["X-Request-By"]="baidu.ajax";try{N=C();if(A=="GET"){D+=(D.indexOf("?")>=0?"&":"?");if(I){D+=I+"&";I=null}D+="b"+(new Date()).getTime()+"=1"}if(H){N.open(A,D,G,H,M)}else{N.open(A,D,G)}if(G){N.onreadystatechange=J}if(A=="POST"){N.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}for(L in F){if(F.hasOwnProperty(L)){N.setRequestHeader(L,F[L])}}E("beforerequest");N.send(I);if(!G){J()}}catch(K){E("failure")}return N};baidu.array=baidu.array||{};baidu.array.each=function(F,D){var C,E,B,A=F.length;if("function"==typeof D){for(B=0;B<A;B++){E=F[B];C=D.call(F,E,B);if(C===false){break}}}return F};baidu.each=baidu.array.each;baidu.array.filter=function(G,E){var C=[],B=0,A=G.length,F,D;if("function"==typeof E){for(D=0;D<A;D++){F=G[D];if(true===E.call(G,F,D)){C[B++]=F}}}return C};baidu.array.find=function(E,C){var D,B,A=E.length;if("function"==typeof C){for(B=0;B<A;B++){D=E[B];if(true===C.call(E,D,B)){return D}}}return null};baidu.array.indexOf=function(D,E,B){var A=D.length,C=E;B=Number(B)||0;B=B<0?Math.ceil(B):Math.floor(B);B=Math.min(Math.max(B,0),A);if("function"!=typeof E){C=function(F){return E===F}}for(;B<A;B++){if(true===C.call(D,D[B],B)){return B}}return -1};baidu.array.lastIndexOf=function(C,D){var A=C.length,B=D;if("function"!=typeof D){B=function(E){return D===E}}while(A--){if(true===B.call(C,C[A],A)){return A}}return -1};baidu.array.remove=function(C,D){var A=C.length,B=D;if("function"!=typeof D){B=function(E){return D===E}}while(A--){if(true===B.call(C,C[A],A)){C.splice(A,1)}}};baidu.array.removeAt=function(B,A){return B.splice(A,1)[0]};baidu.array.unique=function(E,F){var B=E.length,A=E.slice(0),D,C;if("function"!=typeof F){F=function(H,G){return H===G}}while(--B>0){C=A[B];D=B-1;while(D--){if(F(C,A[D])){A.splice(B,1);break}}}return A};baidu.browser=baidu.browser||{};if(/chrome\/(\d+\.\d)/i.test(navigator.userAgent)){baidu.browser.chrome=parseFloat(RegExp["\x241"])}if(/firefox\/(\d+\.\d)/i.test(navigator.userAgent)){baidu.browser.firefox=parseFloat(RegExp["\x241"])}if(/msie (\d+\.\d)/i.test(navigator.userAgent)){baidu.ie=baidu.browser.ie=parseFloat(RegExp["\x241"])}baidu.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);baidu.browser.isStrict=document.compatMode=="CSS1Compat";baidu.browser.isWebkit=/webkit/i.test(navigator.userAgent);try{if(/(\d+\.\d)/.test(external.max_version)){baidu.browser.maxthon=parseFloat(RegExp["\x241"])}}catch(e){}if(/opera\/(\d+\.\d)/i.test(navigator.userAgent)){baidu.browser.opera=parseFloat(RegExp["\x241"])}if((/(\d+\.\d)(\.\d)?\s+safari/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent))){baidu.browser.safari=parseFloat(RegExp["\x241"])}baidu.cookie=baidu.cookie||{};baidu.cookie._isValidKey=function(A){return(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+\x24')).test(A)};baidu.cookie.get=function(A){var B=baidu.cookie.getRaw(A);if("string"==typeof B){B=decodeURIComponent(B);return B}return null};baidu.cookie.getRaw=function(B){if(baidu.cookie._isValidKey(B)){var C=new RegExp("(^| )"+B+"=([^;]*)(;|\x24)"),A=C.exec(document.cookie);if(A){return A[2]||null}}return null};baidu.cookie.remove=function(A){baidu.cookie.setRaw(A,"",{expires:new Date(0)})};baidu.cookie.set=function(B,C,A){baidu.cookie.setRaw(B,encodeURIComponent(C),A)};baidu.cookie.setRaw=function(C,D,B){if(!baidu.cookie._isValidKey(C)){return }B=B||{};var A=B.expires;if("number"==typeof B.expires){A=new Date();A.setTime(A.getTime()+B.expires)}document.cookie=C+"="+D+(B.path?"; path="+B.path:"")+(A?"; expires="+A.toGMTString():"")+(B.domain?"; domain="+B.domain:"")+(B.secure?"; secure":"")};baidu.date=baidu.date||{};baidu.date.format=function(A,F){if("string"!=typeof F){return A.toString()}function D(L,K){F=F.replace(L,K)}var B=baidu.number.pad,G=A.getFullYear(),E=A.getMonth()+1,J=A.getDate(),H=A.getHours(),C=A.getMinutes(),I=A.getSeconds();D(/yyyy/g,B(G,4));D(/yy/g,B(G.toString().slice(2),2));D(/MM/g,B(E,2));D(/M/g,E);D(/dd/g,B(J,2));D(/d/g,J);D(/HH/g,B(H,2));D(/H/g,H);D(/hh/g,B(H%12,2));D(/h/g,H%12);D(/mm/g,B(C,2));D(/m/g,C);D(/ss/g,B(I,2));D(/s/g,I);return F};baidu.date.parse=function(C){var A=new RegExp("^\\d+(\\-|\\/)\\d+(\\-|\\/)\\d+\x24");if("string"==typeof C){if(A.test(C)||isNaN(Date.parse(C))){var E=C.split(/ |T/),B=E.length>1?E[1].split(/[^\d]/):[0,0,0],D=E[0].split(/[^\d]/);return new Date(D[0]-0,D[1]-1,D[2]-0,B[0]-0,B[1]-0,B[2]-0)}else{return new Date(C)}}return new Date()};baidu.dom=baidu.dom||{};baidu.dom._NAME_ATTRS=(function(){var A={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};if(baidu.browser.ie<8){A["for"]="htmlFor";A["class"]="className"}else{A.htmlFor="for";A.className="class"}return A})();baidu.dom._matchNode=function(A,C,D){A=baidu.dom.g(A);for(var B=A[D];B;B=B[C]){if(B.nodeType==1){return B}}return null};baidu.dom._styleFilter=baidu.dom._styleFilter||[];baidu.dom._styleFilter[baidu.dom._styleFilter.length]={get:function(C,D){if(/color/i.test(C)&&D.indexOf("rgb(")!=-1){var E=D.split(",");D="#";for(var B=0,A;A=E[B];B++){A=parseInt(A.replace(/[^\d]/gi,""),10).toString(16);D+=A.length==1?"0"+A:A}D=D.toUpperCase()}return D}};baidu.dom._styleFilter.filter=function(B,E,F){for(var A=0,D=baidu.dom._styleFilter,C;C=D[A];A++){if(C=C[F]){E=C(B,E)}}return E};baidu.dom._styleFilter[baidu.dom._styleFilter.length]={set:function(A,B){if(B.constructor==Number&&!/zIndex|fontWeight|opacity|zoom|lineHeight/i.test(A)){B=B+"px"}return B}};baidu.dom._styleFixer=baidu.dom._styleFixer||{};baidu.dom._styleFixer.display=baidu.browser.ie&&baidu.browser.ie<7?{set:function(A,B){A=A.style;if(B=="inline-block"){A.display="inline";A.zoom=1}else{A.display=B}}}:baidu.browser.firefox&&baidu.browser.firefox<3?{set:function(A,B){A.style.display=B=="inline-block"?"-moz-inline-box":B}}:null;baidu.dom._styleFixer["float"]=baidu.browser.ie?"styleFloat":"cssFloat";baidu.dom._styleFixer.opacity=baidu.browser.ie?{get:function(A){var B=A.style.filter;B&&B.indexOf("opacity=")>=0?(parseFloat(B.match(/opacity=([^)]*)/)[1])/100)+"":"1"},set:function(A,C){var B=A.style;B.filter=(B.filter||"").replace(/alpha\([^\)]*\)/gi,"")+(C==1?"":"alpha(opacity="+C*100+")");B.zoom=1}}:null;baidu.dom._styleFixer.textOverflow=(function(){var B={};function A(E){var F=E.length;if(F>0){F=E[F-1];E.length--}else{F=null}return F}function C(E,F){E[baidu.browser.firefox?"textContent":"innerText"]=F}function D(M,H,Q){var J=baidu.browser.ie?M.currentStyle||M.style:getComputedStyle(M,null),P=J.fontWeight,O="font-family:"+J.fontFamily+";font-size:"+J.fontSize+";word-spacing:"+J.wordSpacing+";font-weight:"+((parseInt(P)||0)==401?700:P)+";font-style:"+J.fontStyle+";font-variant:"+J.fontVariant,E=B[O];if(!E){J=M.appendChild(document.createElement("div"));J.style.cssText="float:left;"+O;E=B[O]=[];for(L=0;L<256;L++){L==32?(J.innerHTML="&nbsp;"):C(J,String.fromCharCode(L));E[L]=J.offsetWidth}C(J,"\u4e00");E[256]=J.offsetWidth;C(J,"\u4e00\u4e00");E[257]=J.offsetWidth-E[256]*2;E[258]=E[".".charCodeAt(0)]*3+E[257]*3;M.removeChild(J)}for(var K=M.firstChild,N=E[256],G=E[257],F=E[258],S=[],Q=Q?F:0;K;K=K.nextSibling){if(H<Q){M.removeChild(K)}else{if(K.nodeType==3){for(var L=0,R=K.nodeValue,I=R.length;L<I;L++){J=R.charCodeAt(L);S[S.length]=[H,K,L];H-=(L?G:0)+(J<256?E[J]:N);if(H<Q){break}}}else{J=K.tagName;if(J=="IMG"||J=="TABLE"){J=K;K=K.previousSibling;M.removeChild(J)}else{S[S.length]=[H,K];H-=K.offsetWidth}}}}if(H<Q){while(J=A(S)){H=J[0];K=J[1];J=J[2];if(K.nodeType==3){if(H>=F){K.nodeValue=K.nodeValue.substring(0,J)+"...";return true}else{if(!J){M.removeChild(K)}}}else{if(D(K,H,true)){return true}else{M.removeChild(K)}}}M.innerHTML=""}}return{get:function(F,G){var E=baidu.browser;return(E.opera?G.OTextOverflow:E.firefox?F._baiduOverflow:G.textOverflow)||"clip"},set:function(F,H){var E=baidu.browser;if(F.tagName=="TD"||F.tagName=="TH"||E.firefox){F._baiduHTML&&(F.innerHTML=F._baiduHTML);if(H=="ellipsis"){F._baiduHTML=F.innerHTML;var I=document.createElement("div"),G=F.appendChild(I).offsetWidth;F.removeChild(I);D(F,G)}else{F._baiduHTML=""}}I=F.style;E.opera?(I.OTextOverflow=H):E.firefox?(F._baiduOverflow=H):(I.textOverflow=H)}}})();baidu.dom.addClass=function(D,E){D=baidu.dom.g(D);var B=baidu.string.trim,C=B(E).split(/\s+/),A=C.length;E=D.className.split(/\s+/).join(" ");while(A--){(new RegExp("(^| )"+C[A]+"( |\x24)")).test(E)&&C.splice(A,1)}D.className=B(E+" "+C.join(" "));return D};baidu.addClass=baidu.dom.addClass;baidu.dom.children=function(B){B=baidu.dom.g(B);for(var A=[],C=B.firstChild;C;C=C.nextSibling){if(C.nodeType==1){A.push(C)}}return A};baidu.dom.contains=function(A,B){var C=baidu.dom.g;A=C(A);B=C(B);return A.contains?A!=B&&A.contains(B):!!(A.compareDocumentPosition(B)&16)};baidu.dom.first=function(A){return baidu.dom._matchNode(A,"nextSibling","firstChild")};baidu.dom.g=function(A){if("string"==typeof A||A instanceof String){return document.getElementById(A)}else{if(A&&A.nodeName&&(A.nodeType==1||A.nodeType==9)){return A}}return null};baidu.g=baidu.G=baidu.dom.g;baidu.dom.getAncestorBy=function(A,B){A=baidu.dom.g(A);while((A=A.parentNode)&&A.nodeType==1){if(B(A)){return A}}return null};baidu.dom.getAncestorByClass=function(A,B){A=baidu.dom.g(A);B=new RegExp("(^|\\s)"+baidu.string.trim(B)+"(\\s|\x24)");while((A=A.parentNode)&&A.nodeType==1){if(B.test(A.className)){return A}}return null};baidu.dom.getAncestorByTag=function(B,A){B=baidu.dom.g(B);A=A.toUpperCase();while((B=B.parentNode)&&B.nodeType==1){if(B.tagName==A){return B}}return null};baidu.dom.getAttr=function(B,A){B=baidu.dom.g(B);if("style"==A){return B.style.cssText}A=baidu.dom._NAME_ATTRS[A]||A;return B.getAttribute(A)};baidu.getAttr=baidu.dom.getAttr;baidu.dom.getDocument=function(A){A=baidu.dom.g(A);return A.nodeType==9?A:A.ownerDocument||A.document};baidu.dom.getPosition=function(B){var H=baidu.dom.getDocument(B),E=baidu.browser;B=baidu.dom.g(B);var C=E.isGecko>0&&H.getBoxObjectFor&&baidu.dom.getStyle(B,"position")=="absolute"&&(B.style.top===""||B.style.left==="");var G={left:0,top:0};var F=(E.ie&&!E.isStrict)?H.body:H.documentElement;if(B==F){return G}var I=null;var D;if(B.getBoundingClientRect){D=B.getBoundingClientRect();G.left=Math.floor(D.left)+Math.max(H.documentElement.scrollLeft,H.body.scrollLeft);G.top=Math.floor(D.top)+Math.max(H.documentElement.scrollTop,H.body.scrollTop);G.left-=H.documentElement.clientLeft;G.top-=H.documentElement.clientTop;if(E.ie&&!E.isStrict){G.left-=2;G.top-=2}}else{if(H.getBoxObjectFor&&!C){D=H.getBoxObjectFor(B);var A=H.getBoxObjectFor(F);G.left=D.screenX-A.screenX;G.top=D.screenY-A.screenY}else{I=B;do{G.left+=I.offsetLeft;G.top+=I.offsetTop;if(E.isWebkit>0&&baidu.dom.getStyle(I,"position")=="fixed"){G.left+=H.body.scrollLeft;G.top+=H.body.scrollTop;break}I=I.offsetParent}while(I&&I!=B);if(E.opera>0||(E.isWebkit>0&&baidu.dom.getStyle(B,"position")=="absolute")){G.top-=H.body.offsetTop}I=B.offsetParent;while(I&&I!=H.body){G.left-=I.scrollLeft;if(!b.opera||I.tagName!="TR"){G.top-=I.scrollTop}I=I.offsetParent}}}return G};baidu.dom.getStyle=function(C,B){var F=baidu.dom;C=F.g(C);B=baidu.string.toCamelCase(B);var E=C.style[B];if(!E){var A=F._styleFixer[B],D=C.currentStyle||(baidu.browser.ie?C.style:getComputedStyle(C,null));if("string"==typeof A){E=D[A]}else{if(A&&A.get){E=A.get(C,D)}else{E=D[B]}}}if(A=F._styleFilter){E=A.filter(B,E,"get")}return E};baidu.getStyle=baidu.dom.getStyle;baidu.dom.getWindow=function(A){A=baidu.dom.g(A);var B=baidu.dom.getDocument(A);return B.parentWindow||B.defaultView||null};baidu.dom.hide=function(A){A=baidu.dom.g(A);A.style.display="none";return A};baidu.hide=baidu.dom.hide;baidu.dom.insertAfter=function(D,C){var B,A;B=baidu.dom.g;D=B(D);C=B(C);A=C.parentNode;if(A){A.insertBefore(D,C.nextSibling)}return D};baidu.dom.insertBefore=function(D,C){var B,A;B=baidu.dom.g;D=B(D);C=B(C);A=C.parentNode;if(A){A.insertBefore(D,C)}return D};baidu.dom.insertHTML=function(E,A,D){E=baidu.dom.g(E);if(E.insertAdjacentHTML){E.insertAdjacentHTML(A,D)}else{var B=E.ownerDocument.createRange();B.setStartBefore(E);var C=B.createContextualFragment(D),G=E.parentNode,F;switch(A.toUpperCase()){case"BEFOREBEGIN":G.insertBefore(C,E);break;case"AFTERBEGIN":E.insertBefore(C,E.firstChild);break;case"BEFOREEND":E.appendChild(C);break;case"AFTEREND":(F=E.nextSibling)?G.insertBefore(C,F):G.appendChild(C)}}};baidu.insertHTML=baidu.dom.insertHTML;baidu.dom.intersect=function(H,G){var F=baidu.dom.g,E=baidu.dom.getPosition,A=Math.max,C=Math.min;H=F(H);G=F(G);var D=E(H),B=E(G);return A(D.left,B.left)<=C(D.left+H.offsetWidth,B.left+G.offsetWidth)&&A(D.top,B.top)<=C(D.top+H.offsetHeight,B.top+G.offsetHeight)};baidu.dom.last=function(A){return baidu.dom._matchNode(A,"previousSibling","lastChild")};baidu.dom.next=function(A){return baidu.dom._matchNode(A,"nextSibling","nextSibling")};baidu.dom.prev=function(A){return baidu.dom._matchNode(A,"previousSibling","previousSibling")};baidu.dom.q=function(H,E,B){var I=[],D=baidu.string.trim,G,F,A,C;if(!(H=D(H))){return null}if("undefined"==typeof E){E=document}else{E=baidu.dom.g(E);if(!E){return I}}B&&(B=D(B).toUpperCase());if(E.getElementsByClassName){A=E.getElementsByClassName(H);G=A.length;for(F=0;F<G;F++){C=A[F];if(B&&C.tagName!=B){continue}I[I.length]=C}}else{H=new RegExp("(^|\\s)"+baidu.string.escapeReg(H)+"(\\s|\x24)");A=B?E.getElementsByTagName(B):(E.all||E.getElementsByTagName("*"));G=A.length;for(F=0;F<G;F++){C=A[F];H.test(C.className)&&(I[I.length]=C)}}return I};baidu.q=baidu.Q=baidu.dom.q;baidu.dom.ready=function(){var C=false,E=false,D=[];function A(){if(!C){C=true;for(var G=0,F=D.length;G<F;G++){try{D[G]()}catch(H){}}}}function B(){if(E){return }E=true;var I=document,G=window,F=baidu.browser.opera;if(I.addEventListener&&!F){I.addEventListener("DOMContentLoaded",F?function(){if(C){return }for(var J=0;J<I.styleSheets.length;J++){if(I.styleSheets[J].disabled){setTimeout(arguments.callee,0);return }}A()}:A,false)}else{if(baidu.browser.ie&&G==top){(function(){if(C){return }try{I.documentElement.doScroll("left")}catch(J){setTimeout(arguments.callee,0);return }A()})()}else{if(baidu.browser.safari){var H;(function(){if(C){return }if(I.readyState!="loaded"&&I.readyState!="complete"){setTimeout(arguments.callee,0);return }if(H===undefined){H=0;var M=I.getElementsByTagName("style");var K=I.getElementsByTagName("link");if(M){H+=M.length}if(K){for(var L=0,J=K.length;L<J;L++){if(K[L].getAttribute("rel")=="stylesheet"){H++}}}}if(I.styleSheets.length!=H){setTimeout(arguments.callee,0);return }A()})()}}}G.attachEvent?G.attachEvent("onload",A):G.addEventListener("load",A,false)}return function(F){B();C?F():(D[D.length]=F)}}();baidu.dom.remove=function(A){A=baidu.dom.g(A);if("HTML BODY HEAD".indexOf(A.nodeName)==-1){if(baidu.browser.ie){var B=document.createElement("DIV");B.appendChild(A);B.innerHTML=""}else{(B=A.parentNode)&&B.removeChild(A)}}};baidu.dom.removeClass=function(B,C){B=baidu.dom.g(B);var A=baidu.string.trim;B.className=A(B.className.split(/\s+/).join("  ").replace(new RegExp("(^| )("+A(C).split(/\s+/).join("|")+")( |\x24)","g")," ").replace(/\s+/g," "));return B};baidu.removeClass=baidu.dom.removeClass;baidu.dom.setAttr=function(B,A,C){B=baidu.dom.g(B);if("style"==A){B.style.cssText=C}else{A=baidu.dom._NAME_ATTRS[A]||A;B.setAttribute(A,C)}return B};baidu.setAttr=baidu.dom.setAttr;baidu.dom.setAttrs=function(C,A){C=baidu.dom.g(C);for(var B in A){baidu.dom.setAttr(C,B,A[B])}return C};baidu.setAttrs=baidu.dom.setAttrs;baidu.dom.setStyle=function(C,B,D){var E=baidu.dom,A;C=E.g(C);B=baidu.string.toCamelCase(B);if(A=E._styleFilter){D=A.filter(B,D,"set")}A=E._styleFixer[B];(A&&A.set)?A.set(C,D):(C.style[A||B]=D);return C};baidu.setStyle=baidu.dom.setStyle;baidu.dom.setStyles=function(B,C){B=baidu.dom.g(B);for(var A in C){baidu.dom.setStyle(B,A,C[A])}return B};baidu.setStyles=baidu.dom.setStyles;baidu.dom.show=function(A){A=baidu.dom.g(A);A.style.display="";return A};baidu.show=baidu.dom.show;baidu.dom.toggle=function(A){A=baidu.dom.g(A);A.style.display=A.style.display=="none"?"":"none";return A};baidu.event=baidu.event||{};baidu.event.EventArg=function(C,E){E=E||window;C=C||E.event;var D=E.document;this.target=C.srcElement;this.keyCode=C.which;for(var A in C){var B=C[A];if("function"!=typeof B){this[A]=B}}if(!this.pageX&&this.pageX!==0){this.pageX=(C.clientX||0)+(D.documentElement.scrollLeft||D.body.scrollLeft);this.pageY=(C.clientY||0)+(D.documentElement.scrollTop||D.body.scrollTop)}this._event=C};baidu.event.EventArg.prototype.preventDefault=function(){if(this._event.preventDefault){this._event.preventDefault()}else{this._event.returnValue=false}return this};baidu.event.EventArg.prototype.stopPropagation=function(){if(this._event.stopPropagation){this._event.stopPropagation()}else{this._event.cancelBubble=true}return this};baidu.event.EventArg.prototype.stop=function(){return this.stopPropagation().preventDefault()};baidu.event._listeners=baidu.event._listeners||[];baidu.event._unload=function(){var C=baidu.event._listeners,A=C.length,B=!!window.removeEventListener,E,D;while(A--){E=C[A];D=E[0];if(D.removeEventListener){D.removeEventListener(E[1],E[3],false)}else{if(D.detachEvent){D.detachEvent("on"+E[1],E[3])}}}if(B){window.removeEventListener("unload",baidu.event._unload,false)}else{window.detachEvent("onunload",baidu.event._unload)}};if(window.attachEvent){window.attachEvent("onunload",baidu.event._unload)}else{window.addEventListener("unload",baidu.event._unload,false)}baidu.event.get=function(A,B){return new baidu.event.EventArg(A,B)};baidu.event.getKeyCode=function(A){return A.which||A.keyCode};baidu.event.getPageX=function(B){var A=B.pageX,C=document;if(!A&&A!==0){A=(B.clientX||0)+(C.documentElement.scrollLeft||C.body.scrollLeft)}return A};baidu.event.getPageY=function(B){var A=B.pageY,C=document;if(!A&&A!==0){A=(B.clientY||0)+(C.documentElement.scrollTop||C.body.scrollTop)}return A};baidu.event.getTarget=function(A){return A.target||A.srcElement};baidu.event.on=function(B,D,E){D=D.replace(/^on/i,"");if("string"==typeof B){B=baidu.dom.g(B)}var C=function(F){E.call(B,F)},A=baidu.event._listeners;A[A.length]=[B,D,E,C];if(B.addEventListener){B.addEventListener(D,C,false)}else{if(B.attachEvent){B.attachEvent("on"+D,C)}}return B};baidu.on=baidu.event.on;baidu.event.preventDefault=function(A){if(A.preventDefault){A.preventDefault()}else{A.returnValue=false}};baidu.event.stop=function(A){var B=baidu.event;B.stopPropagation(A);B.preventDefault(A)};baidu.event.stopPropagation=function(A){if(A.stopPropagation){A.stopPropagation()}else{A.cancelBubble=true}};baidu.event.un=function(C,D,F){if("string"==typeof C){C=baidu.dom.g(C)}D=D.replace(/^on/i,"");var B=baidu.event._listeners,A=B.length,G=!F,E;while(A--){E=B[A];if(E[1]===D&&E[0]===C&&(G||E[2]===F)){if(C.removeEventListener){C.removeEventListener(D,E[3],false)}else{if(C.detachEvent){C.detachEvent("on"+D,E[3])}}B.splice(A,1)}}return C};baidu.un=baidu.event.un;baidu.json=baidu.json||{};baidu.json.decode=function(A){return baidu.json.parse(A)};baidu.json.encode=function(A){return baidu.json.stringify(A)};baidu.json.parse=function(source){return eval("("+source+")")};baidu.json.stringify=(function(){var B={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function A(F){if(/["\\\x00-\x1f]/.test(F)){F=F.replace(/["\\\x00-\x1f]/g,function(G){var H=B[G];if(H){return H}H=G.charCodeAt();return"\\u00"+Math.floor(H/16).toString(16)+(H%16).toString(16)})}return'"'+F+'"'}function D(K){var G=["["],H=K.length,F,I,J;for(I=0;I<H;I++){J=K[I];switch(typeof J){case"undefined":case"function":case"unknown":break;default:if(F){G.push(",")}G.push(baidu.json.stringify(J));F=1}}G.push("]");return G.join("")}function C(F){return F<10?"0"+F:F}function E(F){return'"'+F.getFullYear()+"-"+C(F.getMonth()+1)+"-"+C(F.getDate())+"T"+C(F.getHours())+":"+C(F.getMinutes())+":"+C(F.getSeconds())+'"'}return function(J){switch(typeof J){case"undefined":return"undefined";case"number":return isFinite(J)?String(J):"null";case"string":return A(J);case"boolean":return String(J);default:if(J===null){return"null"}else{if(J instanceof Array){return D(J)}else{if(J instanceof Date){return E(J)}else{var G=["{"],I=baidu.json.stringify,F,H;for(key in J){if(J.hasOwnProperty(key)){H=J[key];switch(typeof H){case"undefined":case"unknown":case"function":break;default:if(F){G.push(",")}F=1;G.push(I(key)+":"+I(H))}}}G.push("}");return G.join("")}}}}}})();baidu.lang=baidu.lang||{};baidu.lang.Class=function(A){this.guid=A||baidu.lang.Class.guid();baidu.lang._instances[this.guid]=this};baidu.lang.Class.guid=function(){return"TANGRAM__"+(baidu.lang._insCounter++).toString(36)};baidu.lang.Class.create=function(B){var C=new baidu.lang.Class();for(var A in B){C[A]=B[A]}return C};baidu.lang.Class.prototype.dispose=function(){if(this.guid){delete baidu.lang._instances[this.guid]}for(var A in this){if(typeof this[A]!="function"){delete this[A]}}};baidu.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};baidu.lang.Event=function(A,B){this.type=A;this.returnValue=true;this.target=B||null;this.currentTarget=null};baidu.lang.Class.prototype.addEventListener=function(D,C,B){if(typeof C!="function"){return }if(!this.__listeners){this.__listeners={}}var A=this.__listeners,E;if(typeof B=="string"&&B){if(/[^\w\-]/.test(B)){throw ("nonstandard key:"+B)}else{C.hashCode=B;E=B}}if(D.indexOf("on")!=0){D="on"+D}if(typeof A[D]!="object"){A[D]={}}E=E||baidu.lang.Class.guid();C.hashCode=E;A[D][E]=C};baidu.lang.Class.prototype.removeEventListener=function(C,B){if(typeof B=="function"){B=B.hashCode}else{if(typeof B!="string"){return }}if(!this.__listeners){this.__listeners={}}if(C.indexOf("on")!=0){C="on"+C}var A=this.__listeners;if(!A[C]){return }if(A[C][B]){delete A[C][B]}};baidu.lang.Class.prototype.dispatchEvent=function(C){if(!this.__listeners){this.__listeners={}}var B,A=this.__listeners,D=C.type;C.target=C.target||this;C.currentTarget=this;if(typeof this[D]=="function"){this[D](C)}if(typeof A[D]=="object"){for(B in A[D]){A[D][B].call(this,C)}}return C.returnValue};baidu.lang._insCounter=baidu.lang._insCounter||1;baidu.lang._instances=baidu.lang._instances||{};baidu.lang.inherits=function(G,E,D){var C,F,A=G.prototype,B=new Function();B.prototype=E.prototype;F=G.prototype=new B();for(C in A){F[C]=A[C]}G.prototype.constructor=G;G.superClass=E.prototype;if("string"==typeof D){F._className=D}};baidu.inherits=baidu.lang.inherits;baidu.lang.instance=function(A){return baidu.lang._instances[A]||null};baidu.lang.isArray=function(A){return"[object Array]"==Object.prototype.toString.call(A)};baidu.lang.isElement=function(A){return !!(A&&A.nodeName&&A.nodeType==1)};baidu.lang.isNumber=function(A){return"[object Number]"==Object.prototype.toString.call(A)};baidu.lang.isObject=function(A){return"function"==typeof A||!!(A&&"object"==typeof A)};baidu.isObject=baidu.lang.isObject;baidu.lang.isString=function(A){return"[object String]"==Object.prototype.toString.call(A)};baidu.isString=baidu.lang.isString;baidu.lang.module=function(D,F,B){B=B||window;var G=D.split("."),A=G.length-1,C,E;for(E=0;E<A;E++){C=G[E];if(!B[C]){B[C]={}}B=B[C]}if(!B[G[A]]){B[G[A]]=F}};baidu.number=baidu.number||{};baidu.number.comma=function(D,C){var E=String(D).split("."),A=E[0].split("").reverse().join(""),B;if(!C||C<1){C=3}B=new RegExp("\\d{"+C+"}","g");A=A.replace(B,function(F){return F+","}).split("").reverse().join("");if(A.charAt(0)==","){A=A.slice(1)}E[0]=A;return E.join(".")};baidu.number.pad=function(C,B){var D="",A=String(C);if(A.length<B){D=(new Array(B-A.length+1)).join("0")}return D+A};baidu.object=baidu.object||{};baidu.object.clone=function(D){var A=D,B;if(!D||D instanceof Number||D instanceof String||D instanceof Boolean){return A}else{if(D instanceof Array){A=[];var C=0;for(B=0,len=D.length;B<len;B++){A[C++]=baidu.object.clone(D[B])}}else{if("object"==typeof D){A={};for(B in D){if(D.hasOwnProperty(B)){A[B]=baidu.object.clone(D[B])}}}}}return A};baidu.object.extend=function(C,A){for(var B in A){if(A.hasOwnProperty(B)){C[B]=A[B]}}};baidu.extend=baidu.object.extend;baidu.object.keys=function(D){var A=[],C=0,B;for(B in D){if(D.hasOwnProperty(B)){A[C++]=B}}return A};baidu.object.values=function(D){var A=[],C=0,B;for(B in D){if(D.hasOwnProperty(B)){A[C++]=D[B]}}return A};baidu.page=baidu.page||{};baidu.page.getHeight=function(){var D=document,A=D.body,C=D.documentElement,B=D.compatMode=="BackCompat"?A:D.documentElement;return Math.max(C.scrollHeight,A.scrollHeight,B.clientHeight)};baidu.page.getScrollLeft=function(){var A=document;return A.documentElement.scrollLeft||A.body.scrollLeft};baidu.page.getScrollTop=function(){var A=document;return A.documentElement.scrollTop||A.body.scrollTop};baidu.page.getViewHeight=function(){var B=document,A=B.compatMode=="BackCompat"?B.body:B.documentElement;return A.clientHeight};baidu.page.getViewWidth=function(){var B=document,A=B.compatMode=="BackCompat"?B.body:B.documentElement;return A.clientWidth};baidu.page.getWidth=function(){var D=document,A=D.body,C=D.documentElement,B=D.compatMode=="BackCompat"?A:D.documentElement;return Math.max(C.scrollWidth,A.scrollWidth,B.clientWidth)};baidu.page.loadCssFile=function(B){var A=document.createElement("link");A.setAttribute("rel","stylesheet");A.setAttribute("type","text/css");A.setAttribute("href",B);document.getElementsByTagName("head")[0].appendChild(A)};baidu.page.loadJsFile=function(B){var A=document.createElement("script");A.setAttribute("type","text/javascript");A.setAttribute("src",B);A.setAttribute("defer","defer");document.getElementsByTagName("head")[0].appendChild(A)};baidu.sio=baidu.sio||{};baidu.sio.callByBrowser=function(B,D){var C=document.createElement("SCRIPT"),A=0;C.onload=C.onreadystatechange=function(){if(A){return }var E=C.readyState;if("undefined"==typeof E||E=="loaded"||E=="complete"){A=1;try{("function"==typeof D)&&D()}finally{if(C&&C.parentNode){C.parentNode.removeChild(C)}C.onload=C.onreadystatechange=null;C=null}}};C.setAttribute("type","text/javascript");C.setAttribute("src",B);document.getElementsByTagName("head")[0].appendChild(C)};baidu.sio.callByServer=function(A,F){var D=document.createElement("SCRIPT"),B="bd__cbs__",E=typeof F,C;if("string"==E){C=F}else{if("function"==E){while(1){C=B+Math.floor(Math.random()*2147483648).toString(36);if(!window[C]){window[C]=function(){try{F.apply(window,arguments)}finally{if(D&&D.parentNode){D.parentNode.removeChild(D)}D=null;window[C]=null}};break}}}}if("string"==typeof C){A=A.replace(/(\?|&)callback=[^&]*/,"\x241callback="+C);if(A.search(/(\?|&)callback=/)<0){A+=(A.indexOf("?")<0?"?":"&");A+="callback="+C}}D.setAttribute("type","text/javascript");D.setAttribute("src",A);document.getElementsByTagName("head")[0].appendChild(D)};baidu.string=baidu.string||{};baidu.string.decodeHTML=function(A){return String(A).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};baidu.decodeHTML=baidu.string.decodeHTML;baidu.string.encodeHTML=function(A){return String(A).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};baidu.encodeHTML=baidu.string.encodeHTML;baidu.string.escapeReg=function(A){return String(A).replace(new RegExp("([.*+?^=!:\x24{}()|[\\]/\\\\])","g"),"\\\x241")};baidu.string.format=function(D,B){D=String(D);if(B){if("[object Object]"==Object.prototype.toString.call(B)){return D.replace(/#\{(.+?)\}/g,function(E,G){var F=B[G];if("function"==typeof F){F=F(G)}return("undefined"==typeof F?"":F)})}else{var C=Array.prototype.slice.call(arguments,1),A=C.length;return D.replace(/#\{(\d+)\}/g,function(F,E){E=parseInt(E,10);return(E>=A?F:C[E])})}}return D};baidu.format=baidu.string.format;baidu.string.getByteLength=function(A){return String(A).replace(/[^\x00-\xff]/g,"ci").length};baidu.string.subByte=function(A,C){A=String(A);var B=baidu.string.getByteLength,E,H,I,G,D,F;if(C<0||B(A)<=C){return A}H=A.length;for(E=Math.floor(C/2)-1;E<H;E++){I=G||A.substr(0,E);D=F||B(I);if(D==C){return I}else{G=A.substr(0,E+1);F=B(G);if(F>C){return I}}}return A};baidu.string.toCamelCase=function(A){return String(A).replace(/[-_]\D/g,function(B){return B.charAt(1).toUpperCase()})};baidu.string.toHalfWidth=function(A){return String(A).replace(/[\uFF01-\uFF5E]/g,function(B){return String.fromCharCode(B.charCodeAt(0)-65248)}).replace(/\u3000/g," ")};baidu.string.trim=function(A){return String(A).replace(new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g"),"")};baidu.trim=baidu.string.trim;baidu.string.wbr=function(A){return String(A).replace(/(?:<[^>]+>)|(?:&#?[0-9a-z]{2,6};)|(.{1})/gi,"$&<wbr>").replace(/><wbr>/g,">")};baidu.swf=baidu.swf||{};baidu.swf.create=function(A,C){A=A||{};var B=baidu.swf.createHTML(A)||A.errorMessage||"";if(C&&"string"==typeof C){C=document.getElementById(C)}if(C){C.innerHTML=B}else{document.write(B)}};baidu.swf.createHTML=function(P){P=P||{};var I=baidu.swf.version,G=P.ver||"6.0.0",F,D,E,C,H,O,A={};for(C in P){A[C]=P[C]}P=A;if(I){I=I.split(".");G=G.split(".");for(E=0;E<3;E++){F=parseInt(I[E],10);D=parseInt(G[E],10);if(D<F){break}else{if(D>F){return""}}}}else{return""}var K=P.vars,J=["classid","codebase","id","width","height","align"];P.align=P.align||"middle";P.classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000";P.codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0";P.movie=P.url||"";delete P.vars;delete P.url;if("string"==typeof K){P.flashvars=K}else{var M=[];for(C in K){O=K[C];if(O){M.push(C+"="+encodeURIComponent(O))}}P.flashvars=M.join("&")}var L=["<object "];for(E=0,H=J.length;E<H;E++){O=J[E];L.push(" ",O,'="',P[O],'"')}L.push(">");var B={wmode:1,scale:1,quality:1,play:1,loop:1,menu:1,salign:1,bgcolor:1,base:1,allowscriptaccess:1,allownetworking:1,allowfullscreen:1,seamlesstabbing:1,devicefont:1,swliveconnect:1,flashvars:1,movie:1};for(C in P){O=P[C];if(B[C]&&O){L.push('<param name="'+C+'" value="'+O+'" />')}}P.src=P.movie;P.name=P.id;delete P.id;delete P.movie;delete P.classid;delete P.codebase;P.type="application/x-shockwave-flash";P.pluginspage="http://www.macromedia.com/go/getflashplayer";L.push("<embed");var N;for(C in P){O=P[C];if(O){if((new RegExp("^salign\x24","i")).test(C)){N=O;continue}L.push(" ",C,'="',O,'"')}}if(N){L.push(' salign="',N,'"')}L.push("></embed></object>");return L.join("")};baidu.swf.getMovie=function(A){return document[A]||window[A]};baidu.swf.version=(function(){var F=navigator;if(F.plugins&&F.mimeTypes.length){var C=F.plugins["Shockwave Flash"];if(C&&C.description){return C.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s)+r/,".")+".0"}}else{if(window.ActiveXObject&&!window.opera){for(var B=10;B>=2;B--){try{var E=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+B);if(E){var A=E.GetVariable("$version");return A.replace(/WIN/g,"").replace(/,/g,".")}}catch(D){}}}}})();baidu.url=baidu.url||{};baidu.url.escapeSymbol=function(A){return String(A).replace(/\%/g,"%25").replace(/&/g,"%26").replace(/\+/g,"%2B").replace(/\ /g,"%20").replace(/\//g,"%2F").replace(/\#/g,"%23").replace(/\=/g,"%3D")};baidu.url.getQueryValue=function(B,C){var D=new RegExp("(^|&|\\?|#)"+baidu.string.escapeReg(C)+"=([^&]*)(&|\x24)","");var A=B.match(D);if(A){return A[2]}return null};baidu.url.jsonToQuery=function(E,D){var B=[],A=0,C,G,F;D=D||function(H){return baidu.url.escapeSymbol(H)};for(C in E){if(E.hasOwnProperty(C)){G=E[C];if(Object.prototype.toString.call(G)=="[object Array]"){F=G.length;while(F--){B[A++]=C+"="+D(G[F],C)}}else{B[A++]=C+"="+D(G,C)}}}return B.join("&")};baidu.url.queryToJson=function(A){var E=A.substr(A.indexOf("?")+1),C=E.split("&"),D=C.length,I={},G,F,H,B;for(i=0;i<D;i++){B=C[i].split("=");G=B[0];F=B[1];H=I[G];if("undefined"==typeof H){I[G]=F}else{if(Object.prototype.toString.call(H)=="[object Array]"){H.push(F)}else{I[G]=[H,F]}}}return I};baidu.fx=baidu.fx||{};baidu.fx._getDefaultDisplay=function(A){A=baidu.g(A);var B=document.createElement("div");A=document.createElement(A.tagName);B.appendChild(A);return baidu.getStyle(A,"display")};(function(){function A(B){B=B||{};baidu.lang.Class.call(this);this.interval=B.interval||20;this.duration=B.duration||800;this.onbeforestart=B.onbeforestart||false;this.onbeforeupdate=B.onbeforeupdate||false;this.onafterupdate=B.onafterupdate||false;this.onafterfinish=B.onafterfinish||false;this.transition=B.transition}baidu.inherits(A,baidu.lang.Class,"baidu.fx._Timeline");A.prototype.start=function(){typeof this.initialize=="function"&&this.initialize();this.dispatchEvent(new baidu.lang.Event("onbeforestart"));this._startTime=(new Date).getTime();this._endTime=this._startTime+this.duration;this._launch()};A.prototype._launch=function(){var B=this,C=(new Date).getTime();if(C>=B._endTime){this._transition(1);typeof B.render=="function"&&B.render(B.schedule);typeof B.finish=="function"&&B.finish();B.dispatchEvent(new baidu.lang.Event("onafterfinish"));B.dispose()}else{this._transition((C-B._startTime)/B.duration);B.dispatchEvent(new baidu.lang.Event("onbeforeupdate"));typeof B.render=="function"&&B.render(B.schedule);B.dispatchEvent(new baidu.lang.Event("onafterupdate"));if(!B.terminative){B._timer=setTimeout(function(){B._launch()},B.interval)}}};A.prototype.cancel=function(){this.abort();this._endTime=this._startTime;typeof this.restore=="function"&&this.restore();this.dispose()};A.prototype.end=function(){this.abort();this._endTime=this._startTime;this._launch()};A.prototype.abort=function(){this._timer&&clearTimeout(this._timer)};A.prototype._transition=function(B){B=B||0;if(typeof this.transition=="function"){var C=this.transition(B);isNaN(C)||(B=C)}B=B>1?1:B;this.schedule=B=B<0?0:B};baidu.fx._Timeline=A})();(function(){function A(B,D,C){this.element=baidu.G(B);if(!this.element){return new Boolean(false)}baidu.fx._Timeline.call(this,D);this._className=C||this._className;this._attname="att_"+this._className.replace(/\W/g,"_");if(B=this.element.getAttribute(this._attname)){if(B=baidu.lang.instance(B)){B.end()}}this.element.setAttribute(this._attname,this.guid,0)}baidu.inherits(A,baidu.fx._Timeline,"baidu.fx.Effect");A.prototype.dispose=function(){this.element&&this.element.removeAttribute(this.attribName);baidu.lang.Class.prototype.dispose.call(this)};baidu.fx.Effect=A})();(function(){var A=function(B,E,D,C){B=baidu.fx.Effect.call(this,B,C);if(B==false){return B}this.options=C||{};this.from=E;this.to=D};A.prototype.initialize=function(){if(baidu.ie){this.originalFilter=baidu.getStyle(this.element,"filter");this.element.style.zoom="1"}else{this.originalOpacity=baidu.getStyle(this.element,"opacity");this.originalMozOpacity=baidu.getStyle(this.element,"MozOpacty");this.originalKHTMLOpacity=baidu.getStyle(this.element,"KHTMLOpacity")}};A.prototype.render=function(B){B=this.from<this.to?this.from+(this.to-this.from)*B:this.from-(this.from-this.to)*B;if(baidu.ie){this.element.style.filter="alpha(opacity:"+Math.round(B*100)+")"}else{this.element.style.opacity=B;this.element.style.MozOpacity=B;this.element.style.KHTMLOpacity=B}};A.prototype.restore=A.prototype.finish=function(){if(baidu.ie){this.element.style.filter=this.originalFilter;this.element.style.zoom="normal"}else{this.element.style.opacity=this.originalOpacity;this.element.style.MozOpacity=this.originalMozOpacity;this.element.style.KHTMLOpacity=this.originalKHTMLOpacity}};baidu.inherits(A,baidu.fx.Effect,"baidu.fx.Opacity");baidu.fx.Opacity=A})();baidu.fx.collapse=function(A,B){var C=new baidu.fx.Effect(A,B,"baidu.fx.Blind");if(C==false){return null}C.initialize=function(){var G=this.element,E=baidu.getStyle(G,"height"),F=baidu.getStyle(G,"overflow");G.style.display="block";var D=G.offsetHeight;G.style.overflow="hidden";if(baidu.getStyle(G,"display")=="none"){G.style.display=""}C.finish=function(){G.style.display="none";G.style.overflow=F;G.style.height=E};C.restore=function(){G.style.overflow=F;G.style.height=E};C.render=function(H){G.style.height=(1-H)*D+"px"}};C.start();return C};baidu.fx.expand=function(A,B){var C=new baidu.fx.Effect(A,B,"baidu.fx.Blind");if(C==false){return null}C.initialize=function(){var G=this.element,E=baidu.getStyle(G,"height"),F=baidu.getStyle(G,"overflow");G.style.overflow="hidden";G.style.display="block";var D=G.offsetHeight;G.style.height="0px";C.render=function(H){G.style.height=H*D+"px"};C.finish=C.restore=function(){G.style.overflow=F;G.style.height=E}};C.start();return C};baidu.fx.fadeIn=function(A,B){B=new baidu.fx.Opacity(A,0,1,B);if(B==false){return null}B.addEventListener("onbeforestart",function(){if(baidu.getStyle(A,"display")=="none"){this.element.style.display=baidu.fx._getDefaultDisplay(A)}});B.start();return B};baidu.fx.fadeOut=function(A,B){A=new baidu.fx.Opacity(A,1,0,B);if(A==false){return null}A.addEventListener("onbeforestart",function(){if(baidu.getStyle(this.element,"display")=="none"){this.element.style.display=baidu.fx._getDefaultDisplay(this.element)}});A.addEventListener("onafterfinish",function(){this.element.style.display="none"});A.start();return A};baidu.fx.highlight=function(A,B){B=B||{};var C=new baidu.fx.Effect(A,B,"baidu.fx.Background");if(C==false){return null}C.initialize=function(){function J(K){K=parseInt(K).toString(16);return("00"+K).substr(K.length)}var H=this.element,I=B.startcolor||"#FFFF99",G=B.endcolor||"#FFFFFF",E=B.restorecolor||baidu.getStyle(H,"backgroundColor"),F=[parseInt(I.substring(1,3),16),parseInt(I.substring(3,5),16),parseInt(I.substr(5),16)],D=[parseInt(G.substring(1,3),16)-F[0],parseInt(G.substring(3,5),16)-F[1],parseInt(G.substr(5),16)-F[2]];C.render=function(K){K=[J(Math.round(F[0]+D[0]*K)),J(Math.round(F[1]+D[1]*K)),J(Math.round(F[2]+D[2]*K))];H.style.backgroundColor="#"+K.join("")};C.restore=C.finish=function(){H.style.backgroundColor=E}};C.start();return C};baidu.fx.moveBy=function(A,B,E,D){var C=new baidu.fx.Effect(A,D,"baidu.fx.Move");B=B||0;E=E||0;if(C==false){return null}C.initialize=function(){var K=this.element,J=baidu.getStyle(K,"position");if(baidu.ie==6&&J=="fixed"){J=K.style.position="static"}if(J==""||J=="static"){K.style.position="relative"}var G=baidu.getStyle(K,"top"),H=baidu.getStyle(K,"left"),F=J=="static"?0:parseFloat(G=="auto"?"0":G||"0"),I=J=="static"?0:parseFloat(H=="auto"?"0":H||"0");C.render=function(L){K.style.left=B*L+I+"px";K.style.top=E*L+F+"px"};C.finish=function(){K.style.left=B+I+"px";K.style.top=E+F+"px"}};C.start();return C};baidu.fx.moveTo=function(A,B,E,D){var C=new baidu.fx.Effect(A,D,"baidu.fx.Move");if(C==false){return null}C.initialize=function(){var L=this.element,K=baidu.getStyle(L,"position");if(baidu.ie==6&&K=="fixed"){K=L.style.position="static"}if(K==""||K=="static"){L.style.position="relative"}var H=baidu.getStyle(L,"top"),I=baidu.getStyle(L,"left"),G=K=="static"?0:parseFloat(I=="auto"?"0":I||"0"),J=K=="static"?0:parseFloat(H=="auto"?"0":H||"0");B=B==0?0:B||G;E=E==0?0:E||J;var F=B-G,M=E-J;C.render=function(N){L.style.left=F*N+G+"px";L.style.top=M*N+J+"px"};C.finish=function(){L.style.left=B+"px";L.style.top=E+"px"}};C.start();return C};(function(){var A="0729";var T=[],P=null,E=0,N={};function O(a,Y,Z,W,X){var U="";if(W){U=W.caller.toString()}if(typeof (Y)=="object"){Y=baidu.json.encode(Y)}var V={mark:Z,level:a,value:Y,caller:U,trace:X,time:new Date()};T.push(V);if(D.onData){if(P){if(P(V)){D.onData(V)}}else{D.onData(V)}}}function G(W,X,U,V){O("log",W,X,U,V)}function R(W,X,U,V){O("info",W,X,U,V)}function K(W,X,U,V){O("error",W,X,U,V)}function F(V,W){var U=[];if(V){baidu.each(T,function(X){if(X[V]==W){U.push(X)}})}else{U=T}return U}function L(V){webim.Logger.__mulan_report_img_holder=webim.Logger.__mulan_report_img_holder||[];var U=new Image();baidu.object.extend(V,C());U.src="http://st3.im.baidu.com/nop.html?"+baidu.url.jsonToQuery(V,function(W){return encodeURIComponent(W)});webim.Logger.__mulan_report_img_holder.push(U)}function J(U,W){var V=new Date().getTime();N[U]=N[U]||[];N[U].push({mark:W,time:V});return V}function Q(X,Z){var V=N[X];if(V){for(var Y=0,U=V.length;Y<U;Y++){var W=V[Y];if(W.mark===Z){return W.time}}}return null}function I(W){var X=[];if(W){var U=N[W];X.push(V+": "+baidu.json.encode(U))}else{for(var V in N){var U=N[V];X.push(V+": "+baidu.json.encode(U))}}return X.join("\n")}function C(){var U={};U.domain=window.location.host;U.ie=baidu.browser.ie||"";U.opera=baidu.browser.ie||"";U.firefox=baidu.browser.firefox||"";U.chrome=baidu.browser.chrome||"";U.safari=baidu.browser.safari||"";U.logv=A;U.app="mulan";if(webim&&webim.Core){U.username=webim.Core.getUsername();U.guid=webim.Core.guid}return U}function S(){T=[]}function B(U){P=U}function M(){E++;return E}function H(){}var D;if(baidu.url.getQueryValue(window.location.href,"mulandebug")){D={log:G,info:R,error:K,dump:F,setTime:J,getTime:Q,dumpTime:I,report:L,reset:S,setFilter:B,trace:M}}else{D={log:H,info:H,error:H,dump:H,setTime:H,getTime:H,dumpTime:H,report:L,reset:H,setFilter:H,trace:H}}baidu.lang.module("webim.Logger",D)})();(function(){function A(B){return B.replace(/\r|\n|\r\n/gi,"")}if(window.console&&baidu.url.getQueryValue(window.location.href,"mulandebugff")){webim.Logger.onData=function(E){var H=E.level,D=E.value,G=E.mark,B=A(E.caller?E.caller:""),C=E.trace,F=E.time;G=G||".";console[H]("["+G+"]"+D+(B?"\n---\ncaller:"+B:"")+(F?"\n-->time:"+F:"")+(C?"\n-->trace:"+C:""))}}})();baidu.sio.callByServer=function(A,F){var D=document.createElement("SCRIPT"),B="bd__cbs__",E=typeof F,C;if("string"==E){C=F}else{if("function"==E){while(1){C=B+Math.floor(Math.random()*2147483648).toString(36);if(!window[C]){window[C]=function(){try{F.apply(window,arguments)}finally{if(D.clearAttributes){D.clearAttributes()}else{for(var G in D){if(D.hasOwnProperty(G)){delete D[G]}}}if(D&&D.parentNode){D.parentNode.removeChild(D)}D=null;window[C]=null}};break}}}}if("string"==typeof C){A=A.replace(/(\?|&)callback=[^&]*/,"\x241callback="+C);if(A.search(/(\?|&)callback=/)<0){A+=(A.indexOf("?")<0?"?":"&");A+="callback="+C}}D.setAttribute("type","text/javascript");D.setAttribute("src",A);document.getElementsByTagName("head")[0].appendChild(D)};(function(){var A="0729";var T=[],P=null,E=0,N={};function O(a,Y,Z,W,X){var U="";if(W){U=W.caller.toString()}if(typeof (Y)=="object"){Y=baidu.json.encode(Y)}var V={mark:Z,level:a,value:Y,caller:U,trace:X,time:new Date()};T.push(V);if(D.onData){if(P){if(P(V)){D.onData(V)}}else{D.onData(V)}}}function G(W,X,U,V){O("log",W,X,U,V)}function R(W,X,U,V){O("info",W,X,U,V)}function K(W,X,U,V){O("error",W,X,U,V)}function F(V,W){var U=[];if(V){baidu.each(T,function(X){if(X[V]==W){U.push(X)}})}else{U=T}return U}function L(V){webim.Logger.__mulan_report_img_holder=webim.Logger.__mulan_report_img_holder||[];var U=new Image();baidu.object.extend(V,C());U.src="http://st3.im.baidu.com/nop.html?"+baidu.url.jsonToQuery(V,function(W){return encodeURIComponent(W)});webim.Logger.__mulan_report_img_holder.push(U)}function J(U,W){var V=new Date().getTime();N[U]=N[U]||[];N[U].push({mark:W,time:V});return V}function Q(X,Z){var V=N[X];if(V){for(var Y=0,U=V.length;Y<U;Y++){var W=V[Y];if(W.mark===Z){return W.time}}}return null}function I(W){var X=[];if(W){var U=N[W];X.push(V+": "+baidu.json.encode(U))}else{for(var V in N){var U=N[V];X.push(V+": "+baidu.json.encode(U))}}return X.join("\n")}function C(){var U={};U.domain=window.location.host;U.ie=baidu.browser.ie||"";U.opera=baidu.browser.ie||"";U.firefox=baidu.browser.firefox||"";U.chrome=baidu.browser.chrome||"";U.safari=baidu.browser.safari||"";U.logv=A;U.app="mulan";if(webim&&webim.Core){U.username=webim.Core.getUsername();U.guid=webim.Core.guid}return U}function S(){T=[]}function B(U){P=U}function M(){E++;return E}function H(){}var D;if(baidu.url.getQueryValue(window.location.href,"mulandebug")){D={log:G,info:R,error:K,dump:F,setTime:J,getTime:Q,dumpTime:I,report:L,reset:S,setFilter:B,trace:M}}else{D={log:H,info:H,error:H,dump:H,setTime:H,getTime:H,dumpTime:H,report:L,reset:H,setFilter:H,trace:H}}baidu.lang.module("webim.Logger",D)})();(function(){var D=window.GrandCentral={};var B=D.Operators={};B[""]=function(F,E){if(F instanceof Array){return B["in"].apply(this,arguments)}else{return B.eq.apply(this,arguments)}};B.eq=function(H,J){if(arguments.length<2){return false}if(H===null||H===undefined||J===null||J===undefined){return(J===H)}switch(H.constructor){case String:case Number:case Boolean:if(H.constructor!=J.constructor){return false}return J==H&&J.constructor==H.constructor;default:if(H instanceof Array){if(!(J instanceof Array)){return false}if(J.length!=H.length){return false}for(var F=0;F<H.length;F++){if(!B.eq(H[F],J[F])){return false}}return true}else{if(!(J instanceof Object)){return false}for(var K in H){var G=K.lastIndexOf("$");var M;var I;var L=H[K];var E;if(G<0){M=K;E=""}else{M=K.substr(0,G);E=K.substr(G+1)}if(B[E]){if(M in J){I=J[M];if(!B[E](L,I)){return false}}else{if(!B[E](L)){return false}}}else{throw"operator doesn't exist: "+E}}return true}}};B.ne=function(F,E){return arguments.length==2&&!B.eq(F,E)};B.lt=function(F,E){return arguments.length==2&&E<F};B.lte=function(F,E){return arguments.length==2&&E<=F};B.gt=function(F,E){return arguments.length==2&&E>F};B.gte=function(F,E){return arguments.length==2&&E>=F};B["in"]=function(G,F){if(arguments.length<2){return false}for(var E=0;E<G.length;E++){if(B.eq(G[E],F)){return true}}return false};B.nin=function(F,E){return arguments.length==2&&!B["in"](F,E)};B.all=function(I,H){if(arguments.length<2){return false}if(!(H instanceof Array)){return false}var G;for(var F=0;F<I.length;F++){G=false;for(var E=0;E<H.length;E++){if(B.eq(I[F],H[E])){G=true;break}}if(!G){return false}}return true};B.exists=function(F,E){if(F===true){return arguments.length==2}else{if(F===false){return arguments.length==1}}return false};var C=function(E){return function(F){if(arguments.length>0){return B[""](E,F)}else{return B[""](E)}}};var A=function(F){var E=[];F.listen=function(H,G){if(!(H instanceof Function)){H=C(H)}E.push({filter:H,handler:G});return F};F.call=function(H){for(var G=0;G<E.length;G++){if(E[G].filter.apply(this,arguments)){E[G].handler(H)}}return F}};D.extend=function(E){new A(E);return E};D.extend(D)})();var IETransport=function(B,C,A){this.peer=B;this.role=C;this.cfg=A||{};this.net={};this.listen={toOuter:function(){},toInner:function(){}};this.connect()};IETransport.prototype={connect:function(){var D=this;if(this.role=="outer"){try{this.net=this.peer.opener=this.listen}catch(B){var C=window.setInterval(function(){if(D.peer.opener){D.peer.opener=D.listen;D.net=D.peer.opener;window.clearInterval(C)}},100)}}if(this.role=="inner"){if(window.opener){this.net=window.opener}else{var A=window.setInterval(function(){if(window.opener){D.net=window.opener;window.clearInterval(A)}},100)}}},send:function(A){if(this.role=="inner"){this.net.toInner(A)}if(this.role=="outer"){this.net.toOuter(A)}},register:function(D){var C=this;if(this.role=="inner"){try{this.net=window.opener;this.net.toOuter=D}catch(A){var B=window.setInterval(function(){C.net=window.opener;if(C.net){C.net.toOuter=D;window.clearInterval(B)}},100)}}if(this.role=="outer"){try{this.net.toInner=D}catch(A){}}}};var NativeMessageTransport=function(B,C,D,A){this.peerDomain=B||"*";this.peer=C||{};this.role=D||"";this.config=A||{};this.receiver=function(){};this._connect()};NativeMessageTransport.prototype={_connect:function(){var A=this;var B=window.postMessage?window:document;baidu.on(B,"message",function(E){E=B.event||E;var C=E.origin;if(A.config.origin&&A.config.origin!=C){throw Error("CrossPageChannel: No secure origin")}else{var D=E.data;A.receiver(baidu.json.decode(D))}})},send:function(C){var B=this.peer;var A=B.postMessage?B:B.document;A.postMessage(baidu.json.encode(C),this.peerDomain)},register:function(A){this.receiver=A}};var IframeRelayTransport=function(B,C,A){this.relayURI=B;this.role=C;this.config=A||{};this.relayIframe=null;this.receiver=null;this.connect()};IframeRelayTransport.prototype={connect:function(){var B=this;var C=document.createElement("div");C.innerHTML='<iframe src=""></iframe>';this.relayIframe=C.childNodes[0];C=null;var A=this.relayIframe.style;A.visibility="hidden";A.width=A.height="0px";A.position="absolute";window.xpcRelay=function(D){B.receiver(baidu.json.decode(D))}},send:function(B){var A=this.relayURI;A+="#"+encodeURIComponent(baidu.json.encode(B));this.relayIframe.src=A;document.body.appendChild(this.relayIframe)},register:function(A){this.receiver=A}};var CrossPageChannel=function(A){this.config=A||{};this.transport=null;this.peerWindowObject=null;this.iframeElement=null;this.listener={};this.sendBuffer=[];this.sendFlag=0;this.maxSegment=10000;this.pingTimeout=0.1*1000;this.pingTimer=null;this.receiveAssemble=[];this.ready=false;this._connect()};CrossPageChannel.prototype={_connect:function(){var B=this;if(!this.config.iframeId){this.peerWindowObject=window.parent}if(this.config.iframeId){var A=this.config.iframeId;this.iframeElement=document.getElementById(A);if(this.iframeElement){B.peerWindowObject=B.iframeElement.contentWindow;if(!B.peerWindowObject){B.peerWindowObject=window.frames[A]}}}this._createTransport();this._ping()},_ping:function(D){D=D||0;var B=this,A={port:"_ping",ack:0,seq:0,content:""};try{if(D%50==0){webim.Logger.report({debug:1,xpcPing:1,count:D})}this.transport.send(A)}catch(C){webim.Logger.report({info:1,xpcPingError:1,e:baidu.json.encode(C),role:this._getRole()})}finally{if(D<100){this.pingTimer=setTimeout(function(){if(!B.ready){B._ping(++D)}},this.pingTimeout)}else{webim.Logger.report({error:1,xpcInitFailed:1,count:D,role:this._getRole()})}}},_getRole:function(){return window.parent==this.peerWindowObject?"inner":"outer"},_createTransport:function(){var A=this;if(window.postMessage||document.postMessage){this.transport=new NativeMessageTransport(this.config.peerURI,this.peerWindowObject,this._getRole(),A.config)}else{if(baidu.ie&&baidu.ie<=7){if(this._getRole()=="outer"){this.transport=new IETransport(window.frames[this.config.iframeId],this._getRole(),{})}else{this.transport=new IETransport(window.frames[this.config.iframeId],this._getRole(),{})}}else{this.maxSegment=2000;this.transport=new IframeRelayTransport(this.config.relayURI,this._getRole(),{})}}this.transport.register(function(B){A._receiver(A,B)})},_receiver:function(F,G){var C=G.port;var H=G.ack;var B=G.seq;var E=G.content;if(H==2){if(!F.ready){F.ready=true;clearTimeout(F.pingTimer);F.pingTimer=null}F._send()}if(H==0){var A={port:"_self",ack:2,seq:0,content:""};F.transport.send(A);if(B>0){F.receiveAssemble.push(E)}if(B==0){if(F.listener[C]){F.listener[C](E)}}if(B==-1){F.receiveAssemble.push(E);var D=F.receiveAssemble.join("");F.receiveAssemble=[];if(F.listener[C]){F.listener[C](D)}}}},_send:function(){if(!this.ready){return }if(this.sendBuffer.length>0){this.sendFlag=1;var A=this.sendBuffer.shift();this.transport.send(A)}else{this.sendFlag=0}},send:function(B,E){var G=Math.ceil(E.length/this.maxSegment);if(G>1){for(var D=0;D<G;D++){var C=E.substring(D*this.maxSegment,(D+1)*this.maxSegment);var A=D+1;if(D==G-1){A=-1}var F={port:B,ack:0,seq:A,content:C};this.sendBuffer.push(F)}}else{var F={port:B,ack:0,seq:0,content:E};this.sendBuffer.push(F)}if(this.sendFlag==0){this._send()}},register:function(A,B){this.listener[A]=B},unRegister:function(A){delete this.listener[A]}};(function(){var E;var C=function(G){return"PS"+G.replace(/_/g,"__").replace(/ /g,"_s")};var B={searchList:["userData","localStorage","cookie"],methods:["init","get","set","remove"],status:{SUCCESS:0,FAILURE:1,OVERFLOW:2,FATAL:3},option:{}};var D={localStorage:{size:10*1024*1024,test:function(){return window.localStorage?true:false},methods:{init:function(){this.store=window.localStorage},expand:function(G){return C(this.name)+C(G)},set:function(I,M,K,J){var G=B.status.SUCCESS;I=this.expand(I);var L;if(J&&J.expires){L=J.expires+"|"+M}else{L="0|"+M}try{this.store.setItem(I,L)}catch(H){G=B.status.OVERFLOW;webim.Logger.report({error:1,storageError:1,method:"set",storage:"localStorage",e:baidu.json.encode(H),key:I,valueLength:M?M.length:0,username:username,guid:guid})}if(K){K.call(this,G,M)}},get:function(J,K){var G=B.status.SUCCESS;J=this.expand(J);try{var L=this.store.getItem(J);if(L==null){G=B.status.FAILURE}else{var N=L.indexOf("|");var M=L.substring(0,N);var H=(new Date()).getTime();if(M>H||M=="0"){L=L.substring(N+1,L.length)}else{L=null;this.store.removeItem(J);G=B.status.FAILURE}}}catch(I){G=B.status.FATAL;webim.Logger.report({error:1,storageError:1,method:"get",storage:"localStorage",e:baidu.json.encode(I),key:J,username:username,guid:guid})}if(K){K.call(this,G,L)}},remove:function(I,J){var G=B.status.SUCCESS;var K=null;I=this.expand(I);try{var L=this.store.getItem(I);var M=L.indexOf("|");K=L.substring(M+1,L.length);if(L==null){G=B.status.FAILURE}else{this.store.removeItem(I)}}catch(H){G=B.status.FATAL;webim.Logger.report({error:1,storageError:1,method:"remove",storage:"localStorage",e:baidu.json.encode(H),key:I,username:username,guid:guid})}if(J){J.call(this,G,K)}}}},userData:{size:64*1024,test:function(){return window.ActiveXObject?true:false},methods:{init:function(){var H="_storage_data_";var I=H+C(this.name);this.el=document.createElement("div");this.el.id=I;this.el.style.display="none";this.el.addBehavior("#default#userData");document.body.insertBefore(this.el,document.body.firstChild);var G=this;baidu.on(window,"unload",function(){G.el=null})},expand:function(G){return C(this.name)+C(G)},set:function(I,M,K,J){I=this.expand(I);var G=B.status.SUCCESS;try{var L;if(J&&J.expires){this.el.expires=(new Date(J.expires+8*60*60*1000)).toUTCString();L=J.expires+"|"+M}else{L="0|"+M}this.el.setAttribute(I,L);this.el.save(I)}catch(H){G=B.status.OVERFLOW;webim.Logger.report({error:1,storageError:1,method:"set",storage:"userData",e:baidu.json.encode(H),key:I,valueLength:M?M.length:0,username:username,guid:guid});M=null}if(K){K.call(this,G,M)}},get:function(J,K){J=this.expand(J);var G=B.status.SUCCESS;try{this.el.load(J);var L=this.el.getAttribute(J);if(L){var N=L.indexOf("|");var M=L.substring(0,N);var H=(new Date()).getTime();if(M>H||M=="0"){L=L.substring(N+1,L.length)}else{L=null;G=B.status.FAILURE}}if(L==null){G=B.status.FAILURE;this.remove(J)}}catch(I){G=B.status.FATAL;webim.Logger.report({error:1,storageError:1,method:"get",storage:"userData",e:baidu.json.encode(I),key:J,username:username,guid:guid})}if(K){K.call(this,G,L)}},remove:function(I,J){I=this.expand(I);var G=B.status.SUCCESS;var K=null;try{this.el.load(I);K=this.el.getAttribute(I);if(K==null){G=B.status.FAILURE}else{var L=K.indexOf("|");K=K.substring(L+1,K.length);this.el.expires=new Date(315532799000).toUTCString();this.el.removeAttribute(I);this.el.save(I)}}catch(H){G=B.status.FAILURE;webim.Logger.report({error:1,storageError:1,method:"remove",storage:"userData",e:baidu.json.encode(H),key:I,username:username,guid:guid})}if(J){J.call(this,G,K)}}}},cookie:{size:4*1024,test:function(){return true},methods:{expand:function(G){return this.name+G},get:function(H,I){var G=B.status.SUCCESS;H=this.expand(H);var J=baidu.cookie.get(H);if(J==null){G=B.status.FAILURE}if(I){I.call(this,G,J)}},set:function(H,K,J,I){var G=B.status.SUCCESS;H=this.expand(H);if(I&&I.expires){I.expires=new Date(expires)}baidu.cookie.set(H,K,I);if(J){J.call(this,G,K)}},remove:function(H,I){var G=B.status.SUCCESS;H=this.expand(H);var J=baidu.cookie.get(H);baidu.cookie.remove(H);if(J==null){G=B.status.FAILURE}if(I){I.call(this,G,J)}}}}};var F=function(){var J=function(){};A.type=null;A.size=-1;for(var I=0,H=B.methods.length;I<H;I++){A.Store.prototype[B.methods[I]]=J}if(B.option.backend){var G=B.option.backend;if(D[G]&&D[G].test()){A.type=G;A.size=D[G].size;for(key in D[G].methods){A.Store.prototype[key]=D[G].methods[key]}}else{for(var I=0,H=B.searchList.length;!A.type&&I<H;I++){var G=D[B.searchList[I]];if(G.test()){A.type=B.searchList[I];A.size=G.size;for(key in G.methods){A.Store.prototype[key]=G.methods[key]}}}}}else{for(var I=0,H=B.searchList.length;!A.type&&I<H;I++){var G=D[B.searchList[I]];if(G.test()){A.type=B.searchList[I];A.size=G.size;for(key in G.methods){A.Store.prototype[key]=G.methods[key]}}}}};var A={version:"1.0",type:null,size:-1,getSupportList:function(){var G=[];for(var I=0,H=B.searchList.length;I<H;I++){if(D[B.searchList[I]].test()){G.push(B.searchList[I])}}return G},Store:function(G,I){var H=/^[a-z][a-z0-9_ -]+$/i;if(!H.exec(G)){throw new Error("Invalid name")}if(!A.type){throw new Error("No suitable storage found")}this.name=G;B.option=I||{};B.option.domain=I.domain||location.hostname||"localhost.localdomain";B.option.expires=B.option.expires||365*2;B.option.path=B.option.path||"/";this.init()},set:function(G,J,I,H){if(!E){E=new baidu.more.storage.Store("fastmulan",{})}E.set(G,J,I,H)},get:function(G,I,H){if(!E){E=new baidu.more.storage.Store("fastmulan",{})}E.get(G,I,H)},remove:function(G,H){if(!E){E=new baidu.more.storage.Store("fastmulan",{})}E.remove(G,H)}};F();baidu.lang.module("more.storage",A,baidu)})();(function(){var L=0,F={},C,M,K,N,D;function O(R,Q,S,T){S=S||{};M=R;K=Q;N=S.observeInterval||1*1000;D=S.maxLength||100;C=S.syncKey||"systemsync";syncPort=S.syncPort||1002;H(function(){if(M){M.register(syncPort,function(U){switch(U.method){case"send":case"call":P(U.key,U.value);break;case"register":case"listen":G(U.key,function(V){M.send(syncPort,{callback:U.callback,value:V})});break}})}I();if(T){T()}})}var J=0;function I(){J++;setTimeout(function(){K.get(C,function(Q,S){if(Q==0||Q==1){try{if(S){var U=baidu.json.decode(S);var R=U.length>0?U[0][0]:0;E(U,R)}}catch(T){webim.Logger.report({error:1,syncObserveError:1,e:baidu.json.encode(T)})}finally{I()}}else{webim.Logger.report({error:1,syncError:1,count:J})}})},N)}function E(W,T){if(T>L){var Q=T-L;if(Q<D){for(var R=Q-1;R>=0;R--){var Y=W[R];if(Y){var U=Y[1],X=Y[2];var S=F[U];if(S){try{S(X)}catch(V){}}}else{webim.Logger.report({error:1,syncLost:1,lostByRescueFragment:1})}}}else{webim.Logger.report({error:1,syncLost:Q-D});for(var R=D-1;R>=0;R--){var Y=W[R];var U=Y[1],X=Y[2];var S=F[U];if(S){try{S(X)}catch(V){}}}}L=T}else{}}function H(Q){K.get(C,function(R,S){if(S){var T=baidu.json.decode(S);L=T.length>0?T[0][0]:0;Q()}else{Q()}})}function P(Q,R){K.get(C,function(S,T){var W=[];if(T){W=baidu.json.decode(T)}var V=W.length>0?(W[0][0]):0;var U=V+1;E(W,V);L=U;W.unshift([U,Q,R]);W=W.slice(0,D);K.set(C,baidu.json.encode(W),function(X,Y){if(X==2||X==3){webim.Logger.report({info:1,syncSetError:1,key:Q,valueLength:Y?Y.length:0,arrayLength:W?W.length:0,arrayByteLength:W?W.join("").length:0,status:X})}if(X==2){W=[W[0]];K.set(C,baidu.json.encode(W),function(Z,a){if(Z==0||Z==1){webim.Logger.report({info:1,syncSetRescueOK:1,key:Q,valueLength:a?a.length:0,arrayLength:W?W.length:0,arrayByteLength:W?W.join("").length:0,status:Z})}else{if(Z==2||Z==3){webim.Logger.report({error:1,syncSetRescueError:1,key:Q,valueLength:a?a.length:0,arrayLength:W?W.length:0,arrayByteLength:W?W.join("").length:0,status:Z})}}})}})})}function G(Q,R){F[Q]=R}function B(Q){if(F[Q]){delete F[Q]}}var A={init:O,call:P,listen:G,unListen:B,send:P,register:G,unRegister:B,getMaxIndex:function(){return L}};baidu.lang.module("more.sync",A,baidu)})();(function(){var C={},D,M,S=false,h=false,G={},W=0,J=2000,O=2000,P=500,F=20,n="http://st1.im.baidu.com/m/iknow/mulan-bar/";var A="1_",f="0_";baidu.on(window,"load",function(){h=true});baidu.dom.ready(function(){h=true});G.loadAt=new Date().getTime();function j(q,p){G.initAt=new Date().getTime();webim.Logger.report({loadtime:G.initAt-window.mulanlogdata.startloadtime});q=baidu.url.getQueryValue(window.location.href,"mulandebugusername")||q;var o=baidu.url.getQueryValue(window.location.href,"mulandebugrefresh");if(o){setTimeout(function(){window.location.reload()},o)}D=q;R(q)}function R(r){var q='<div id="mulan-sys-close" class="baritem right" onmouseover="mulan.Core.closeOver(this);" onmouseout="mulan.Core.closeOut(this);">				       <a href="#" id="mulan-control-button" hidefocus="true" onclick="mulan.Core.hideMulan();return false">\u5173\u95ed</a>				   </div>		           <div class="baritem separator right"></div>				   <div id="mulan-sys-extend" class="baritem right">				       <span>						  <a href="http://im.baidu.com/html/promo/zd.html" target="_blank">\u4e0b\u8f7d\u767e\u5ea6Hi\uff0c\u7b54\u6848\u65e9\u77e5\u9053\uff01</a>					   </span>				   </div>			       <div class="baritem separator right"></div>			       <div id="mulan-sys-webim" class="right"></div>			       <div id="mulan-sys-apps">				       <div id="mulan-sys-widgets" class="baritem left"></div>				   <div class="baritem separator left"></div>				   <div id="mulan-sys-windows" class="baritem left"></div>			       </div>';var p=document.createElement("div");p.id="mulan-root";p.innerHTML=q;p.style.visibility="hidden";document.body.appendChild(p);if(baidu.ie==6){document.execCommand("BackgroundImageCache",false,true)}var o=baidu.cookie.get("_ML_HIDE");if(o!==null){if(o!=A&&o!=f){o=L(o)}if(o==A){Z();l();return }}G.startapitime=new Date().getTime();mulan.webim.main("mulan-sys-webim",r,Y,true);window.setTimeout(function(){if(!S){webim.Logger.report({error:"noroot"})}},10000)}function L(o){baidu.cookie.remove("_ML_HIDE",{expires:new Date(2012,12,20)});if(o==1){baidu.cookie.set("_ML_HIDE",A,{expires:new Date(2012,12,20),path:"/",domain:"baidu.com"});return A}else{baidu.cookie.set("_ML_HIDE",f,{expires:new Date(2012,12,20),path:"/",domain:"baidu.com"});return f}}function Y(){S=true;G.apioktime=new Date().getTime();var r=arguments[0];var q=webim.model.DataService,p=q.T.Const;m(r,p);Q(r,p);a();webim.api.System.start();d();var o=(typeof document.compatMode!="undefined"&&/CSS.Compat/.test(document.compatMode))?false:true;if(baidu.ie==6||baidu.ie&&o){M=E("mulan-root");M.start()}l();G.initOkAt=new Date().getTime();K();webim.Logger.report({inittime:G.initOkAt-G.initAt});webim.Logger.report({coreinittime:G.initOkAt-window.mulanlogdata.startloadtime})}function V(){var q=arguments[0];var p=webim.model.DataService,o=p.T.Const;m(q,o);Q(q,o);a();if(!S){K()}}function K(){var q=webim.model.DataService,p=q.T.Const;var o=p.getBaseTable();p.listen({type:[o.ACTION_ADD,o.ACTION_UPDATE],value:"_ML_HIDE"},function(s){var r=p.get("_ML_HIDE").value;r=r.split("|")[0];if(r==1){B()}else{if(r==0){d()}}})}function B(){W=1;N();IM.Helper.closeTip("mulan_close_tip");var o=window.setTimeout(function(){W=0;k()},J);Z()}function H(o){if(W==1){return }if(o.getElementsByTagName("img")[0]){IM.Helper.showTip("mulan_close_tip",o,"\u5f00\u542f\u4e2d",{left:6,arrLeft:18})}else{if(o.className.indexOf("ml_close")==-1){IM.Helper.showTip("mulan_close_tip",o,"\u5173\u95ed\u901a\u680f",{left:12,arrLeft:24})}else{IM.Helper.showTip("mulan_close_tip",o,"\u5f00\u542f\u901a\u680f",{left:12,arrLeft:24})}}}function e(o){IM.Helper.closeTip("mulan_close_tip")}function X(){var o=false;if(b()=="max"){mulan.Core.call({e:"rootClose"});W=1;N();IM.Helper.closeTip("mulan_close_tip");var q=window.setTimeout(function(){W=0;k()},J);baidu.cookie.set("_ML_HIDE",A,{expires:new Date(2012,12,20),path:"/",domain:"baidu.com"});c();if(baidu.G("mulan_close_tip")){baidu.G("mulan_close_tip").getElementsByTagName("nobr")[0].innerHTML="\u5f00\u542f\u901a\u680f"}webim.Logger.report({mulanstatus:"min"})}else{if(b()=="min"){if(W==1){return }var p=new Date().getTime();baidu.G("mulan-sys-close").innerHTML='<img src="'+n+'images/load.gif" alt=""/>';var r=1;var s=window.setInterval(function(){r++;var t=null,w=null;try{t=webim.api.System.getStatus();w=webim.api.Self.getStatus()}catch(u){}if(r>F){webim.Logger.report({loadingovertime:1});window.clearInterval(s);s=null;baidu.cookie.set("_ML_HIDE",A,{expires:new Date(2012,12,20),path:"/",domain:"baidu.com"});c();baidu.G("mulan-sys-close").innerHTML='<a href="#" id="mulan-control-button" hidefocus="true" onclick="mulan.Core.hideMulan();return false">\u5f00\u542f</a>';return }if(w){if(w=="offline"){v()}else{if(t=="online"){v()}}}function v(){var x=new Date().getTime()-p;webim.Logger.report({mulanloadingtime:x});window.clearInterval(s);s=null;baidu.cookie.set("_ML_HIDE",f,{expires:new Date(2012,12,20),path:"/",domain:"baidu.com"});i();baidu.G("mulan-sys-close").innerHTML='<a href="#" id="mulan-control-button" hidefocus="true" onclick="mulan.Core.hideMulan();return false">\u5173\u95ed</a>'}},P);if(baidu.G("mulan_close_tip")){IM.Helper.closeTip("mulan_close_tip")}mulan.webim.main("mulan-sys-webim",D,function(){o=true;if(!S){V();S=true}webim.api.System.start()});if(baidu.G("mulan_close_tip")){baidu.G("mulan_close_tip").getElementsByTagName("nobr")[0].innerHTML="\u5173\u95ed\u901a\u680f"}webim.Logger.report({mulanstatus:"max"})}}}function N(){baidu.G("mulan-control-button").style.color="#ccc";baidu.G("mulan-control-button").style.cursor="default";if(baidu.G("mulan-sys-close")){baidu.G("mulan-sys-close").onmouseover=function(){};baidu.G("mulan-sys-close").onmouseout=function(){}}}function k(){baidu.G("mulan-control-button").style.color="#000";baidu.G("mulan-control-button").style.cursor="pointer";if(baidu.G("mulan-sys-close")){baidu.on("mulan-sys-close","mouseover",function(){H(baidu.G("mulan-sys-close"))});baidu.on("mulan-sys-close","mouseout",function(){e(baidu.G("mulan-sys-close"))})}}function b(){var o=null;var p=baidu.G("mulan-root").className;if(p.indexOf("mulan-root-min")==-1){o="max"}else{o="min"}return o}function c(){webim.api.System.stop();try{var q=webim.model.DataService,p=q.T.Const;p.save({key:"_ML_HIDE",value:1+"|"+new Date().getTime()})}catch(o){}Z();g()}function Z(){baidu.G("mulan-root").className="mulan-root-min";baidu.addClass(baidu.G("mulan-sys-close"),"ml_close");if(baidu.G("mulan-control-button")){baidu.G("mulan-control-button").innerHTML="\u5f00\u542f"}var o=(typeof document.compatMode!="undefined"&&/CSS.Compat/.test(document.compatMode))?false:true;if(baidu.ie==6||baidu.ie&&o){M=E("mulan-root");M.stop()}}function i(){var p=webim.model.DataService,o=p.T.Const;o.save({key:"_ML_HIDE",value:0+"|"+new Date().getTime()});d()}function d(){baidu.G("mulan-root").className="mulan-root-max";baidu.removeClass(baidu.G("mulan-sys-close"),"ml_close");if(baidu.G("mulan-control-button")){baidu.G("mulan-control-button").innerHTML="\u5173\u95ed"}var o=(typeof document.compatMode!="undefined"&&/CSS.Compat/.test(document.compatMode))?false:true;if(baidu.ie==6||baidu.ie&&o){M=E("mulan-root");M.start()}}function l(){var o=baidu.g("mulan-root");o.style.visibility="visible";o.style.display="block"}function a(){baidu.on(document.body,"click",function(o){var q=baidu.event.getTarget(o);var p=C.menu;if(!baidu.dom.contains("mulan-root",q)){if(p._status==1){p.idle()}}});baidu.on(window,"resize",function(o){g()})}function g(){for(var o in C){var p=C[o];p.idle()}}function m(r,p){var o=baidu.g("mulan-sys-apps");var q=C.menu;o.innerHTML=q.render()+o.innerHTML;q.init(r,p);q._onRender()}function Q(s,q){for(var o in C){var r=C[o];if(o.indexOf("a")==0){var p=baidu.g("mulan-sys-widgets");p.innerHTML+=r.render();r.init(s,q);r._onRender()}}}function T(o){C[o.guid]=o}var E=function(o){var q=document.getElementById(o).offsetWidth;var v=25;var s=(typeof document.compatMode!="undefined"&&/CSS.Compat/.test(document.compatMode))?false:true;if(baidu.ie>6&&s){}function r(){var AB=s?document.body:document.documentElement;var x=AB.clientHeight;var y=AB.clientWidth;var AA=AB.scrollLeft;var z=AB.scrollTop;return{width:y,height:x,left:AA,top:z}}function u(){setTimeout(function(){var AB=document.getElementById(o);var x=r();var AA=x.width-q;var z=x.height-v;AB.style.position="absolute";AB.style.top=((document.documentElement.scrollTop||document.body.scrollTop)+z)+"px";AB.style.setExpression("top","eval((document.documentElement.scrollTop || document.body.scrollTop) + "+z+") + 'px'");if(b()=="max"){AB.style.left=((document.documentElement.scrollLeft||document.body.scrollLeft)+12)+"px";AB.style.setExpression("left","eval((document.documentElement.scrollLeft || document.body.scrollLeft) + 12) + 'px'");var y=x.width-24;if(y<745){baidu.dom.addClass(AB,"mulan_min_width")}else{baidu.dom.removeClass(AB,"mulan_min_width")}AB.style.width=y+"px";AB.style.overflow="visible"}else{AB.style.width="40px";AB.style.overflow="hidden"}},16)}function p(){var y=document.getElementById(o);if(!y){return }u();baidu.un(window,"scroll",u);baidu.un(window,"resize",u);baidu.un(window,"scroll",w);baidu.un(window,"resize",w);baidu.on(window,"scroll",u);baidu.on(window,"resize",u);var x=setInterval(function(){if(!h){u()}else{clearInterval(x)}},100)}function t(){var y=document.getElementById(o);if(!y){return }y.style.width="40px";y.style.left="auto";w();baidu.un(window,"scroll",w);baidu.un(window,"resize",w);baidu.un(window,"scroll",u);baidu.un(window,"resize",u);baidu.on(window,"scroll",w);baidu.on(window,"resize",w);var x=setInterval(function(){if(!h){u()}else{clearInterval(x)}},100)}function w(){var AB=document.getElementById(o);var x=r();var AA=x.width-q;var z=x.height-v;AB.style.position="absolute";AB.style.top=((document.documentElement.scrollTop||document.body.scrollTop)+z)+"px";if(b()=="min"){AB.style.left=((document.documentElement.scrollLeft||document.body.scrollLeft)+baidu.page.getViewWidth()-52)+"px";AB.style.width="40px";AB.style.overflow="hidden"}else{AB.style.left=((document.documentElement.scrollLeft||document.body.scrollLeft)+12)+"px";var y=x.width-24;if(y<745){baidu.dom.addClass(AB,"mulan_min_width")}else{baidu.dom.removeClass(AB,"mulan_min_width")}AB.style.width=y+"px";AB.style.overflow="visible"}}return{start:p,stop:t}};function U(){return D}var I={init:j,addApp:T,getUsername:U,hideMulan:X,closeOver:H,closeOut:e,logData:G};GrandCentral.extend(I);baidu.lang.module("mulan.Core",I)})();(function(){function A(){this.html="";this.name=""}A.prototype={render:function(){return this.html},_onRender:function(){mulan.Core.call({from:this.name,e:"render"})}};baidu.lang.module("mulan.app.BaseApp",A)})();(function(){var B=mulan.app.BaseApp,E=mulan.Core,D;baidu.on(window,"unload",function(){B=null;E=null;D=null});function C(I,H,L,F){B.call(this);this.guid=I;this.name=H;this.title=L||"";this.tips=F||"";this.content="";this._iconHTML="";this._holderId="mulan-"+this.name;this._titleId=this._holderId+"-title";this._contentId=this._holderId+"-content";this._tipsId=this._holderId+"-tips";this._statusRuntimeKey="w_"+this.name+"_status";this._status=-1;var J=this;E.listen({from:this.name,e:"render"},G);function G(){var M=arguments[0];baidu.on(J._titleId,"click",K)}function K(){var M=arguments[0];if(J._status>0){J.idle();webim.Logger.report({widgetclose:J.name})}else{J.active();webim.Logger.report({widgetopen:J.name})}baidu.event.stopPropagation(M);baidu.event.preventDefault(M)}E.listen({from$ne:this.name,e:"active"},function(){if(J._status==1){J.idle()}});E.listen({from:this.name,e:"render"},function(){J.onRender()});E.listen({from:this.name,e:"active"},function(){J.onActive()});E.listen({from:this.name,e:"idle"},function(){J.onIdle()});E.listen({from:this.name,e:"quit"},function(){J.onQuit()})}baidu.lang.inherits(C,B);var A={_buildTitle:function(){var F='<a href="#" hidefocus="true" class="cleara icon" id="'+this._titleId+'">'+this.title+this._buildTips()+"</a>";return F},_buildTips:function(){if(this.tips!=""){var F='<div  id="'+this._tipsId+'" class="tips-holder">';F+='<table cellpadding="0" cellspacing="0"><tr><td class="mulan_tips"><nobr>'+this.tips+'</nobr></td></tr><tr><td class="mulan_arrow"></td></tr></table>';F+="</div>";return F}return""},_build:function(F,G){var H='<div id="'+this._holderId+'" class="baritem holder left">';H+=F+"<div id='"+this._contentId+"' class='content'>"+G+"</div>";H+="</div>";this.html=H},setContent:function(F){this._build(this._buildTitle(),F)},_buildActive:function(){baidu.addClass(this._holderId,"active");this._status=1},active:function(){var F=this;if(this._status!=1){this._buildActive();this.runtime.save({key:this._statusRuntimeKey,value:this._status+"|"+new Date().getTime()});E.call({from:this.name,e:"active"})}},_buildIdle:function(){baidu.removeClass(this._holderId,"active");this._status=0},idle:function(){var F=this;if(this._status!=0){this._buildIdle();this.runtime.save({key:this._statusRuntimeKey,value:this._status});E.call({from:this.name,e:"idle"})}},_buildQuit:function(){baidu.removeClass(this._holderId,"active");this._status=-1},quit:function(){var F=this;if(this._status!=-1){this._buildQuit();this.runtime.save({key:this._statusRuntimeKey,value:this._status});E.call({from:this.name,e:"quit"})}},onActive:function(){},onIdle:function(){},onQuit:function(){},onRender:function(){},init:function(I,H){var G=this;this.runtime=H;this.username=I;var F=H.getBaseTable();H.listen({type:[F.ACTION_ADD,F.ACTION_UPDATE],value:G._statusRuntimeKey},function(L){var J=H.get(L.value).value;var K;if(J.indexOf&&J.indexOf("|")!=-1){K=J.split("|")[0]}else{K=J}if(K==1){G._buildActive();mulan.Core.call({e:"pageMutex",from:G.name})}else{if(K==0){G._buildIdle()}else{if(K==-1){G._buildQuit()}}}});mulan.Core.listen({e:"pageMutex","from$ne":G.name},function(J){G._buildIdle()})}};baidu.object.extend(C.prototype,A);baidu.lang.module("mulan.app.DefaultApp",C)})();(function(){var B=mulan.app.BaseApp,E=mulan.Core,D;baidu.on(window,"unload",function(){B=null;E=null;D=null});function C(I,H,L,F){B.call(this);this.guid=I;this.name=H;this.title=L||"";this.tips=F||"";this.content="";this._iconHTML="";this._holderId="mulan-"+this.name;this._titleId=this._holderId+"-title";this._contentId=this._holderId+"-content";this._tipsId=this._holderId+"-tips";this._statusRuntimeKey="w_"+this.name+"_status";this._status=-1;var J=this;E.listen({from:this.name,e:"render"},G);function G(){var M=arguments[0];baidu.on(J._titleId,"click",K)}function K(){var M=arguments[0];if(J._status>0){J.idle();webim.Logger.report({widgetclose:J.name})}else{J.active();webim.Logger.report({widgetopen:J.name})}baidu.event.stopPropagation(M);baidu.event.preventDefault(M)}E.listen({from$ne:this.name,e:"active"},function(){if(J._status==1){J.idle()}});E.listen({from:this.name,e:"render"},function(){J.onRender()});E.listen({from:this.name,e:"active"},function(){J.onActive()});E.listen({from:this.name,e:"idle"},function(){J.onIdle()});E.listen({from:this.name,e:"quit"},function(){J.onQuit()})}baidu.lang.inherits(C,B);var A={_buildTitle:function(){var F='<a href="#" hidefocus="true" class="cleara icon" id="'+this._titleId+'">'+this.title+this._buildTips()+"</a>";return F},_buildTips:function(){if(this.tips!=""){var F='<div  id="'+this._tipsId+'" class="tips-holder">';F+='<table cellpadding="0" cellspacing="0"><tr><td class="mulan_tips"><nobr>'+this.tips+'</nobr></td></tr><tr><td class="mulan_arrow"></td></tr></table>';F+="</div>";return F}return""},_build:function(F,G){var H='<div id="'+this._holderId+'" class="baritem holder left">';H+=F+"<div id='"+this._contentId+"' class='content'>"+G+"</div>";H+="</div>";this.html=H},setContent:function(F){this._build(this._buildTitle(),F)},_buildActive:function(){baidu.addClass(this._holderId,"active");this._status=1},active:function(){var F=this;if(this._status!=1){this._buildActive();this.runtime.save({key:this._statusRuntimeKey,value:this._status});E.call({from:this.name,e:"active"})}},_buildIdle:function(){baidu.removeClass(this._holderId,"active");this._status=0},idle:function(){var F=this;if(this._status!=0){this._buildIdle();this.runtime.save({key:this._statusRuntimeKey,value:this._status});E.call({from:this.name,e:"idle"})}},_buildQuit:function(){baidu.removeClass(this._holderId,"active");this._status=-1},quit:function(){var F=this;if(this._status!=-1){this._buildQuit();this.runtime.save({key:this._statusRuntimeKey,value:this._status});E.call({from:this.name,e:"quit"})}},onActive:function(){},onIdle:function(){},onQuit:function(){},onRender:function(){},init:function(K,I){var H=this;this.runtime=I;this.username=K;var F=I.getBaseTable();var G=I.get(H._statusRuntimeKey);if(G){var J=G.value;if(J==1){H._buildActive()}}I.listen({type:[F.ACTION_ADD,F.ACTION_UPDATE],value:H._statusRuntimeKey},function(M){var L=I.get(M.value).value;if(L==1){H._buildActive();mulan.Core.call({e:"pageMutex",from:H.name})}else{if(L==0){H._buildIdle()}else{if(L==-1){H._buildQuit()}}}})}};baidu.object.extend(C.prototype,A);baidu.lang.module("mulan.app.SystemApp",C)})();(function(){var C=new mulan.app.SystemApp("menu","mybaidu","<span id='mulan-mybaidu-arrow'>&nbsp;</span>\u6211\u5728\u767E\u5EA6","");var B=false;C.setContent('<a class="center" target="_blank" href="http://passport.baidu.com/center" onclick="webim.Logger.report({selfmenuclick : 1});">\u4E2A\u4EBA\u4E2D\u5FC3</a>				  <a class="space" id="mulan-mybaidu-link-space" target="_blank" href="#" onclick="webim.Logger.report({spacemenuclick : 1});">\u6211\u7684\u7A7A\u95F4</a>				  <a class="iknow" target="_blank" href="http://zhidao.baidu.com/q?ct=24&cm=16&tn=ucframework#myiknow" onclick="webim.Logger.report({iknowmenuclick : 1});">\u6211\u7684\u77E5\u9053</a>				  <a class="baike" target="_blank" href="http://baike.baidu.com" onclick="webim.Logger.report({baikemenuclick : 1});">\u767E\u79D1</a>				  <a class="game" target="_blank" href="http://youxi.baidu.com" onclick="webim.Logger.report({youximenuclick : 1});">\u6E38\u620F\u4E2D\u5FC3</a>');C.onRender=function(){var D=C.username;baidu.g("mulan-mybaidu-link-space").href="http://hi.baidu.com/sys/checkuser/"+encodeURIComponent(D)+"/3"};C.onActive=function(){mulan.app.myBaidu.isOpen=true};C.onIdle=function(){mulan.app.myBaidu.isOpen=false};C.onQuit=function(){mulan.app.myBaidu.isOpen=false};mulan.Core.addApp(C);var A={isOpen:B};baidu.lang.module("mulan.app.myBaidu",A)})();(function(){var C=0;var A=null;var E=null;function D(){var F=baidu.g(E);if(F.readyState=="loaded"||F.readyState=="complete"){A()}}var B={createIframe:function(G,F,I,J){A=J;E=F;var L="__iframe_wrapper";var K=baidu.g(L);if(!K){var K=document.createElement("div");K.style.display="none";K.id="__iframe_wrapper";document.body.insertBefore(K,document.body.firstChild)}var H=document.createElement("iframe");H.style.height="0";H.id=H.name=F;H.src="about:blank";K.appendChild(H);H.src=G;if(I){I()}baidu.on(H,"load",function(){if(J){J()}})},now:function(){return new Date().getTime().toString(36)},compareTime:function(F,H,G){F=parseInt(F,36);G=parseInt(G,36);if(F+H>G){return 1}else{if(F+H==G){return 0}else{return -1}}},addTime:function(F,G){F=parseInt(F,36);return(F+G).toString(36)},expireAfter:function(G){var F=new Date();F.setTime(F.getTime()+G);return F},sToMs:function(F){if(typeof (F)=="number"){return F*1000}return F+"000"},guid:function(){C++;return(new Date()).getTime()+C}};baidu.lang.module("webim.Util",B)})();(function(){var y="1.0.0";var F={},AC={},H={},C=webim.Util,B=webim.Logger;GrandCentral.extend(F);var Y=""+U();var D="http://web.im.baidu.com";var E="http://web.im.baidu.com";var AE="http://w3.im.baidu.com";var w=false;var z=false;var r=false;var h="_ML_ST";var AA=10;var b=1;var W=-1;var X=2*1000;var u=1*1000;var q=null;var Z=[],L=[];var R=false;var e=null;function t(){var AI=AC.T.Runtime,AG=AC.T.Preference,AH=webim.Core;var AF=baidu.cookie.get("BDUSS");var AK=AI.get("bduss")?AI.get("bduss").value:null;var AJ=AG.get("username")?AG.get("username").value:null;if(AK&&AF===AK){if(!AI.getAndExpires("session")){AH.call({from:"webim.Core",action:"needLogin"})}else{AH.call({from:"webim.Core",action:"needPick"});a()}}else{AH.call({from:"webim.Core",action:"needLogin"})}}function O(){var AI=AC.T.Runtime,AG=AC.T.Preference,AH=webim.Core;var AF=baidu.cookie.get("BDUSS");var AK=AI.get("bduss")?AI.get("bduss").value:null;var AJ=AG.get("username")?AG.get("username").value:null;if(AK&&AF===AK){if(!AI.getAndExpires("session")){AB()}else{}}else{if(AJ!=f()){g()}else{AB()}AI.save({key:"bduss",value:AF});AG.save({key:"username",value:f()})}}function g(){AC.clearAll(["Const"])}function AB(){AC.clearAll(["Preference","Const"])}function a(){var AF=webim.Core;var AG=baidu.cookie.getRaw("ML_message");if(AG){var AH=unescape(AG).split("|")[0];AF.call({from:"webim.Core",event:"startChat",username:AH})}baidu.cookie.remove("ML_message")}function m(AG){var AF=AC.T.Preference;var AH=AF.get("status")?AF.get("status").value:null;if(AH&&AH==AF.STATUS.OFFLINE){}else{V(AG)}}function s(){if(R){return false}R=true;M(0,true);O();t()}function M(AG,AF){AG=AG||0;if(R==true){if(AF||l()){baidu.cookie.set(h,S(AA),{path:"/",expires:C.expireAfter(30*1000),domain:"baidu.com",secure:false});e=setTimeout(function(){M(AG+1)},2*1000)}else{webim.Logger.report({error:1,keepMasterFail:1});R=false;A()}}}function d(){clearTimeout(e);e=null}var k=0,j=0;function A(){var AF=AC.T.Runtime;q=setTimeout(function(){V()},u)}function S(AF){return AF+"|"+Y}var v=0;function l(){v++;var AF=false;var AH=baidu.cookie.get(h);if(AH){var AG=AH.split("|");if(AG.length==2){if(AG[0]==AA&&AG[1]==Y){AF=true}}}else{webim.Logger.report({info:1,nonCookieFromIsCookieMaster:1})}return AF}function V(AG){var AH=baidu.cookie.get(h),AI,AF;if(AH){AI=AH.split("|")[0];AF=AH.split("|")[1]}if(AI){if(AI==AA){if(Y!=AF){A()}}else{if(AI==b){if(AG){s()}}else{if(AI==W){s()}}}}else{s()}}function J(){var AF=AC.T.Runtime;AF.remove("session");I()}function I(){baidu.cookie.set(h,S(b),{path:"/",expires:C.expireAfter(X),domain:"baidu.com",secure:false})}function N(){if(R){R=false;d()}else{if(q){clearTimeout(q);q=null}}}function f(){return webim.Core.username}function x(AI,AH,AF){if(z){if(r){if(AF){AF()}}return 0}z=true;var AG=B.trace();B.info("[System.init]\nusername:"+AI+"\nparams:"+baidu.json.encode(AH)+"\ncallback:"+typeof (AF),"api",x,AG);webim.Core.username=AI;AH=AH||{};AH.Core=AH.Core||{};webim.Core.baseUrl=AH.Core.baseUrl||"http://web.im.baidu.com";webim.Core.pickUrl=AH.Core.pickUrl||"http://web.im.baidu.com";webim.Core.getUrl=AH.Core.getUrl||"http://w3.im.baidu.com";i();setTimeout(function(){if(L.length>0){B.report({error:1,initModuleTimeout:10*1000,initListLength:L.length,stopBefore:L[0].configKey})}},10*1000);p(AH,function(){AC=P();H=AC.getBaseTable();o();B.info("[webim.Core] init ok!",null,null,AG);w=true;r=true;if(AF){AF()}})}function Q(AH,AG,AF){x(AH,AG,function(){c();if(AF){AF()}})}function o(){var AI=AC.T.Runtime,AF=AC.T.Preference;var AH=webim.Net;var AG=webim.Core;AI.listen({type:H.ACTION_ADD},function(AJ){if(AJ.value=="session"){A();AG.call({from:"webim.Core",type:"status",data:"online"})}});AI.listen({type:H.ACTION_REMOVE},function(AJ){if(AJ.value=="session"){N();AH.abort();AG.call({from:"webim.Core",type:"status",data:"offline"})}});AI.listen({type:H.ACTION_CLEAR},function(AJ){N();AH.abort();AG.call({from:"webim.Core",type:"status",data:"offline"})});AF.listen({type:[H.ACTION_ADD,H.ACTION_UPDATE],value:"username"},function(AJ){webim.Core.username=AF.get("username").value});AG.listen({from:"webim.System",type:"logout"},function(AJ){N();J();AH.abort();AB();AG.call({from:"webim.Core",type:"status",data:"offline"})});AG.listen({from:"webim.System",type:"logoutError"},function(AJ){N();J();AH.abort();AB();AG.call({from:"webim.Core",type:"status",data:"offline"})});AG.listen({from:"webim.Net",event:"offline"},function(AJ){N();J();AH.abort();AB();AG.call({from:"webim.Core",type:"status",data:"offline"})});AG.listen({from:"webim.Self",type:"checkMaster"},function(AJ){m(true)});AG.listen({from:"webim.System",event:"online"},function(AJ){a()})}function c(){var AI=AC.T.Runtime;var AH=webim.Net;var AG=webim.Core;var AF=AC.T.Preference;if(!AF.get("username")||webim.Core.username!==AF.get("username").value){J();g();m(true);return 0}m()}function T(){var AG=webim.Net;var AF=webim.Core;w=false;if(G()=="offline"){N();J();AB();AG.abort()}else{webim.System.logout()}}function U(){return(new Date()).getTime().toString(36)}function i(){var AG=webim.Net;var AF=new Date(),AH=AF.getTime();AF.setTime(AH+10*1000);baidu.on(window,"beforeunload",function(){if(R){document.cookie=h+"="+escape(S(W))+";domain=baidu.com;path=/;expires="+AF.toGMTString()}AG.abort()})}function p(AH,AI){if(L.length>0){var AG=L.shift();var AF={};if(AG.configKey){AF=AH[AG.configKey]||AF}AG.init(AF,function(AJ){if(AJ==1){p(AH,AI)}else{}})}else{AI()}}function AD(AF){Z.push(AF);L.push(AF)}function P(){return webim.model.DataService}function G(){try{var AG=AC.T.Runtime;var AF=webim.Core;if(AG.getAndExpires("session")){return"online"}return"offline"}catch(AH){}return null}function n(){return w}var K={getVersion:function(){return y},baseUrl:D,pickUrl:E,getUrl:AE,isAvailable:n,stop:T,addModule:AD,isMaster:function(){return R},guid:Y,getUsername:f,getStatus:G,init:x,start:c,autoStart:Q,getDataService:P,getSystemGrandCentral:function(){return F},_getInitList:function(){return L}};GrandCentral.extend(K);baidu.lang.module("webim.Core",K)})();(function(){var H=false;var J={net:{},storage:{},sync:{}},C=[],G=0;var A="1000",B="1001",I="1002",L;var F=webim.Logger;function N(S,X){var W=webim.Util;var Z=S.peerURI||"http://web.im.baidu.com";var V=S.iframeId||"peer";var Y=S.iframeUrl||"http://web.im.baidu.com/m/webim-api/package.html";var R=S.relayURI||"http://web.im.baidu.com/webim-api/lib/xpc/inner-relay.html";var P=S.selfURI||window.location.protocol+"//"+window.location.host;var U=S.selfRelay;var T=F.trace();F.setTime(T,"createIframe0");var Q=setTimeout(function(){F.report({error:1,iframeError:1})},10*1000);W.createIframe(Y+"?guid="+webim.Core.guid+"&netport="+A+"&syncport="+I+"&storageport="+B+"&peer="+encodeURIComponent(P)+"&relay="+encodeURIComponent(U)+"&username="+encodeURIComponent(webim.Core.getUsername()),V,function(){},function(){clearTimeout(Q);Q=null;webim.Logger.report({info:1,iframeOnCreate:1});L=new CrossPageChannel({peerURI:Z,iframeId:V,relayURI:R,role:"outer"});L.register(A,function(a){J.net[a.callback](a.responseText)});L.register(B,function(a){if(typeof (J.storage[a.callback])=="function"){J.storage[a.callback](a.status,a.value)}});L.register(I,function(a){if(typeof (J.sync[a.callback])=="function"){J.sync[a.callback](a.value)}});H=true;M();F.setTime(T,"createIframe1");X(1)});baidu.on(window,"unload",function(){for(var a in L){delete L[a]}L=null})}function M(){baidu.each(C,function(P){if(P.service=="net"){switch(P.method){case"get":K.get(P.url,P.callback);break;case"post":K.post(P.url,P.data,P.callback);break;case"getbyserver":K.getByServer(P.url,P.callback);break;case"abort":K.abort();break}}else{if(P.service=="storage"){switch(P.method){case"set":O.set(P.key,P.value,P.callback,P.params);break;case"get":O.get(P.key,P.callback);break;case"remove":O.remove(P.key,P.callback);break}}else{if(P.service=="sync"){switch(P.method){case"send":D.send(P.key,P.value);break;case"register":D.register(P.key,P.callback);break}}}}})}var K={get:function(P,Q){if(H){J.net[G]=Q;L.send(A,{url:P,method:"get",callback:G});G++}else{C.push({service:"net",method:"get",url:P,callback:Q})}},post:function(P,Q,R){if(H){J.net[G]=R;L.send(A,{url:P,method:"post",data:Q,callback:G});G++}else{C.push({service:"net",method:"post",url:P,data:Q,callback:R})}},getByServer:function(P,Q){if(H){J.net[G]=Q;L.send(A,{url:P,method:"getbyserver",callback:G});G++}else{C.push({service:"net",method:"getbyserver",url:P,callback:Q})}},abort:function(){if(H){L.send(A,{method:"abort"});G++}else{C.push({service:"net",method:"abort"})}for(var P in J.net){J.net[P]=function(){}}}};var O={set:function(P,Q,S,R){if(H){J.storage[G]=S;L.send(B,{method:"set",key:P,value:Q,params:R,callback:G});G++}else{C.push({service:"storage",method:"set",key:P,value:Q,callback:S,params:R})}},get:function(P,Q){if(H){J.storage[G]=Q;L.send(B,{method:"get",key:P,callback:G});G++}else{C.push({service:"storage",method:"get",key:P,callback:Q})}},remove:function(P,Q){if(H){J.storage[G]=Q;L.send(B,{method:"remove",key:P,callback:G});G++}else{C.push({service:"storage",method:"remove",key:P,callback:Q})}}};var D={send:function(P,Q){F.log("[Sync.send]\nkey:"+P+"\nvalue:"+baidu.json.encode(Q),"service",D.send);if(H){L.send(I,{method:"send",key:P,value:Q});G++}else{C.push({service:"sync",method:"send",key:P,value:Q})}},register:function(P,Q){if(H){J.sync[G]=Q;L.send(I,{method:"register",key:P,callback:G});G++}else{C.push({service:"sync",method:"register",key:P,callback:Q})}}};var E={init:N,configKey:"Service",getNetService:function(){return K},getStorageService:function(){return O},getSyncService:function(){return D}};baidu.lang.module("webim.Service",E);webim.Core.addModule(E)})();(function DataService(){var D="";var B=webim.Logger;var J=["Runtime","Const","Team","Message","Conversation","User","TeamUser","ExtendUser","Preference","Recent","SystemMessage"];var H={};var C;function I(K,L){D=K.mark||"";C=new Date().getTime();G(L);setTimeout(function(){if(J.length>0){B.report({error:1,dataServiceInitTimeout:10*1000,stopBefore:J[0]})}},10*1000)}function G(O){if(J.length>0){var K=J.shift();var N=webim.model[K];if(N){var M=H[K]=new N(D);M.init(function(P){if(P==1){setTimeout(function(){G(O)},50)}else{O(0)}})}else{O(0)}}else{var L=new Date().getTime();webim.Logger.report({inittabletime:L-C});O(1)}}function E(L){L=L||[];for(var K in H){if(baidu.array.indexOf(L,K)<0){H[K].clear()}}}function F(){return webim.model.BaseTable}var A={name:"DataService",configKey:"DataService",init:I,get:H,T:H,clearAll:E,getBaseTable:F};baidu.lang.module("webim.model.DataService",A);webim.Core.addModule(A)})();(function(){var B=webim.Core,C=webim.Logger;function A(E,G,F,D){this._data=[];this._index={};this._cache={};this.name=E;this.mark=G;this.schema=F||[A.DEFAULT_PRIMARY_KEY];this.Storage=webim.Service.getStorageService();this.Sync=webim.Service.getSyncService();this.maxCount=2000}A.prototype.getBaseTable=function(){return A};A.prototype.init=function(F){var D=this,E=C.trace();C.log("[_init]","Table."+this.name);C.setTime(E,"table_"+this.name+"_init0");this.Sync.register("webim.model."+this.name,function(G){G=baidu.json.decode(G);D._onSync(G)});GrandCentral.extend(this);this.Storage.get(this.name,function(H,G){C.log("[_importFromString]","Table."+D.name);if(H==0||H==1){if(G){D.importFromString(G)}C.setTime(E,"table_"+D.name+"_init1");F(1)}else{if(H==3){C.report({error:1,tableError:1,table:D.name,storageStatus:H});F(0)}}});return this};A.DEFAULT_PRIMARY_KEY="_id";A.DELETE_KEY="_delete";A.CLEAR_KEY="_clear";A.ACTION_ADD="add";A.ACTION_UPDATE="update";A.ACTION_REMOVE="remove";A.ACTION_CLEAR="clear";A.DEFAULT_TIMEOUT=1000*60*60*24*7;A.prototype.getTableName=function(){return this.name+"$"+this.mark};A.prototype.save=function(E,D){if(!E||(baidu.lang.isArray(E)&&E.length==0)){return 0}if(!baidu.lang.isArray(E)){E=[E]}this._saveToMem(E);this._saveToStorage(D,this._sync(E))};A.prototype._hasChange=function(E,F){var D=false;for(var G in F){if(F[G]!==E[G]){D=true}}return D};A.prototype._saveToMem=function(G){var H=this,J=H.schema[0],D=H._data,I=H._index,E=H._cache,F=H._schema;var L=[];var K=G[0];if(K[A.CLEAR_KEY]){this._data=[];this._index={};this._cache={};L.push({type:A.ACTION_CLEAR})}else{baidu.each(G,function(P,M){var Q=I[P[J]];if(Q!==undefined){if(P[A.DELETE_KEY]){D[Q]=[];delete I[P[J]];H._removeCache(P[J]);L.push({type:A.ACTION_REMOVE,value:P[J]})}else{var O=H.toData(D[Q]);var N=H._hasChange(O,P);baidu.object.extend(O,P);D[Q]=H.toRaw(O);if(N){H._setCache(P[J]);L.push({type:A.ACTION_UPDATE,value:P[J]})}}}else{if(!P[A.DELETE_KEY]){if(J==A.DEFAULT_PRIMARY_KEY){P[J]=D.length}D.push(H.toRaw(P));Q=D.length-1;I[P[J]]=Q;H._setCache(P[J]);L.push({type:A.ACTION_ADD,value:P[J]})}}})}return L};A.prototype._saveToStorage=function(E,G){E=E||A.DEFAULT_TIMEOUT;var D=new Date().getTime()+E,F=new Date(D).getTime();C.log("[_saveToStorage]:\ndumpValue:"+this.dumpToString(),"Table."+this.name);this.Storage.set(this.name,this.dumpToString(),G,{expires:F})};A.prototype._notice=function(E){var D=this;baidu.each(E,function(F){D.call(F)})};A.prototype._sync=function(D){this.Sync.send("webim.model."+this.name,baidu.json.encode(D))};A.prototype._onSync=function(E){var D=this._saveToMem(E);this._notice(D);C.log("[onSync]\ndata:"+baidu.json.encode(E)+"\nresult:"+baidu.json.encode(D),"Table."+this.name,this._onSync)};A.prototype.toData=function(D){var E={};baidu.each(this.schema,function(G,F){E[G]=(D[F]!==undefined?D[F]:0)});return E};A.prototype.toRaw=function(E){var D=[];baidu.each(this.schema,function(F){D.push(E[F]!==undefined?E[F]:0)});return D};A.prototype.getList=function(J,G,H,E){var F=this._data,I=this,D=[];baidu.each(this._data,function(L,K){if(L.length>0){L=I.toData(L);if(H){if(H(L)){D.push(L)}}else{D.push(L)}}});if(E){D=D.sort(E)}J=J||0;G=G||null;end=G?J+G:null;if(end){D=D.slice(J,end)}else{D=D.slice(J)}return D};A.prototype.getLast=function(){if(this._data.length>0){var D=this._data[this._data.length-1];return this.toData(D)}return null};A.prototype.cloneObject=function(D){if(D!==undefined||D!==null){return baidu.json.decode(baidu.json.encode(D))}return null};A.prototype.isExists=function(D){if(this._index[D]!==undefined){return true}return false};A.prototype.get=function(F){var G=this,H;if(typeof (F)!="function"){var E=this._index[F];if(E!==undefined&&this._data[E]!==undefined){return this.toData(this._data[E])}else{return null}}var D=this.getList(0,1,F);var I=null;if(D.length>0){I=D[0]}C.log("[get]\nfilter:"+(H?H:typeof (F))+"\n@return:"+baidu.json.encode(I),"Table."+this.name,this.get);return I};A.prototype.count=function(D){return this.getList(null,null,D).length};A.prototype.remove=function(F){var E=this;if(typeof (F)=="function"){var I=[];list=this.getList(null,null,F);baidu.each(list,function(J){I.push({deleteKey:true,pKey:J[E.schema[0]]})});E.save(I)}else{var D=this.schema[0],H=A.DELETE_KEY,G={};G[H]=true;G[D]=F;this.save(G)}};A.prototype.clear=function(){var D=A.CLEAR_KEY;var E={};E[D]=true;this.save(E)};A.prototype.dumpToString=function(){return baidu.json.encode(this._data)};A.prototype.importFromString=function(E){this._data=baidu.json.decode(E);this._index={};var D=this;baidu.each(this._data,function(H,G){var F=H[0];if(F!==undefined){D._index[F]=G;D._setCache(F)}})};A.prototype._setCache=function(D){return false;this._cache[D]=this.toData(this._data[this._index[D]])};A.prototype._removeCache=function(D){return false;if(this._cache[D]){delete this._cache[D]}};baidu.lang.module("webim.model.BaseTable",A)})();(function(){var A=webim.model.BaseTable,C=webim.Util;function B(D){A.call(this);this.mark=D;this.name="Runtime";this.schema=["key","value","exp"]}B.prototype.saveAndExpires=function(E,F,D){this.save({key:E,value:F,exp:C.addTime(C.now(),D)})};B.prototype.getAndExpires=function(E){var D=this.get(E);if(D){if(C.compareTime(D.exp,0,C.now())<0){D=null}}return D};baidu.lang.inherits(B,A);baidu.lang.module("webim.model.Runtime",B)})();(function(){var A=webim.model.BaseTable,B=webim.Logger;function C(D){A.call(this);this.mark=D;this.name="Conversation";this.schema=["username"]}C.prototype.getMessageList=function(H,F){var G=F.getList(null,null,function(I){return(((I.sender==H)||(I.receiver==H))&&I.isOld)});B.log("[Conversation.getMessageList]\noldResult:"+baidu.json.encode(G),"Service");var E=F.getList(null,null,function(I){return(((I.sender==H)||(I.receiver==H))&&!I.isOld)});B.log("[Conversation.getMessageList]\nnewResult:"+baidu.json.encode(E),"Service");var D=G.concat(E);B.log("[Conversation.getMessageList]\nresult:"+baidu.json.encode(D),"Service");return D};baidu.lang.inherits(C,A);baidu.lang.module("webim.model.Conversation",C)})();(function(){var A=webim.model.BaseTable;function B(C){A.call(this);this.mark=C;this.name="Message";this.schema=["mid","sender","receiver","content","isRead","isOld","time"]}baidu.lang.inherits(B,A);baidu.lang.module("webim.model.Message",B)})();(function(){var A=webim.model.BaseTable;function B(C){A.call(this);this.mark=C;this.name="SystemMessage";this.schema=["mid","from","type","time","content","isRead","operationCount","isOld"]}baidu.lang.inherits(B,A);baidu.lang.module("webim.model.SystemMessage",B)})();(function(){var B=webim.model.BaseTable;function A(C){B.call(this);this.mark=C;this.name="Preference";this.schema=["key","value","exp"];this.STATUS={ONLINE:"online",OFFLINE:"offline",AWAY:"away",BUSY:"busy",HIDE:"hide"}}baidu.lang.inherits(A,B);baidu.lang.module("webim.model.Preference",A)})();(function(){var A=webim.model.BaseTable;function B(C){A.call(this);this.mark=C;this.name="Const";this.schema=["key","value"]}baidu.lang.inherits(B,A);baidu.lang.module("webim.model.Const",B)})();(function(){var A=webim.model.BaseTable;function B(D){A.call(this);this.mark=D;this.name="ExtendUser";this.schema=["username","status","isBlocked"];var C={offline:0,away:1,busy:2,online:3};this.DEFAULT_USER_COMPARATOR=function(H,G){var F=C[H.status],E=C[G.status],I=E-F;switch(I){case 0:return H.username.localeCompare(G.username);default:return I}}}B.prototype.getUserLikeList=function(H,E,F,D){var C=[];var G=this.getList(H,E,F,D);baidu.each(G,function(I){I.showname=I.username;C.push(I)});return C};baidu.lang.inherits(B,A);baidu.lang.module("webim.model.ExtendUser",B)})();(function(){var B=webim.model.BaseTable;function A(C){B.call(this);this.mark=C;this.name="Team";this.schema=["tid","name","userCount","onlineCount","isUserInited"];this.DEFAULT_TEAM_COMPARATOR=function(F,E){var D=F.name.localeCompare(E.name);if(D>=0){return 1}else{return -1}}}baidu.lang.inherits(A,B);baidu.lang.module("webim.model.Team",A)})();(function(){var A=webim.model.BaseTable;function B(C){A.call(this);this.mark=C;this.name="User";this.schema=["username","un","showname","showtype","status","syssession","relationship","isLoaded","isBlocked"]}B.prototype.getUserListByRelationship=function(C){return this.getList(null,null,function(D){return D.relationship==C})};baidu.lang.inherits(B,A);baidu.lang.module("webim.model.User",B)})();(function(){var A=webim.model.BaseTable;function B(D){A.call(this);this.mark=D;this.name="TeamUser";this.schema=["username","tid"];var C={offline:0,away:1,busy:2,online:3};this.DEFAULT_USER_COMPARATOR=function(H,G){var F=C[H.status],E=C[G.status],I=E-F;switch(I){case 0:return H.showname.localeCompare(G.showname);default:return I}}}B.prototype.addToTeam=function(E,D){var C=this.get(E);this.save({username:E,tid:D});if(!C){return -1}return C.tid};B.prototype.getUserListByTeamId=function(G,E,D){E=E||this.DEFAULT_USER_COMPARATOR;var F=this.getList(null,null,function(H){return H.tid==G});var C=[];baidu.each(F,function(I){var H=D.get(I.username);if(H){C.push(H)}});C=C.sort(E);return C};B.prototype.countUserByTeamId=function(C){return this.getList(null,null,function(D){return D.tid==C}).length};B.prototype.countNonOfflineUserByTeamId=function(F,D){var E=this.getList(null,null,function(G){return G.tid==F});var C=[];baidu.each(E,function(H){var G=D.get(H.username);if(G&&G.status&&G.status!="offline"){C.push(G)}});return C.length};baidu.lang.inherits(B,A);baidu.lang.module("webim.model.TeamUser",B)})();(function(){var A=webim.model.BaseTable,C=webim.Util;function B(D){A.call(this);this.mark=D;this.name="Recent";this.schema=["username"];this.TID=50;this.RECENT_USER_COMPARATOR=function(F,E){return -1}}B.MAX_SIZE=30;B.prototype.getRecentUnList=function(D){var F=[];var E=this.getList();baidu.each(E,function(H){var G=D.get(H.username);if(G){F.push(G.un)}});return F};B.prototype.getUserList=function(D){var F=[];var E=this.getList();baidu.each(E,function(H){var G=D.get(H.username);if(G){F.push(G)}});return F};B.prototype.addToRecent=function(F){var D=this.getList();var E=[];if(baidu.lang.isArray(F)){baidu.each(D,function(H){var G=H.username;if(baidu.array.indexOf(F,G)<0){E.push({username:G})}});baidu.each(F,function(G){E.unshift({username:G})})}else{if(D.length>0&&D[0].username==F){return 0}baidu.each(D,function(H){var G=H.username;if(G!=F){E.push({username:G})}});E.unshift({username:F})}while(E.length>B.MAX_SIZE){E.pop()}this.clear();this.save(E);return true};B.prototype.toArray=function(){var D=[];var E=this.getList();baidu.each(E,function(F){D.push(F.username)});return D};baidu.lang.inherits(B,A);baidu.lang.module("webim.model.Recent",B)})();(function(){var D=webim.Core,I=webim.model.DataService;var K=webim.Util;var J=webim.Service.getNetService();var H="",Q=0,G=30,A=11;function M(T){var R=I.T.Runtime;var S=R.getAndExpires("session");if(S){return true}webim.Logger.report({error:1,offlineError:1,from:"Net.checkSession",mark:T});D.call({from:"webim.Net",event:"offline"});return false}function P(R){var S=I.T.Runtime;R+=(R.indexOf("?")>0?"&":"?")+"seq="+Q;var T=S.getAndExpires("session");if(T){R+="&session="+T.value}R+="&source="+A+"&v="+G+"&guid="+D.guid;Q++;return R}function E(T){var R=I.T.Runtime;T+=(T.length>0?"&":"")+"seq="+Q;var S=R.getAndExpires("session");if(S){T+="&session="+S.value}T+="&source="+A+"&v="+G+"&guid="+D.guid;Q++;return T}function C(T,R,S,V){var U=I.T.Runtime;if(!V){if(!M("get")){return -1}}if(!S){T=P(T)}J.get(T,function(Y){try{var W=baidu.json.decode(Y);R(W);if(W.result=="offline"||W.result=="kicked"){D.call({from:"webim.Net",event:"offline"})}}catch(X){}})}function O(T,R,S,V){var U=I.T.Runtime;if(!V){if(!M("getByServer")){return -1}}if(!S){T=P(T)}if(T.indexOf("callback=")==-1){T+="&callback=t"}J.getByServer(T,function(Y){try{var W=baidu.json.decode(Y);R(W);if(W.result=="offline"||W.result=="kicked"){D.call({from:"webim.Net",event:"offline"})}}catch(X){}})}function L(T,W,R,S,V){var U=I.T.Runtime;if(!V){if(!M("post")){return -1}}if(!S){W=E(W)}J.post(T,W,function(Z){try{var X=baidu.json.decode(Z);R(X);if(X.result=="offline"||X.result=="kicked"){U.remove("session");D.call({from:"webim.Net",event:"offline"})}}catch(Y){}})}function F(){J.abort()}function N(S,R){R(1)}var B={configKey:"Net",init:N,get:C,getByServer:O,post:L,abort:F};baidu.lang.module("webim.Net",B);webim.Core.addModule(B)})();(function(){var G="";var A={"default":{title:"\u9ed8\u8ba4\u5206\u7ec4",items:[{n:"\u5fae\u7b11",s:":)",m:"1e376a99d4059562772aad9ac065fd71"},{n:"\u5927\u7b11",s:":D",m:"c5ce7689438e5ee92c5942d4885fc198"},{n:"\u5077\u7b11",s:"(tx)",m:"d2ff68289e44c32d61f17e9cfb8f781a"},{n:"\u61a8\u7b11",s:":o",m:"564396330c9e704c27533dd0a9f38d56"},{n:"\u5f97\u610f",s:"(dy)",m:"33991a718d98b7bde46d1656acd1d84f"},{n:"\u53ef\u7231",s:"(ka)",m:"1eac4820cb2162ad0ea9050f730701ea"},{n:"\u5bb3\u7f9e",s:"(hx)",m:"afb7b910b894d8638a5f5f60d66080bb"},{n:"\u4e56",s:"(oo)",m:"6eeeea78151b0d992342b5d974ea9748"},{n:"\u6dd8\u6c14",s:"(tq)",m:"3567d74d273570047d563a52487b458d"},{n:"\u8c03\u76ae",s:":p",m:"17a002956048d2cc3e7136a60995f4c5"},{n:"\u6d41\u6cea",s:"(ll)",m:"6d177c2e8caa44b47950afd1c2d94ea1"},{n:"\u5927\u54ed",s:":'(",m:"f2468ad19982b6109525f86e60da0a40"},{n:"\u6487\u5634",s:"(pz)",m:"f4075f32764665658fe69d475536685f"},{n:"\u95ed\u5634",s:":-#",m:"97aac5ef30ca5c313f5055d3303a901a"},{n:"\u5618",s:"(xu)",m:"ea12132c217e29cc32a70ef2123baa55"},{n:"\u9119\u89c6",s:"(bs)",m:"0fd150d82ae7f2d174c9601f9ee09247"},{n:"\u50b2\u6162",s:"(am)",m:"8484e2fcd13826ff6d311fa23f6133f1"},{n:"\u767d\u773c",s:"(fc)",m:"46e7c6b53203f314943f5af66f6b9daf"},{n:"\u56f0",s:"|-)",m:"fd2bdb138346f328795d068df107ec90"},{n:"\u7761",s:"(zz)",m:"d6c03a77dc812595b2f41fdde34d05a6"},{n:"\u6c57",s:"(lh)",m:"fd2f51cd66989306299d8ad075abbc89"},{n:"\u5c34\u5c2c",s:":$",m:"b143058415f04e4f21302736326fb37c"},{n:"\u60ca\u8bb6",s:":-o",m:"c6fbb9628da63dc12c9a1fef25dea934"},{n:"\u60ca\u6050",s:"(jk)",m:"4a19620c98f2d809ea46900a0b552d7c"},{n:"\u7591\u95ee",s:"(?)",m:"7e9cbda5e0b325f01d478f8e4adf69b2"},{n:"\u6655",s:":s",m:"18c3ccd14d992d8e5aa30acfe670d42f"},{n:"\u96be\u8fc7",s:":(",m:"f2e7df81f1e48584a82c82f99d266b7c"},{n:"\u59d4\u5c48",s:"(wq)",m:"3ced67ed7484ec180470b6cf8f0e44b3"},{n:"\u8272",s:"(se)",m:"5c0aacf4ce01a07aa72ced20edfb1fb0"},{n:"\u6293\u72c2",s:"(zk)",m:"fd78f2b8f16086a940e90f370b2bb0d4"},{n:"\u6124\u6012",s:":@",m:"c6d1d4982260a4bad13aab943f7799f0"},{n:"\u5410",s:"+o(",m:"658d87d64e128385f28a59c15aa8cb91"},{n:"\u8870",s:"(sh)",m:"ae2b37bc2c8186a5dad63a583ad278cb"},{n:"\u518d\u89c1",s:"(zj)",m:"b6db7f3a9e8a9c864046eb0eaa15942d"},{n:"Hi",s:"(hi)",m:"33037bedc05c33f5998f875c608d4ba1"},{n:"\u4fbf\u4fbf",s:"(bb)",m:"490183579bb95ab6eee1d695cdaef213"},{n:"\u86cb\u7cd5",s:"(^)",m:"47198bf11c75a03e6249a1ccc1064bce"},{n:"\u5403\u996d",s:"(cf)",m:"e3aac3a4e1e36a02959f62d9bbcab7ac"},{n:"\u732a\u5934",s:"(zt)",m:"ede07ac7f02fbc613381069a77ff1b5c"},{n:"\u5200",s:"(d)",m:"d32893593db6217773e102bd694db4d8"},{n:"\u7231\u60c5",s:"(ai)",m:"7f73aeabe8ddb4bb23e06de4e6072e40"},{n:"\u5fc3\u788e",s:"(xs)",m:"b5fbcef53bf2d695db6bd48faa326585"},{n:"\u9c9c\u82b1",s:"(xh)",m:"5bc342dfc4b92d4c0cad3a4207a99380"},{n:"\u67af\u840e",s:"(kw)",m:"9ef7d4c187f298a10953f5096cbe9162"},{n:"\u63e1\u624b",s:"(ws)",m:"a21bf8c01f41b9148b81aa1b53fb3a0e"},{n:"\u80dc\u5229",s:"(sl)",m:"f08d998e04027d92feaf0f8667bb016c"},{n:"\u5927\u62c7\u6307",s:"(n)",m:"2f5113cfd0a33bfec485c222051db205"},{n:"\u5f31",s:"(r)",m:"2ea09b4e887a6871e22d6e52a014179c"},{n:"\u601d\u8003",s:"(sk)",m:"8c1066c3a4fc9115b46e3ae72a19e3f4"},{n:"\u6572\u6253",s:"(qd)",m:"d237de97c3277b7749ce839db39b0649"},{n:"\u5de6\u62e5\u62b1",s:"({)",m:"3890735fdd2f25319367532f660bbcd2"},{n:"\u53f3\u62e5\u62b1",s:"(})",m:"28a6dcccc96ad6d3082a0ff5554bebd6"},{n:"\u95ea\u4eba",s:"(sr)",m:"eb06e9170d5b470f124d3943f537e714"},{n:"\u543b",s:"(w)",m:"11d117a72c9cd5ffa2110c31cb4a385b"},{n:"OK",s:"(ok)",m:"f143718613f47bb929e7134b2457f260"},{n:"\u5496\u5561",s:"(kf)",m:"d6bde4b624846fd08500053358e154ae"},{n:"\u592a\u9633",s:"(#)",m:"75132ac5d361fd71a0b8acc6d99b7692"},{n:"\u6708\u4eae",s:"(s)",m:"5bbb83756e3e652b43f9f03d638718b4"},{n:"\u661f\u661f",s:"(*)",m:"dcb31cac1b742034e9cdc5254f309d00"},{n:"\u94b1",s:"(q)",m:"eeb68b5c092155df924e69b2a1de21f9"}]},bear:{title:"Hi\u6c14\u6ce1\u718a",items:[{n:"\u5fae\u7b11 ",s:"(wx)",m:"36c7fbde6243e1ab056d26ed04da4626"},{n:"\u5e05\u54e5",s:"(sg)",m:"8173ba953e8b2cba6a9745e798964940"},{n:"\u7f8e\u5973",s:"(mm)",m:"266fc64ac2949059bc4247ff36c8c72a"},{n:"\u8001\u5927",s:"(ld)",m:"013f44177c9661fa9e9b53a5d7ad810a"},{n:"\u54c8\u54c8\u54c8",s:"(:dx)",m:"ece2d90fabf36d2868d033fe941c2505"},{n:"\u5978\u7b11",s:"(jx)",m:"ed27bd44748988b291e3de517000a8ea"},{n:"\u50bb\u4e50",s:"(ssl)",m:"9c1abc04d03aef9f13672fcb7c27b5df"},{n:"\u98de\u543b ",s:"(:fw)",m:"82f2fac9575da046058dd47e204a2a5f"},{n:"\u5bb3\u7f9e ",s:"(:hx)",m:"29c4befb29a5b1d3856b2812c6426246"},{n:"\u82b1\u75f4",s:"(hc)",m:"d2f1967481629b751c015ddb2897aef5"},{n:"\u61a7\u61ac",s:"(cj)",m:"2d27536e0981cec8f6654f3f638e0cfe"},{n:"\u4f60\u725b",s:"(nb)",m:"07f0eab7fc6e195da290fee8bb61861a"},{n:"\u9f13\u638c",s:"(gz)",m:"63ceb8fc549ab868cc2eb588f24805fa"},{n:"\u53ef\u7231 ",s:"(:ka)",m:"f593596553738a8070b15cbe3b453a4b"},{n:"\u59d4\u5c48 ",s:"(:wq)",m:"6f5cf65eb4860e5b9c161e96334257a5"},{n:"\u5927\u54ed ",s:"(:dk)",m:"4b5649fe0d7ca648e9ef875430726629"},{n:"\u6cea\u5954 ",s:"(:lb)",m:"5231f00f23672f96b49e23b903f51571"},{n:"\u5bfb\u6b7b",s:"(:xs)",m:"ea8dd5a956ba9e59160e9a6a97fd3159"},{n:"\u60ca\u8bb6 ",s:"(jy)",m:"eb2defeb5905451d0d07f1ff466909aa"},{n:"\u7591\u95ee ",s:"(:yw)",m:"b7c86b2b58cfded752fef914143325bb"},{n:"\u9119\u89c6 ",s:"(bsn)",m:"9b84f79c40188db4771c2577187b154e"},{n:"\u5927\u9a82",s:"(dm)",m:"646ec54dda651d383db0038e925eb601"},{n:"\u72c2\u6012",s:"(kn)",m:"e70bf9f4757ae74b4f86471aa0dc72d5"},{n:"\u56e7",s:"(j)",m:"40ad40f89dce47fc7f020e86cf951750"},{n:"\u6655 ",s:"(yun)",m:"83128d1230675135df522efa6fdd32e7"},{n:"\u5455\u5410",s:"(tu)",m:"4fc9d77ddbc754ee674f0f9c50e2056f"},{n:"\u8d22\u8ff7",s:"(cm)",m:"97d24895c4d6033ab5d302ebbb72edb6"},{n:"\u7761\u4e86",s:"(zzz)",m:"31f561aa78f16cea9e1f02183312b58c"},{n:"\u601d\u8003 ",s:"(xk)",m:"1105a0ae3b17c52432a65833ad825739"},{n:"\u6c57 ",s:"(han)",m:"e5744442fa792ea055ad78137f1a1cac"},{n:"\u65e0\u8bed",s:"(wy)",m:"2d15778775f3c0f76bcf47abc8a375f8"},{n:"\u62dc",s:"(bai)",m:"fcf60dc85c60f1800d030bd89e07e3f4"},{n:"\u97a0\u8eac",s:"(jg)",m:"6915fe7dea48ceb50e57296782b423f7"},{n:"\u7d2f\u4e86",s:"(lei)",m:"5e5db52f522182d91051c607be072a37"},{n:"\u75c5\u4e86",s:"(b)",m:"47ad9be303e3f1ffe93876051959a787"},{n:"\u5899\u89d2",s:"(qj)",m:"0022cb45e57684b4e87b48783dc12183"},{n:"\u8d85\u4eba",s:"(cr)",m:"b26fcee08cea8022c47f75f2a092823f"},{n:"\u6233",s:"(ch)",m:"6fc208bfaff0d8f40bb0db9196446b12"},{n:"\u8df3\u821e",s:"(tw)",m:"d9513f71ad92be76312f665fcb241879"},{n:"\u9b3c\u8138",s:"(gl)",m:"8006125c59cb94d0f73d5404a25725ae"},{n:"\u65e0\u804a",s:"(wl)",m:"e23def0114dd74dca485b1c31d59f3f3"},{n:"\u649e\u5899",s:"(zq)",m:"e91b1ccab6f366af693fec4067cdbd7a"},{n:"\u9876",s:"(sp)",m:"8bf6b90924fe625318b23753915d179b"},{n:"\u96c6\u4f53\u821e",s:"(jtw)",m:"f0d88e469af4fefd1170c4c85d2bfb99"},{n:"\u6253\u4eba",s:"(dr)",m:"5ef9889599d2f0ddfd990746809d6166"},{n:"\u63e1\u624b ",s:"(:ws)",m:"4c753e16dd5c9dc0da21402374691735"},{n:"\u5b89\u6170",s:"(aw)",m:"ee8fa5bcbd36241820d14ae1b46648d2"},{n:"\u5575\u5575",s:"(bo)",m:"8916a811f491ddfafd61986375665cc9"},{n:"Hi ",s:"(:hi)",m:"630df8bd6950c9395b39c611809822fb"},{n:"\u996d",s:"(ff)",m:"82fa0db5f4ac8e95c7fa97c2f028a411"},{n:"\u86cb\u7cd5 ",s:"(dg)",m:"78703efec3547b13f2e6e5a3dd63286a"},{n:"\u793c\u7269",s:"(lw)",m:"2e95741468c5cf64bb9d51a12c374646"},{n:"\u5fc3",s:"(xin)",m:"a0bed224deffa67327623313cc5c5231"},{n:"\u5fc3\u788e ",s:"(xsl)",m:"745e57c9ea78d1c48a030b793a2539af"},{n:"\u73ab\u7470",s:"(mg)",m:"4afbd9e87b0e27b98d4620e457a8ac63"},{n:"\u70b8\u5f39",s:"(zd)",m:"5f4fdb939b838fce3f78161d4f5b5a3e"},{n:"\u62cd\u62cd",s:"(pp)",m:"d885a150c3d14aafeaf823fa57a09c68"},{n:"\u4eb2\u4eb2",s:"(qq)",m:"1aa61038900f78cb8b4f57ca6f00fa17"},{n:"\u77f3\u5934",s:"(st)",m:"53cdc51684cc27b688cebd3e8a4801a5"},{n:"\u526a\u5200",s:"(jz)",m:"8467ecac043b423891b928f654483156"},{n:"\u5e03",s:"(bu)",m:"7b7492097c2fbb7a4c553c254f4a5994"},{n:"\u606d\u559c\u5566",s:"(gx)",m:"ee79ba86cbf7c888fb05a1284617857d"}]},youa:{title:"\u6709\u554a\u8868\u60c5",items:[{n:"\u7537\u515c",s:"(nd)",m:"d923dbf00b642078c2e3783f6f79b7bc"},{n:"\u5973\u515c",s:"(nvd)",m:"f054e7cb63e9c3ae6dc92e4f7970b15a"},{n:"\u5f00\u5fc3",s:"(kx)",m:"3984744c44406f9516ac97f14f8f4a94"},{n:"\u4e56\u4e56",s:"(gg)",m:"97a3bc26de5e7d5c578ffcff92784234"},{n:"\u5077\u7b11\u3000",s:"(:tx)",m:"a75928d0fe98d17c084ac411750da03b"},{n:"\u5927\u7b11\u3000",s:"(dx)",m:"a2d411f7eb8472b2dc5cb5d0e6cd871d"},{n:"\u62bd\u6ce3",s:"(cq)",m:"eb4e6ddad686dc9a01983ade1c2959c0"},{n:"\u5927\u54ed\u3000",s:"(dk)",m:"1eb8aabfaa423e6fbdfa2e6faedea210"},{n:"\u65e0\u5948",s:"(wn)",m:"480e05a180234b2eed917659ad8bc5b9"},{n:"\u6ef4\u6c57",s:"(hd)",m:"e63b0f3f136ff6f48b214c19b0547a1d"},{n:"\u53f9\u6c14",s:"(tqi)",m:"01025799c89cb1eb67814b5ef3f102b6"},{n:"\u72c2\u6655",s:"(ky)",m:"24bdf1f85b7335a2bfdea21aecaa502d"},{n:"\u59d4\u5c48\u3000",s:"(wqu)",m:"a8a488035f25ca63530a8a979beb72e5"},{n:"\u8d85\u8d5e",s:"(cz)",m:"f6dffd7867799a07b36a6d5d548c8247"},{n:"\u56e7\u56e7",s:"(jj)",m:"da3c71a49ef9ea18e10b6201d9fb793f"},{n:"\u7591\u95ee\u3000",s:"(yw)",m:"5a68de543ec8c72fb3142c939e2fb2e2"},{n:"\u98de\u543b",s:"(fw)",m:"1693bff59ce27d5537f8c1c35bea08f6"},{n:"\u5929\u4f7f",s:"(ts)",m:"0228e4709bddba1e11e0df49f40b039a"},{n:"\u6492\u82b1",s:"(hua)",m:"e22e54f7be1e2e999c0a4b10c6c1fd36"},{n:"\u751f\u6c14",s:"(sq)",m:"ce0efd9b1065a9c32120f57cfce01fa7"},{n:"\u88ab\u7838",s:"(bz)",m:"64996975385f3239169de64f0726e351"},{n:"\u53e3\u6c34",s:"(ks)",m:"d4696e8fba488cf64b920900eae2474b"},{n:"\u6cea\u5954",s:"(lb)",m:"865e4984298507c91356f7ea93bb9c91"},{n:"\u5413\u50bb",s:"(xia)",m:"a95a3f61f00c3c6a2542c44e5a8c54f1"},{n:"\u5410\u820c\u5934",s:"(tst)",m:"4f4dd01413a96ec2982cd318f4b7f317"},{n:"\u70b9\u5934",s:"(dt)",m:"c66071425f7cfffa00acc9c5ae299e77"},{n:"\u968f\u610f\u5410",s:"(syt)",m:"f1a07cb1c44d659831dbef7e8d4fa13d"},{n:"\u65cb\u8f6c",s:"(xz)",m:"a9a909e49309d8430bd88bedcd213d9f"},{n:"\u56f0\u56f0",s:"(kk)",m:"0f6c2477050285a33347805d86a94d17"},{n:"\u9119\u89c6\u3000",s:"(:bs)",m:"c5c3990f843ff99b964dfbc5ce77f3ac"},{n:"\u544a\u793a",s:"(gs)",m:"3c0f70c965fb07a0c92ba6010b115c93"},{n:"\u7bee\u7403",s:"(lq)",m:"d6c92983218597f1e03374f90b0c8896"},{n:"\u72c2\u9876",s:"(kd)",m:"c2cd066e8df775ee02e1f84f4c8febb0"},{n:"\u7529\u5934\u53d1",s:"(stf)",m:"9b7632dc820b2a952e34dff1bee17db1"},{n:"\u518d\u89c1\u3000",s:"(bye)",m:"0d98833aee6e63fcd3f1cfc728dad66b"},{n:"\u8d85\u4eba\u3000",s:"(cc)",m:"6210166e868bfc9747648b62b46cfcc6"},{n:"\u8fc7\u5e74\u597d",s:"(gnh)",m:"09689b9307f90b6568340befafe39e5c"},{n:"\u7ea2\u5305\u62ff\u6765",s:"(hb)",m:"bf58f8260b994cf6fa07601f5d194e3f"},{n:"\u606d\u559c\u53d1\u8d22",s:"(:gx)",m:"399ca36413576124428b2a89c51e6970"},{n:"\u6b22\u8fce\u5149\u4e34",s:"(hy)",m:"98b000b5aa8f6f200d4c227bd0406e42"},{n:"\u7a0d\u7b49",s:"(sd)",m:"ac7bb47cb022f8215e059573b7a721f5"},{n:"\u6211\u5728\u7ebf",s:"(wzx)",m:"3b225583cb9c3bdd7f4e7d47f3ff98a6"},{n:"\u6055\u4e0d\u8bae\u4ef7",s:"(byj)",m:"e62073630069871b7f8ade45ba13c9a3"},{n:"\u5e93\u623f\u6709\u8d27",s:"(yh)",m:"cf8370a69fbdf95f4cf56145687b37cd"},{n:"\u8d27\u5728\u8def\u4e0a",s:"(zls)",m:"64ffe8e7895c8a69bd72d9d5a2a1ed40"}]}};function E(J,I){J.url=G+I+"/"+J.m+".gif";J.name=J.n;J.shortcut=J.s;J.md5=J.m;return J}function C(J){var I=null;for(var K in A){baidu.each(A[K].items,function(L){if(L.name==J){I=L}})}return I}function F(J){var I=null;for(var K in A){baidu.each(A[K].items,function(L){if(L.shortcut==J){I=L}})}return I}function B(I){return A[I]}function H(K,I){G=K.faceBasePath||"http://web.im.baidu.com/images/sysface/";for(var J in A){baidu.each(A[J].items,function(M,L){A[J]["items"][L]=E(M,J)})}I(1)}var D={init:H,configKey:"Face",getByName:C,getByShortcut:F,getListByType:B};baidu.lang.module("webim.Face",D);webim.Core.addModule(D)})();(function(){var V=webim.Core;var R=V,J=webim.model.DataService,A=webim.Util,Y=webim.Logger;var B=webim.Net;var U=30*1000,E=50*1000;var Z=null,P=null,C=null;var L=0,M=null;function O(a){var d=Y.trace();Y.info("[System.login]\ncallback:"+typeof (a),"api",O,d);var b=J.T.Runtime,e=J.T.User;var c=this;a=a||function(){};B.getByServer(V.baseUrl+"/check",function(f){Y.log("[System.login.check]\njson:"+baidu.json.encode(f),null,null,d);if(f.result=="ok"){B.post(V.baseUrl+"/welcome","",function(g){Y.log("[System.login.welcome]\njson:"+baidu.json.encode(g),null,null,d);if(g.result=="ok"){var h=g.content;C=h.session;b.saveAndExpires("session",C,E);V.call({from:"webim.System",event:"online"});Q();a(1)}else{a(0);V.call({from:"webim.System",event:"offline"})}},false,true)}else{a(0);V.call({from:"webim.System",event:"offline"})}},false,true)}function K(a){var b=this;a=a||function(){};B.getByServer(V.baseUrl+"/check",function(c){if(c.result=="ok"){a(1)}else{a(0)}},false,true)}function W(b){b=b||function(){};var c=J.T.Runtime;var a=B.post(V.baseUrl+"/logout","",function(d){if(d.result=="ok"){V.call({from:"webim.System",type:"logout"});b(1)}else{V.call({from:"webim.System",event:"offline"});b(0)}});if(a==-1){V.call({from:"webim.System",type:"logoutError"})}}function X(a,c){var d=J.T.User,b=J.T.Runtime;if(!b.get("isInitBlockList")){c=c||0;B.getByServer(V.getUrl+"/blocklist?page="+c,function(e){if(e.result=="ok"){var f=[];baidu.each(e.content.fields,function(g){f.push({username:g.username,isBlocked:1,status:"offline"})});if(f.length>0){d.save(f)}if(e.content.nextPage){X(a,e.content.nextPage)}else{b.save({key:"isInitBlockList",value:1});a(1)}}else{a(0)}})}else{b.save({key:"isInitBlockList",value:1});a(1)}}function Q(){var c=Y.trace();Y.log("[System.login.initIM]",null,Q,c);var a=J.T.Preference,d=J.T.User;var b=a.get("status");B.post(V.baseUrl+"/init",(b?"status="+b.value:""),function(e){Y.log("[System.login.init]\njson:"+baidu.json.encode(e),null,null,c);if(e.result=="ok"){var f=e.content;if(f.username!=webim.Core.username){webim.Core.username=f.username}a.save([{key:"voice",value:f.voice},{key:"tempMessagePolicy",value:f.tempMessagePolicy},{key:"username",value:f.username}]);d.save({username:f.username,showname:((f.nickname!==undefined&&f.nickname!=="")?f.nickname:f.username),showtype:((f.nickname!==undefined&&f.nickname!=="")?2:1),isLoaded:1});V.call({from:"webim.System",event:"preferenceChange",data:a.get("voice")});V.call({from:"webim.System",event:"preferenceChange",data:a.get("tempMessagePolicy")});X(function(){webim.Logger.report({loginprocess:1});F()})}else{V.call({from:"webim.System",event:"offline"});cb(null)}})}var N=null,H=19010;function I(a){var a=a||19000;if(a<=H){B.getByServer("http://127.0.0.1:"+a+"/ml/test?callback=t",function(b){clearTimeout(N);T(a)},false,true);N=setTimeout(function(){I(a+2)},500)}}function T(a){var b=webim.Net;b.getByServer("http://127.0.0.1:"+a+"/ml/gcode?callback=v",function(c){b.post(V.baseUrl+"/modifyself","pccode="+c,function(){})})}function F(c){var a=J.T.Runtime;if(L<0){return 0}if(!c){var b=a.getAndExpires("lastAck");if(b){c=b.value}}c=c||"";if(a.getAndExpires("session")){a.saveAndExpires("session",a.getAndExpires("session").value,E)}B.get(V.baseUrl+"/pick?flag=1&type=3&ack="+c,function(d){if(d.result=="ok"){if(d.content.fields){try{baidu.each(d.content.fields,function(e){V.call({from:"webim.System",type:"pick",command:e.command,result:d.result,ack:d.content.ack,field:e})})}catch(f){webim.Logger.report({error:1,pickError:1,content:baidu.json.encode(d),e:baidu.json.encode(f)})}}if(d.content.ack){M=d.content.ack;a.saveAndExpires("lastAck",M,E)}setTimeout(function(){F(M)},10)}})}function D(){L=-1}function S(b,a){V.listen({from:"webim.Core",action:"needLogin"},function(){O(function(c){if(c){I();V.call({from:"webim.System",event:"getoldmessage"})}})});V.listen({from:"webim.Core",action:"needPick"},function(){V.call({from:"webim.System",event:"online"});I();F()});V.listen({from:"webim.System",type:"pick",command:"reportpccodenotify",result:"ok"},function(){I()});a(1)}var G={configKey:"System",init:S,login:O,logout:W,isPassportOnline:K};baidu.lang.module("webim.System",G);V.addModule(G)})();(function(){var a=webim.Core;var Y=a,I=webim.Util;var M=a.getDataService();var F=webim.Net;var d=webim.Logger;var W=[];var U;var R=3*1000;function V(g){var f=[],h=M.T.Recent;baidu.each(g,function(i){if(i.tid!=h.TID){f.push({tid:i.tid,name:i.name,onlineCount:i.online,userCount:i.total,isLoaded:1})}});return f}function O(g){var f=[];baidu.each(g,function(h){if(h.username&&h.username!=""){var i={username:h.username,un:h.un,showname:h.showname,showtype:h.showtype,status:h.status||"offline",relationship:h.relationship,isLoaded:1};if(h.isBlocked!=undefined){i.isBlocked=h.isBlocked}f.push(i)}});return f}function E(h,g){var f=[];baidu.each(g,function(i){if(i.username&&i.username!=""){f.push({tid:h,username:i.username})}});return f}function c(g){var f=[];baidu.each(g,function(h){if(h.username&&h.username!=""){f.push(h.username)}});return f}function H(g){var f=M.T.Runtime;if(g||!f.getAndExpires("refreshTeamList")){f.saveAndExpires("refreshTeamList",1,10*1000);f.remove("isLoadTeamList");T(function(h){baidu.each(h,function(i){a.call({from:"webim.Contact",event:"teamChange",data:i})})})}}function T(g){var j=d.trace();d.info("[Contact.getTeamList]:\ncallback:"+typeof (g),"api",T,j);var f=M.T.Team,h=M.T.Runtime;if(h.get("isLoadTeamList")){var i=f.getList(null,null,null,f.DEFAULT_TEAM_COMPARATOR);d.log("[Contact.getTeamList] load from local: \nTeamList:"+baidu.json.encode(i),null,null,j);g(i);return 0}d.log("[Contact.getTeamList] prepare to load from local",null,null,j);F.getByServer(a.getUrl+"/getteaminfo",function(k){d.log("[Contact.getTeamList] loaded from net: \njson:"+baidu.json.encode(k),null,null,j);if(k.result=="ok"){var m=V(k.content.fields);f.save(m);h.save({key:"isLoadTeamList",value:1});var l=f.getList(null,null,null,f.DEFAULT_TEAM_COMPARATOR);g(l)}else{g(f.getList(null,null,null,f.DEFAULT_TEAM_COMPARATOR))}})}function C(f){d.info("[Contact.getRecentList]:\ncallback:"+typeof (f),"api",C);var g=M.T.Recent;b(g.TID,f,g.RECENT_USER_COMPARATOR)}function N(j){var g=M.T.Recent,i=M.T.User,f=M.T.Runtime;var h=baidu.array.indexOf(W,j);if(h>-1){W.splice(h,1)}W.push(j);if(U){return 0}U=setTimeout(function(){C(function(){var k=g.addToRecent(W.length==1?W[0]:W);if(k){F.post(a.baseUrl+"/savelatest","un="+g.getRecentUnList(i).join(),function(l){a.call({from:"webim.Contact",event:"recentChange",data:g.getUserList(i)});f.save({key:"recentReload",value:1})})}W=[];clearTimeout(U);U=null})},R)}function b(k,j,f,p,m){p=p||0;var l=d.trace();d.info("[Contact.getUserListByTeamId]:\ntid:"+k+"\ncallback:"+typeof (j)+"\ncomparator:"+typeof (f),"api",b,l);var n=M.T.Team,q=M.T.User,r=M.T.TeamUser,i=M.T.Recent,g=M.T.Runtime;var h=n.get(k);if(h&&h.isUserInited){var o=r.getUserListByTeamId(k,f,q);d.log("[Contact.getUserListByTeamId] load from local: \nuserList:"+baidu.json.encode(o),null,null,l);j(o);return 0}if(k==i.TID&&g.get("isLoadedRecent")){j(i.getUserList(q));return 0}d.log("[Contact.getUserListByTeamId] prepare to load from net: \ntid:"+k,null,null,l);F.getByServer(a.getUrl+"/getfriendlist?tid="+k+(p?"&page="+p:""),function(s){d.log("[Contact.getUserListByTeamId] loaded from net: \njson:"+baidu.json.encode(s),null,null,l);if(s.result=="ok"){var t=O(s.content.fields);q.save(t);if(k==i.TID){i.addToRecent(c(t).reverse())}else{r.save(E(k,t))}if(s.content.nextPage){if(m){m(t,p)}b(k,j,f,s.content.nextPage)}else{if(k!=i.TID){n.save({tid:k,onlineCount:r.countNonOfflineUserByTeamId(k,q),isUserInited:1});a.call({from:"webim.Contact",event:"teamChange",data:n.get(k)});j(r.getUserListByTeamId(k,f,q))}else{g.save({key:"isLoadedRecent",value:1});j(i.getUserList(q))}}}})}function X(l,j,g){var k=M.T.User,f=M.T.Team,i=M.T.TeamUser,h=M.T.ExtendUser;F.post(a.baseUrl+"/blockuser","self="+a.getUsername()+"&username="+l+"&operation="+(j?"block":"unblock"),function(o){if(o.result=="ok"){var m=k.get(l);if(m){j?m.isBlocked=1:m.isBlocked=0;k.save(m);if(h.get(m.username)){h.save({username:m.username,isBlocked:(j?1:0)})}var p=i.get(l);if(p){var n=f.get(p.tid);if(n&&n.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:n,users:i.getUserListByTeamId(n.tid,null,k)})}}a.call({from:"webim.Contact",event:"userChange",data:k.get(l),master:true})}g(1)}else{g(0)}})}function S(i,g,l){var j=d.trace();d.info("[Contact.getUser]:\nusername:"+i+"\ncallback:"+typeof (g),"api",S,j);var m=M.T.User,k=M.T.Team,n=M.T.TeamUser,f=M.T.ExtendUser;var h=m.get(i);if(!l&&h&&h.isLoaded){d.log("[Contact.getUser]:load from local:\nuser:"+baidu.json.encode(h),null,null,j);g(h);return 0}d.log("[Contact.getUser]:prepare load from net:\nusername:"+i,null,null,j);F.getByServer(a.getUrl+"/queryinfo?username="+encodeURIComponent(i),function(p){d.log("[Contact.getUser]:loaded from net:\njson:"+baidu.json.encode(p),null,null,j);if(p.result=="ok"){var r=O(p.content.fields);var o=r[0];if(o.relationship==3){J(i,o.status)}else{var q=f.get(i);if(q){o.status=q.status}}m.save(o);g(o)}else{if(p.result=="offline"){g(-1)}else{g(0)}}})}function J(i,f){var g=M.T.ExtendUser;var h=g.get(i);if(h&&h.status!=f){g.save({username:i,status:f});a.call({from:"webim.Contact",event:"extendUserListChange"})}}function D(h,g){var f="type=addfriend&username="+h;S(h,function(i){if(i){if(i.relationship!=3){F.post(a.baseUrl+"/verifycode",f,function(j){if(j.result=="ok"){j.content.validate.v_src=B(j.content.validate.v_url);g(j.content.validate)}})}else{g(0)}}else{g(0)}})}function e(h,f,q,j,l,o){var i=d.trace();d.info("[Contact.addAsContact]:\nusername:"+h+"\ntid:"+f+"\ncallback:"+typeof (q)+"\ncomment:"+j+"\nvalidateCb:"+typeof (l)+"\nvalidate:"+baidu.json.encode(o),"api",e,i);var k=M.T.Team,n=M.T.User,p=M.T.TeamUser;var m=this;var g="username="+encodeURIComponent(h)+"&tid="+f+"&comment="+encodeURIComponent(j);g+=(o?"&validate="+o.v_url+","+o.v_period+","+o.v_time+","+o.v_code:"");m.getUser(h,function(r){if(r.syssession){g+="&sys_session="+r.syssession}F.post(a.baseUrl+"/addfriend",g,function(t){if(t.result=="ok"||(t.result=="error"&&"wait_agree"==t.content.errorMessage)){d.log("[Contact.addAsContact]:\nbranch:1\njson:"+baidu.json.encode(t),null,null,i);var s=n.get(h);if(s){s.isLoaded=false}m.getUser(h,function(w){p.addToTeam(h,f);H(true);var v=k.get(f);if(v&&v.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:v,users:p.getUserListByTeamId(f,null,n)})}a.call({from:"webim.Contact",event:"userChange",data:n.get(h),master:true});q(1,t.content.errorMessage)})}else{if(t.result=="validate"){d.log("[Contact.addAsContact]:\nbranch:validate\njson:"+baidu.json.encode(t),null,null,i);F.post(a.baseUrl+"/verifycode","type=addfriend&username="+encodeURIComponent(h),function(u){if(u.result=="ok"){u.content.validate.v_src=B(u.content.validate.v_url);l(h,f,q,j,l,u.content.validate)}else{q(0)}})}else{if(t.result=="error"){d.log("[Contact.addAsContact]:\nbranch:0\njson:"+baidu.json.encode(t),null,null,i);q(0,t.content.errorMessage)}}}})})}function B(f){return"http://vcode.im.baidu.com/cgi-bin/genimg?"+f}function Q(g,f){var h=M.T.User;F.getByServer(a.getUrl+"/searchfriend?query="+encodeURIComponent(g),function(n){if(n.result=="ok"){var p=n.content.fields;for(var m=0,j=p.length;m<j;m++){var o=p[m],k=h.get(o.username);if(k){p[m].isBlocked=k.isBlocked}}p=O(p);f(p)}})}function P(k,f,j,i){var h=M.T.User;var g="username="+k+"&agree="+(f?1:0)+"&comment="+j;S(k,function(l){if(l.syssession){g+="&sys_session="+l.syssession}F.post(a.baseUrl+"/verifyfriend",g,function(m){if(m.result=="ok"){if(f){H(true)}else{}i(1)}else{i(0)}})})}function L(){var g=M.T.Runtime,f=M.T.Team,j=M.T.TeamUser,k=M.T.User,h=M.T.Recent;g.remove("isLoadTeamList");try{g.remove("isLoadedRecent");g.remove("isLoadTeamList");j.clear();f.clear();a.call({from:"webim.Contact",event:"teamListReload",data:f.getList()})}catch(i){}}function Z(l,g){var m=M.T.User,f=M.T.Team,k=M.T.TeamUser,j=M.T.Recent,i=M.T.Runtime,h=M.getBaseTable();m.listen({type:[h.ACTION_ADD,h.ACTION_UPDATE]},function(p){a.call({from:"webim.Contact",event:"userChange",data:m.get(p.value)});var o=k.get(p.value);if(o){var n=f.get(o.tid);if(n.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:n,users:k.getUserListByTeamId(n.tid,null,m)})}}});f.listen({type:h.ACTION_ADD},function(n){if(i.get("isLoadTeamList")){a.call({from:"webim.Contact",event:"teamListChange",data:f.getList()})}});i.listen({type:h.ACTION_ADD,value:"isLoadTeamList"},function(n){a.call({from:"webim.Contact",event:"teamListReload",data:f.getList()})});f.listen({type:h.ACTION_UPDATE},function(o){var n=f.get(o.value);if(n&&n.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:n,users:k.getUserListByTeamId(n.tid,null,m)})}a.call({from:"webim.Contact",event:"teamChange",data:n})});k.listen({type:h.ACTION_UPDATE},function(o){var p=k.get(o.value);var n=f.get(p.tid);if(n&&n.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:f.get(o.value),users:k.getUserListByTeamId(n.tid,null,m)})}});i.listen({type:[h.ACTION_ADD,h.ACTION_UPDATE],value:"recentReload"},function(n){a.call({from:"webim.Contact",event:"recentChange",data:j.getUserList(m)})});A();G();g(1)}function A(){a.listen({from:"webim.Message",event:"messageListChange"},function(f){N(f.data)})}function G(){var j=M.T.User,i=M.T.TeamUser,f=M.T.Team,h=M.T.Runtime,g=M.T.ExtendUser;a.listen({from:"webim.System",type:"pick",command:"friendstatus",result:"ok"},function(o){var n=o.field.content;var l=j.get(n.username);if(l){var r=l.username;if(r!=a.getUsername()){var p={username:r};if(n.status){p.status=n.status}else{if(n.webStatus){if(!l.status||l.status=="offline"){p.status=n.webStatus}}}if(n.nickname!==undefined){if(n.nickname!=""){if(l.showtype!=3){p.showname=n.nickname;p.showtype=2}}else{if(l.showtype==2){p.showname=r;p.showtype=1}}}j.save(p);var k=j.get(r);a.call({from:"webim.Contact",event:"userChange",data:k,master:true});J(k.username,k.status);if(i.get(r)){var q=i.get(r).tid;var m=f.get(q);m.userCount=i.countUserByTeamId(q,j);m.onlineCount=i.countNonOfflineUserByTeamId(q,j);f.save(m);a.call({from:"webim.Contact",event:"teamChange",data:m})}}}});a.listen({from:"webim.System",type:"pick",command:"friendinfonotify",result:"ok",field:{content:{team_change$exists:true}}},function(k){L()});a.listen({from:"webim.System",type:"pick",command:"friendinfonotify",result:"ok",field:{content:{friend_change$exists:true}}},function(l){var m=l.field,k=m.content;L();if(!k.reload){baidu.each(k.friend_change.infos,function(n){S(n.username,function(o){a.call({from:"webim.Contact",event:"userChange",data:j.get(o.username),master:true});var q=i.get(o.username);if(q){var p=f.get(q.tid);if(p&&p.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:p,users:i.getUserListByTeamId(p.tid,null,j)})}}},true)})}});a.listen({from:"webim.System",type:"pick",command:"friendinfonotify",result:"ok",field:{content:{block_change$exists:true}}},function(l){var m=l.field,k=m.content;if(k.block_change.reload){return 0}baidu.each(k.block_change.infos,function(q){var n=j.get(q.username);switch(q.change){case"add":case"mod":if(!n||!n.isBlocked){j.save({username:q.username,isBlocked:1});if(g.get(q.username)){g.save({username:q.username,isBlocked:1})}a.call({from:"webim.Contact",event:"userChange",data:j.get(q.username),master:true})}break;case"del":if(!n||n.isBlocked){j.save({username:q.username,isBlocked:0});if(g.get(q.username)){g.save({username:q.username,isBlocked:0})}a.call({from:"webim.Contact",event:"userChange",data:j.get(q.username),master:true})}break}if(n){var p=i.get(n.username);if(p){var o=f.get(p.tid);if(o&&o.isUserInited){a.call({from:"webim.Contact",event:"teamUserChange",data:o,users:i.getUserListByTeamId(o.tid,null,j)})}}}})})}var K={configKey:"Contact",init:Z,search:Q,getTeamList:T,getUserListByTeamId:b,getUser:S,getRecentList:C,blockUser:X,addAsContact:e,verifyContact:P,prepareToAddContact:D};baidu.lang.module("webim.Contact",K);webim.Core.addModule(K)})();(function(){var S=webim.Core;var E=S,D=webim.Util;var j=S.getDataService();var d=webim.Net;var C=webim.Logger;var a=null;var I=3*1000;var R=[];var Z=[];function Q(m,n){var l=[];var k=A(m);l.push(n);baidu.each(k,function(o){switch(o.type){case"text":l.push({type:"text",c:o.content});break;case"url":l.push({type:"url",ref:o.content});break;case"face":l.push({type:"face",n:o.content});break}});return l}function i(m,n){var l=A(m);var k=["<msg>"];k.push('<font n="'+n.n+'" s="'+n.s+'" b="'+n.b+'" i="'+n.i+'" ul="'+n.ul+'" c="'+n.c+'"/>');baidu.each(l,function(o){switch(o.type){case"text":k.push('<text c="'+baidu.string.encodeHTML(o.content)+'"/>');break;case"url":k.push('<url ref="'+o.content.replace(/&/g,"&amp;")+'"/>');break;case"face":k.push('<face n="'+o.content+'"/>');break}});k.push("</msg>");return k.join("")}function H(m){var n={type:"font",n:"\u5B8B\u4F53",s:"10",b:0,i:0,ul:0,c:0};var l=["<msg>"];if(m.length>0&&m[0].type=="font"){var k=m[0];l.push('<font n="'+k.n+'" s="'+k.s+'" b="'+k.b+'" i="'+k.i+'" ul="'+k.ul+'" c="'+k.c+'"/>')}else{l.push('<font n="'+n.n+'" s="'+n.s+'" b="'+n.b+'" i="'+n.i+'" ul="'+n.ul+'" c="'+n.c+'"/>')}baidu.each(m,function(o){switch(o.type){case"text":l.push('<text c="'+baidu.string.encodeHTML(o.c)+'"/>');break;case"url":l.push('<url ref="'+o.ref.replace(/&/g,"&amp;")+'"/>');break;case"face":l.push('<face n="'+o.n+'"/>');break}});l.push("</msg>");return l.join("")}function A(o){var n="![[key]]!";o=o||"";var m=[],l=[],k=[];o=Y(P(o));o=o.replace(/\[(url|face)\s([^\]]+)\]/gi,function(r,p,q){l.push({type:p,content:q});return n});m=o.split(n);baidu.each(m,function(p,q){k.push({type:"text",content:p});if(l[q]){k.push(l[q])}});l=[];return k}function P(k){return k.replace(/\[([^\]]+)\]/gi,function(n,m){var l=webim.Face.getByShortcut(m);if(l){return"[face "+l.name+"]"}return m})}function Y(k){var l=/((((https?|ftp):\/\/[\w-]+)|\bwww)(\.[\w-]+)+(:\d+)?(\/[\w\u4e00-\u9fa5\uf900-\ufa2d%-]+){0,}(\/|\.[\w-]+)?(\?[\w-]*(=[^&=< >\r\n]*)?(&[\w-;]*(=[^&=< >\r\n]*)?){0,})?)/gi;return k.replace(l,function(r,y,x,w,v,u,t,s,q,o,p,n,m){return"[url "+("www"==x?"http://":"")+y+"]"})}function c(p,l,o){var k={type:"font",n:"\u5B8B\u4F53",s:"10",b:0,i:0,ul:0,c:0};baidu.object.extend(k,o);o=k;var m=new Date().getTime();var n={mid:h(m),sender:S.getUsername(),receiver:p,content:Q(l,o),isRead:1,time:m};return n}function T(s,o,m,l,r,k){C.info("[Message.send]:\nto:"+s+"\ncontent:"+o+"\nparams:"+baidu.json.encode(m)+"\ncb:"+typeof (l)+"\nvalidate:"+baidu.json.encode(r)+"\nvalidateCb:"+typeof (k),"api",T);var n={type:"font",n:"\u5B8B\u4F53",s:"10",b:0,i:0,ul:0,c:0};baidu.object.extend(n,m);m=n;var p=j.T.Message,q=j.T.User;webim.Contact.getUser(s,function(t){var u="from="+encodeURIComponent(S.getUsername())+"&to="+encodeURIComponent(t.username)+"&friend="+(t.relationship==3?true:false);u+="&body="+encodeURIComponent(i(o,m));if(t.syssession){u+="&sys_session="+t.syssession}if(r){u+="&validate="+encodeURIComponent(r.v_url+","+r.v_period+","+r.v_time+","+r.v_code)}d.post(S.baseUrl+"/message",u,function(v){if(v.result=="ok"){var w=new Date().getTime();var x={mid:h(w),sender:S.getUsername(),receiver:s,content:Q(o,m),isRead:1,time:w};p.save(x);S.call({from:"webim.Message",event:"messageListChange",data:s});l(x)}else{if(v.result=="validate"){r=v.content.validate||r;r.v_src=G(r.v_url);k(s,o,m,l,r,k)}}})})}function B(q,m,k,o,n){C.info("[Message.sendMessage]:\nto:"+q+"\nmessage:"+m+"\ncb:"+typeof (k)+"\nvalidate:"+baidu.json.encode(o)+"\nvalidateCb:"+typeof (n),"api",B);var l=j.T.Message,p=j.T.User;webim.Contact.getUser(m.receiver,function(r){var s="from="+encodeURIComponent(m.sender)+"&to="+encodeURIComponent(r.username)+"&friend="+(r.relationship==3?true:false);s+="&body="+encodeURIComponent(H(m.content));if(r.syssession){s+="&sys_session="+r.syssession}if(o){s+="&validate="+encodeURIComponent(o.v_url+","+o.v_period+","+o.v_time+","+o.v_code)}d.post(S.baseUrl+"/message",s,function(t){if(t.result=="ok"){S.call({from:"webim.Message",event:"messageListChange",data:q})}else{if(t.result=="validate"){o=t.content.validate||o;o.v_src=G(o.v_url);n(q,m,k,o,n)}else{S.call({from:"webim.Message",event:"sendError",data:t.result})}}})});if(!l.get(m.mid)){l.save(m)}k(m)}function G(k){return"http://vcode.im.baidu.com/cgi-bin/genimg?"+k}function h(k,l){k=k||"";if(l){return k+""+(l.replace(",",""))}return D.guid()+""}function g(q,k){var n=j.T.Message,m=j.T.Conversation,l=webim.model.BaseTable,o=j.T.Recent,r=j.T.User,p=j.T.SystemMessage;S.listen({from:"webim.System",event:"getoldmessage"},function(){setTimeout(function(){F()},2*1000)});S.listen({from:"webim.System",type:"pick",command:"message",result:"ok"},function(t){var v=t.field,s=t.field.content,w=t.ack,u=v.time;if(!n.isExists(h(u,w))){webim.Contact.getUser(v.from,function(x){var y={mid:h(u,w),sender:v.from,receiver:S.getUsername(),content:s,time:D.sToMs(u)};n.save(y);if(v.sys_session){if(!x.syssession||x.syssession!=v.sys_session){x.syssession=v.sys_session;r.save(x)}}N({from:"webim.Message",event:"newMessage",data:n.cloneObject(y)});S.call({from:"webim.Message",event:"messageListChange",data:v.from})})}});S.listen({from:"webim.System",type:"pick",command:"systemmessage",result:"ok"},function(t){var u=t.field,s=t.field.content,w=t.ack;var v={mid:h("",t.ack),from:u.from,type:u.type,content:u.content,time:D.sToMs(u.time)};p.save(v);S.call({from:"webim.Message",event:"newSystemMessage",data:p.cloneObject(v)})});S.listen({from:"webim.System",type:"pick",command:"friendaddnotify",result:"ok"},function(t){var u=t.field,s=u.content;webim.Contact.getUser(s.username,function(v){var w={mid:h("",t.ack),type:"friendaddnotify",from:s.username,time:s.time,content:{relationship:v.relationship,detail:s.comment?s.comment:""}};p.save(w);if(s.sys_session){r.save({username:s.username,syssession:s.sys_session})}S.call({from:"webim.Message",event:"newSystemMessage",data:p.cloneObject(w)})})});S.listen({from:"webim.System",type:"pick",command:"addfriendresponse",result:"ok"},function(t){var u=t.field,s=u.content;var v={mid:h("",t.ack),type:"addfriendresponse",from:s.username,time:s.time,content:{detail:s.comment?s.comment:"",agree:s.agree}};p.save(v);webim.Contact.getUser(s.username,function(w){if(s.agree){w.relationship=3}if(s.sys_session){w.syssession=s.sys_session}r.save(w)});S.call({from:"webim.Message",event:"newSystemMessage",data:p.cloneObject(v)})});n.listen({type:l.ACTION_ADD},function(s){N({from:"webim.Message",event:"newMessage",data:n.cloneObject(n.get(s.value)),sync:true})});p.listen({type:l.ACTION_ADD},function(s){S.call({from:"webim.Message",event:"newSystemMessage",data:p.cloneObject(p.get(s.value)),sync:true})});p.listen({type:l.ACTION_UPDATE},function(s){S.call({from:"webim.Message",event:"updateSystemMessage",data:p.cloneObject(p.get(s.value)),sync:true})});m.listen({type:[l.ACTION_ADD,l.ACTION_UPDATE]},function(s){S.call({from:"webim.Message",event:"startConversation",username:s.value,data:m.getMessageList(s.value,n)})});m.listen({type:l.ACTION_REMOVE},function(s){S.call({from:"webim.Message",event:"endConversation",username:s.value,data:s.value})});k(1)}function b(m){var k=j.T.Conversation,l=j.T.Message;k.save({username:m});return k.getMessageList(m,l)}function f(l){var k=j.T.Conversation;k.remove(l)}function U(k){var l=j.T.Conversation;return l.getList(null,null,null,k)}function K(m){var k=j.T.Conversation,l=j.T.Message;return l.cloneObject(k.getMessageList(m,l))}function O(){var k=j.T.SystemMessage;return k.cloneObject(k.getList().reverse())}function W(s){var r=j.T.SystemMessage,o=j.getBaseTable();var q=[];if(baidu.lang.isArray(s)){for(var p=0,n=s.length;p<n;p++){var k=s[p];if(k){k=L(k);q.push(k)}}}else{q.push(L(s))}if(q.length>0){r.save(q)}return 0}function L(o){var n=j.T.SystemMessage,k=j.getBaseTable();if(typeof (o)=="object"){var l=o[n.schema[0]];if(l!==undefined){o=n.get(l);if(o){o.isRead=1;return o}}}else{var m=n.get(o);if(m){m.isRead=1;return m}}return false}function X(o){var n=j.T.SystemMessage,k=j.getBaseTable();if(typeof (o)=="object"){var l=o[n.schema[0]];if(l!==undefined){var o=n.get(l);if(o){o.operationCount++;n.save(o);return 1}return 0}}else{var m=n.get(o);if(m){m.operationCount++;n.save(m);return 1}}return 0}function F(m,l){m=m||0;l=l||0;var k=j.T.Message;d.getByServer(S.getUrl+"/oldmessage?lastMessageId="+m+"&lastMessageTime="+l,function(n){if(n.result=="ok"){var o=[];baidu.each(n.content.fields,function(r){var q=r.time;var p={mid:h(q),sender:r.from,content:r.content,time:D.sToMs(q),isOld:1};o.push(p)});k.save(o);baidu.each(o,function(p){N({from:"webim.Message",event:"newMessage",data:k.cloneObject(p)});S.call({from:"webim.Message",event:"messageListChange",data:p.sender})});if(n.content.lastMessageId&&n.content.lastMessageTime){setTimeout(function(){F(n.content.lastMessageId,n.content.lastMessageTime)},10)}else{M()}}})}function N(n){var k=j.T.Message;if(n){Z.push(n);if(Z.length>1){return 0}}if(Z.length>0){var m=Z[0],o=m.data,l=m.sync;var p=o.sender;if(l){p=o.receiver}webim.Contact.getUser(p,function(q){Z.shift();S.call(m);N()})}}function M(m,l){m=m||0;l=l||0;var k=j.T.SystemMessage;d.getByServer(S.getUrl+"/oldsystem?lastMessageId="+m+"&lastMessageTime="+l,function(n){if(n.result=="ok"){var o=[];baidu.each(n.content.fields,function(q){var p={mid:h(),from:q.from,type:q.type,time:D.sToMs(q.time),content:q.content,isOld:1};o.push(p)});k.save(o);baidu.each(o,function(p){S.call({from:"webim.Message",event:"newSystemMessage",data:p})});if(n.content.lastMessageId&&n.content.lastMessageTime){setTimeout(function(){M(n.content.lastMessageId,n.content.lastMessageTime)},10)}else{e()}}})}function e(m,l){m=m||0;l=l||0;var k=j.T.SystemMessage;d.getByServer(S.getUrl+"/oldnotify?lastMessageId="+m+"&lastMessageTime="+l,function(n){if(n.result=="ok"){var o=[];baidu.each(n.content.fields,function(q){var p=q.content;var r={};if(q.command=="addfriendresponse"){r={mid:h(),type:"addfriendresponse",from:p.username,time:p.time,content:{detail:p.comment?p.comment:"",agree:p.agree},isOld:1}}else{if(q.command=="friendaddnotify"){r={mid:h(),type:"friendaddnotify",from:p.username,time:p.time,content:{detail:p.comment?p.comment:""},isOld:1}}}o.push(r)});k.save(o);baidu.each(o,function(p){S.call({from:"webim.Message",event:"newSystemMessage",data:p})});if(n.content.lastMessageId&&n.content.lastMessageTime){setTimeout(function(){e(n.content.lastMessageId,n.content.lastMessageTime)},10)}else{V()}}})}function V(){d.getByServer(S.getUrl+"/getsystemmessage",function(k){})}var J={configKey:"Message",init:g,buildMessage:c,send:B,startConversation:b,endConversation:f,loadOfflineMessage:F,getConversationList:U,getListByUsername:K,getSystemMessageList:O,readSystemMessage:W,operateSystemMessage:X};baidu.lang.module("webim.Message",J);S.addModule(J)})();(function(){var D=webim.Core;var E=D;var F=D.getDataService(),G=webim.Net;function K(P,M){var L=F.T.Preference,O=F.T.Runtime,N=L.getBaseTable();L.listen({type:[N.ACTION_ADD,N.ACTION_UPDATE]},function(Q){if(Q.value=="status"){D.call({from:"webim.Self",event:"statusChange",data:L.get(Q.value)})}else{D.call({from:"webim.Self",event:"preferenceChange",data:L.get(Q.value)})}});D.listen({from:"webim.System",type:"pick",command:"friendstatus",result:"ok"},function(R){if(R.field.content.username==D.getUsername()){var Q=R.field.content;if(Q.status!==undefined){if(Q.status!=="offline"){var S={key:"status",value:Q.status};L.save(S);D.call({from:"webim.Self",event:"statusChange",data:S})}else{Logger.report({error:1,pickOffline:1})}}if(Q.voice!==undefined){var S={key:"voice",value:Q.voice};L.save(S);D.call({from:"webim.Self",event:"preferenceChange",data:S})}if(Q.tempMessagePolicy!==undefined){var S={key:"tempMessagePolicy",value:Q.tempMessagePolicy};L.save(S);D.call({from:"webim.Self",event:"preferenceChange",data:S})}}});M(1)}function H(){var L=F.T.Preference;return L.STATUS}function B(N,Q,M){var L=F.T.Preference;var O=this;M=M||function(){};if(N=="tempMessagePolicy"){var P="operation="+(Q=="allow"?"unblock":"block");G.post(D.baseUrl+"/blocktempmessage",P,function(R){if(R.result=="ok"){L.save({key:N,value:Q});M(1)}else{M(0)}})}else{var P=N+"="+Q;G.post(D.baseUrl+"/set",P,function(R){if(R.result=="ok"){L.save({key:N,value:Q});M(1)}else{M(0)}})}}function I(M){var L=F.T.Preference;var O=this;var N=L.get(M);return N?N.value:null}function C(N,M){var L=F.T.Preference,O=F.T.Runtime;var P=this;M=M||function(){};L.save({key:"status",value:N},P.DATA_TIMEOUT);D.call({from:"webim.Self",type:"status",data:N});if(N!=L.STATUS.OFFLINE){if(!O.get("session")){D.call({from:"webim.Self",type:"checkMaster"});return 0}var Q="status="+N;G.post(D.baseUrl+"/modifyself",Q,function(R){if(R.result=="ok"){M(1)}else{M(0)}})}else{webim.System.logout();M(1)}}function J(){try{var L=F.T.Preference;var M=L.get("status")||{key:"status",value:"online"};return M.value}catch(N){}return null}var A={configKey:"Self",init:K,getStatusMap:H,DATA_TIMEOUT:1000*60*60*24,setPreference:B,getPreference:I,setStatus:C,getStatus:J};baidu.lang.module("webim.Self",A);D.addModule(A)})();(function(){var T=webim.Core;var G=T.getDataService(),A=webim.Net;var U=webim.Logger;var I,K,R,M,J=[],B=0,Q=1,F=20;function S(Z,V){var Y=G.T.ExtendUser,W=G.getBaseTable(),X=G.T.Runtime;I=Z.refreshInterval||60*1000;K=Z.followUrl||"http://tieba.baidu.com/i/sys/data_get_followed?ie=utf-8&_open_id=im";R=Z.pdcUrl||"http://pdc.baidu.com/imstate/?type=json";F=Z.queryLength||20;X.listen({type:W.ACTION_ADD,value:"isLoadExtendUserList"},function(a){T.call({from:"webim.more.ITieba",event:"extendUserListChange"})});Y.listen({type:W.ACTION_UPDATE},function(a){T.call({from:"webim.more.ITieba",event:"extendUserListChange"})});T.listen({from:"webim.Core",type:"status",data:"offline"},function(){B=0});V(1)}var N=new Date().getTime();function L(Z,Y,X){U.info("[ITieba.getFollowList]:\ncallback:"+typeof (cb),"api",L.caller,null);X=X||null;var W=G.T.ExtendUser,V=G.T.Runtime;if(!Y&&V.get("isLoadExtendUserList")){Z(W.getUserLikeList(null,null,X,W.DEFAULT_USER_COMPARATOR))}else{if(B){return 0}if(M){clearTimeout(M);M=null}H(function(a){Z(a);O()},X)}}function O(){if(webim.Core.getStatus()=="offline"){return 0}var V=G.T.ExtendUser;if(B){return 0}M=setTimeout(function(){H(function(){T.call({from:"webim.more.ITieba",event:"extendUserListChange"});M=setTimeout(function(){O()},I)})},I)}function H(c,Z){B=1;var Y=G.T.Runtime,X=G.T.ExtendUser,b=G.T.User,a=G.T.TeamUser,V=G.T.Team;Y.remove("isLoadExtendUserList");var W={};A.getByServer(K,function(d){baidu.each(d,function(e){W[e.uid]={username:e.un}});C(d,W,function(){var e=baidu.object.values(W);var t=[],x={};for(var q=0,k=e.length;q<k;q++){var j=e[q];var p=b.get(j.username);if(p){j.isBlocked=p.isBlocked;if(p.relationship==3){j.status=p.status}else{if(p.status!=j.status){p.status=j.status;t.push(p)}}}}if(t.length>0){b.save(t);for(var h=0,g=t.length;h<g;h++){var y=t[h];T.call({from:"webim.more.ITieba",event:"userChange",data:y});var r=a.get(y.username);if(r){var f=V.get(r.tid);if(f&&f.isUserInited){x[f.tid]=true}}}}var w=baidu.object.keys(x);if(w.length>0){for(var q=0,k=w.length;q<k;q++){var o=w[q],f=V.get(o);T.call({from:"webim.more.ITieba",event:"teamUserChange",data:f,users:a.getUserListByTeamId(f.tid,null,b)})}}var v=[];for(var q=0,k=e.length;q<k;q++){var p=e[q];if(p.status!="offline"){v.push(p)}}X.clear();X.save(v);Y.save({key:"isLoadExtendUserList",value:1});B=0;var s=X.getUserLikeList(0,0,Z,X.DEFAULT_USER_COMPARATOR);c(s)})},true,true)}function C(V,W,Y){J=V.splice(0,F);var X=[];baidu.each(J,function(Z){X.push(Z.uid)});A.getByServer(R+"&uids="+encodeURIComponent(X.join()),function(b){for(var a in b){var c=b[a];if(W[a]){var Z="offline";if(c.online==1||c.space_online==1){Z="online"}W[a].status=Z}}if(V.length>0){C(V,W,Y)}else{Y()}},true,true)}function P(Y){Y=Y.toLowerCase();var X=G.T.ExtendUser;var W=X.getUserLikeList(0,0,null,X.DEFAULT_USER_COMPARATOR)||[];var V=[];baidu.each(W,function(Z,a){if(Z.username.toLowerCase().indexOf(Y)>-1){V.push(Z)}});return V}function D(V){}var E={init:S,configKey:"itieba",getFollowList:L,searchFollowList:P};baidu.lang.module("webim.more.ITieba",E);T.addModule(E)})();(function(){var D=webim.Core,B=webim.Logger;var F={init:webim.Core.init,start:webim.Core.start,stop:webim.Core.stop,autoStart:webim.Core.autoStart,getUsername:webim.Core.getUsername,getStatus:webim.Core.getStatus,isPassportOnline:webim.System.isPassportOnline,isAvailable:webim.Core.isAvailable};GrandCentral.extend(F);D.listen({from:"webim.Core",type:"status"},function(J){B.info("[(e)System.statusChange]:\ndata:"+baidu.json.encode(J.data)+"\nsource:"+baidu.json.encode(J),"api");B.report({info:"statusChange",value:J.data,content:baidu.json.encode(J),from:"webim.Core"});F.call({e:"statusChange",data:J.data})});D.listen({from:"webim.System",event:"online"},function(J){B.info("[(e)System.statusChange]:\ndata:online\nsource:"+baidu.json.encode(J),"api");F.call({e:"statusChange",data:"online"})});D.listen({from:"webim.System",event:"offline"},function(J){B.info("[(e)System.statusChange]:\ndata:offline\nsource:"+baidu.json.encode(J),"api");B.report({info:"statusChange",value:"offline",content:baidu.json.encode(J),from:"webim.System"});F.call({e:"statusChange",data:"offline"})});var I=webim.Face;var H={send:webim.Message.send,buildMessage:webim.Message.buildMessage,startConversation:webim.Message.start,endConversation:webim.Message.end,getListByUsername:webim.Message.getListByUsername,getConversationList:webim.Message.getConversationList,getSystemMessageList:webim.Message.getSystemMessageList,readSystemMessage:webim.Message.readSystemMessage,operateSystemMessage:webim.Message.operateSystemMessage};GrandCentral.extend(H);D.listen({from:"webim.Message",event:"newMessage"},function(J){H.call({e:"newMessage",message:J.data,master:J.sync?!J.sync:true})});D.listen({from:"webim.Message",event:"newSystemMessage"},function(J){B.info("[(e)Message.newSystemMessage]\nmessage:"+baidu.json.encode(J.data));H.call({e:"newSystemMessage",message:J.data,master:J.sync?!J.sync:true})});D.listen({from:"webim.Message",event:"updateSystemMessage"},function(J){B.info("[(e)Message.newSystemMessage]\nmessage:"+baidu.json.encode(J.data));H.call({e:"newSystemMessage",message:J.data})});D.listen({from:"webim.Message",event:"startConversation"},function(J){H.call({e:"startConversation",username:J.username,messages:J.data})});D.listen({from:"webim.Message",event:"endConversation"},function(J){H.call({e:"endConversation",username:J.username})});D.listen({from:"webim.Core",event:"startChat"},function(J){H.call({e:"startChat",username:J.username})});var C={getUser:webim.Contact.getUser,search:webim.Contact.search,getTeamList:webim.Contact.getTeamList,getUserListByTeamId:function(K,L,J){webim.Contact.getUserListByTeamId(K,L,null,null,J)},getRecentList:webim.Contact.getRecentList,blockUser:webim.Contact.blockUser,addAsContact:webim.Contact.addAsContact,verifyContact:webim.Contact.verifyContact,prepareToAddContact:webim.Contact.prepareToAddContact};GrandCentral.extend(C);D.listen({from:["webim.Contact","webim.more.ITieba"],event:"userChange"},function(J){C.call({e:"userChange",user:J.data,master:J.master})});D.listen({from:"webim.Contact",event:"teamChange"},function(J){C.call({e:"teamChange",team:J.data})});D.listen({from:["webim.Contact","webim.more.ITieba"],event:"teamUserChange"},function(J){C.call({e:"teamUserChange",team:J.data,users:J.users})});D.listen({from:"webim.Contact",event:"teamListChange"},function(J){C.call({e:"teamListChange",teams:J.data})});D.listen({from:"webim.Contact",event:"teamListReload"},function(J){C.call({e:"teamListReload",teams:J.data})});D.listen({from:"webim.Contact",event:"recentChange"},function(J){C.call({e:"recentChange",users:J.data})});var E={getStatusMap:webim.Self.getStatusMap,setPreference:webim.Self.setPreference,getPreference:webim.Self.getPreference,setStatus:webim.Self.setStatus,getStatus:webim.Self.getStatus};GrandCentral.extend(E);D.listen({from:"webim.Self",event:"statusChange"},function(J){E.call({e:"statusChange",status:J.data})});D.listen({from:"webim.Self",event:"preferenceChange"},function(J){E.call({e:"preferenceChange",preference:J.data})});D.listen({from:"webim.System",event:"preferenceChange"},function(J){E.call({e:"preferenceChange",preference:J.data})});var G={ITieba:{getFollowList:webim.more.ITieba.getFollowList,searchFollowList:webim.more.ITieba.searchFollowList}};GrandCentral.extend(G.ITieba);D.listen({from:["webim.more.ITieba","webim.Contact"],event:"extendUserListChange"},function(J){G.ITieba.call({e:"refreshList"})});var A={System:F,Face:I,Message:H,Contact:C,Self:E,more:G};baidu.lang.module("webim.api",A)})();var chinese={sysMsgTitle:"\u7cfb\u7edf\u6d88\u606f",clTitle:"\u597d\u53cb\u5217\u8868",tbname:"\u8d34\u5427",hiname:"\u767e\u5ea6Hi",searchTip:"\u641c\u7d22\u8054\u7cfb\u4eba",createText:"\u521b\u5efa\u65b0\u4f1a\u8bdd",chatText:"\u4e0e\u597d\u53cb\u804a\u5929",createNewText:"\u8bf7\u8f93\u5165\u5bf9\u65b9\u5e10\u53f7",createBtnText:"\u5f00\u59cb\u4f1a\u8bdd",settingFrameTitle:"\u8bbe\u7f6e",soundSetText:"\u6536\u5230\u4fe1\u606f\u64ad\u653e\u63d0\u793a\u97f3",strangerSetText:"\u4e0d\u63a5\u6536\u964c\u751f\u4eba\u6d88\u606f",unloginTip:"\u60a8\u7684\u8d26\u53f7\u672a\u767b\u5f55",loginText:"\u767b\u5f55",loadingText:"\u6b63\u5728\u767b\u5f55...",addContact:"\u52a0\u4e3aHi\u8054\u7cfb\u4eba",sendText:"\u53d1\u9001",imlink:"\u4e0b\u8f7d\u767e\u5ea6Hi",imTipText:"\u804a\u5929\u8f6f\u4ef6\uff0c\u4f53\u9a8c\u66f4\u4e30\u5bcc",defaultTeam:"\u767e\u5ea6\u8054\u7cfb\u4eba",onlineText:"\u5728\u7ebf",busyText:"\u9690\u8eab",offlineText:"\u79bb\u7ebf",minContactListTip:"\u6536\u8d77\u8054\u7cfb\u4eba\u5217\u8868",sysMsgCloseTip:"\u6536\u8d77\u7cfb\u7edf\u6d88\u606f\u5217\u8868",minTip:"\u6700\u5c0f\u5316",closeTip:"\u5173\u95ed"};(function(){var V="mulan_contactList";var O="\u641c\u7d22\u8054\u7cfb\u4eba";var n="hi";var r=[];var D=false;webim.api.Self.listen({e:"statusChange"},function(t){var s=t.status;if(s=="offline"){A();return }});GrandCentral.listen({source:"main",type:"statusChange"},function(t){var s=t.data.status;if(s=="offline"){A()}});webim.api.Contact.listen({e:"recentChange"},function(t){if(n=="new"){var u=t.users;baidu.each(u,function(w,v){if(w.isBlocked==1){if(w.status=="offline"||w.status=="hide"){w.status="blockGray"}else{w.status="block"}}});var s={contactType:"new",list:u};IM.Template.contactList(s,"cl_container")}});webim.api.Contact.listen({e:"teamListChange"},function(s){if(n=="hi"){webim.api.Contact.getTeamList(function(v){var u=baidu.G("cl_search").getElementsByTagName("input")[0].value;if(u==""||u==O){var t={teams:v};IM.Template.teamList(t,"cl_container")}else{}})}});webim.api.Contact.listen({e:"teamListReload"},function(s){r=[];l();if(n=="new"){L()}});GrandCentral.listen({source:"IM.MulanBar",type:"contactListClick"},function(s){if(N()){o();return }if(!N()){j();return }});function p(s){e(s);J();baidu.on("mulan_chatDialog","click",o);IM.Helper.getUIStatus("ui_clShow",function(t){if(t=="1"){d()}});IM.Helper.getUIStatus("ui_clTabType",function(v){if(v==null){var u=document.getElementById("cl_im");var t=document.getElementById("cl_latest");baidu.addClass(u,"cl_tabHover");baidu.removeClass(u,"cl_tabMouseOver");baidu.removeClass(t,"cl_tabHover");document.getElementById("cl_search").style.display="block"}else{Q(v.split("|")[0])}});IM.Helper.getUIStatus("ui_clExpandTeam",function(t){if(t){r=baidu.json.decode(t);baidu.each(r,function(v,u){C(v)})}});IM.Helper.registerSync("ui_clExpandTeam",function(t){if(t){r=baidu.json.decode(t)}});IM.Helper.registerSync("ui_clShow",function(t){if(t=="1"){d();mulan.Core.call({e:"pageMutex",from:"webim"});return }if(t=="0"){i();return }});IM.Helper.registerSync("teamExpandStatus",function(u){var t=u.split("|");if(t[1]=="TeamExpand"){C(u.split("|")[0])}else{q(u.split("|")[0])}});IM.Helper.registerSync("ui_clTabType",function(t){Q(t.split("|")[0])});mulan.Core.listen({e:"active","from$ne":"webim"},function(t){if(N()){o()}});GrandCentral.listen({e:"imWindowOpen"},function(t){var u=t.target;if(u!="clList"&&u!="dialog"){if(N()){o()}}});webim.api.Contact.listen({e:"userChange"},function(t){if(n=="hi"){var u=baidu.G("cl_search").getElementsByTagName("input")[0].value;if(u==""||u==O){if(t.team){var v=t.team.tid;Z(v)}}else{webim.api.Contact.search(u,U)}return }if(n=="new"){webim.api.Contact.getRecentList(function(x){if(x.length>0){baidu.each(x,function(z,y){if(z.isBlocked==1){if(z.status=="offline"||z.status=="hide"){z.status="blockGray"}else{z.status="block"}}});var w={contactType:"new",list:x};IM.Template.contactList(w,"cl_container");return }if(x.length==0){baidu.G("cl_container").innerHTML="<div id='cl_noRecentTip'>\u6ca1\u6709\u6700\u8fd1\u8054\u7cfb\u4eba\u3002</div>"}})}});webim.api.Contact.listen({e:"teamChange"},function(t){if(n=="hi"){var u=baidu.G("cl_search").getElementsByTagName("input")[0].value;if(u==""||u==O){l()}}});webim.api.Contact.listen({e:"teamUserChange"},function(t){if(n=="hi"){var u=baidu.G("cl_search").getElementsByTagName("input")[0].value;if(u==""||u==O){var v=t.team.tid;Z(v)}}})}function e(t){var s={title:"\u597d\u53cb\u5217\u8868",tbname:"\u8d34\u5427",hiname:"\u767e\u5ea6Hi",minTip:"\u6536\u8d77\u8054\u7cfb\u4eba\u5217\u8868",closeTip:"\u5173\u95ed\u8054\u7cfb\u4eba\u5217\u8868"};IM.Template.contactFrame(s,t)}function A(){baidu.G("cl_container").innerHTML="";baidu.G("mulan_contactList").style.display="none";baidu.G("mulan_createConversation").style.display="none";r=[];n="hi";var t=document.getElementById("cl_im");var s=document.getElementById("cl_latest");baidu.addClass(t,"cl_tabHover");baidu.removeClass(t,"cl_tabMouseOver");baidu.removeClass(s,"cl_tabHover");baidu.removeClass(t,"cl_tabHover");document.getElementById("cl_search").style.display="block";var u=baidu.G("cl_search").getElementsByTagName("input")[0];baidu.hide(baidu.G("cl_searchClose"));u.value=O;baidu.addClass(u,"cl_searchTip")}function Z(t,s){webim.api.Contact.getUserListByTeamId(t,function(v){baidu.each(v,function(x,w){if(x.isBlocked==1){if(x.status=="offline"||x.status=="hide"){x.status="blockGray"}else{x.status="block"}}});var u={contactType:"hi",list:v};IM.Template.contactList(u,P(t));if(s){s()}},function(w,v){baidu.each(w,function(y,x){if(y.isBlocked==1){if(y.status=="offline"||y.status=="hide"){y.status="blockGray"}else{y.status="block"}}});if(v==0){var u={contactType:"hi",list:w};IM.Template.contactList(u,P(t))}})}function N(){var s=baidu.dom.getStyle(V,"display");return s=="none"?false:true}function j(){mulan.Core.call({e:"active",from:"webim"});GrandCentral.call({e:"imWindowOpen",target:"clList"});d(function(){IM.Helper.sync("ui_clShow","1")},true)}function d(t,s){IM.ContactPanel.isOpen=true;document.getElementById(V).style.display="block";Q(n,t,s)}function o(){IM.Helper.sync("ui_clShow","0");i()}function i(){IM.ContactPanel.isOpen=false;baidu.hide(V);baidu.removeClass("wi_clBtn","wi_clOn")}function W(s){if(s=="tb"){return }Q(s,function(){IM.Helper.sync("ui_clTabType",s+"|Click")},true);webim.Logger.report({tabclick:s});if(mulan.Core.logData.behaviorTimer){mulan.Core.logData.behaviorData.push(s+"tabclick")}}function Q(w,x,v){var t=document.getElementById("cl_im");var s=document.getElementById("cl_latest");var y=baidu.G("cl_search").getElementsByTagName("input")[0];var u=baidu.string.trim(y.value);if(w=="hi"||w=="new"){n=w}if(w=="hi"){baidu.removeClass(s,"cl_tabHover");baidu.addClass(t,"cl_tabHover");baidu.removeClass(t,"cl_tabMouseOver");document.getElementById("cl_search").style.display="block";if(u!=""&&u!=O){M(w,u)}else{document.getElementById("cl_container").innerHTML="<div id='cl_contactLoading'></div><div id='cl_contactLoadingText'>\u52a0\u8f7d\u4e2d...</div>";E(x)}}if(w=="new"){baidu.removeClass(t,"cl_tabHover");baidu.addClass(s,"cl_tabHover");baidu.removeClass(s,"cl_tabMouseOver");document.getElementById("cl_search").style.display="none";baidu.G("cl_container").innerHTML="<div id='cl_contactLoading'></div><div id='cl_contactLoadingText'>\u52a0\u8f7d\u4e2d...</div>";L(x)}}function F(s){if(s.className.indexOf("cl_tabHover")==-1){baidu.addClass(s,"cl_tabMouseOver")}}function I(s){baidu.removeClass(s,"cl_tabMouseOver")}function E(s){mulan.Core.logData.renderIMListAt=new Date().getTime();baidu.G("cl_search").style.display="block";baidu.G("cl_container").style.height="220px";l(s)}function L(s){baidu.G("cl_search").style.display="none";baidu.G("cl_container").style.height="246px";webim.api.Contact.getRecentList(function(u){baidu.each(u,function(w,v){if(w.isBlocked==1){if(w.status=="offline"||w.status=="hide"){w.status="blockGray"}else{w.status="block"}}});if(u.length>0){var t={contactType:"new",list:u};IM.Template.contactList(t,"cl_container")}if(u.length==0){baidu.G("cl_container").innerHTML="<div id='cl_noRecentTip'>\u6ca1\u6709\u6700\u8fd1\u8054\u7cfb\u4eba\u3002</div>"}if(s){s()}})}function m(){IM.ContactPanel.isOpen=false;var s=document.getElementById("mulan_contactList");s.style.display="none";baidu.removeClass(baidu.G("wi_clBtn"),"wi_clOn");IM.Helper.sync("ui_clShow","0")}function l(s){webim.api.Contact.getTeamList(function(u){if(n=="hi"){if(u.length>0){var t={teams:u};IM.Template.teamList(t,"cl_container");baidu.each(r,function(w,v){C(w)});webim.Logger.report({renderimlist:new Date().getTime()-mulan.Core.logData.renderIMListAt})}else{baidu.G("cl_container").innerHTML="<div id='cl_noRecentTip'>\u60a8\u6ca1\u6709\u767e\u5ea6Hi\u8054\u7cfb\u4eba\u3002</div>"}}if(s){s()}})}function c(u,s,t){}function P(s){return s+"_teamMembers"}function K(s){if(mulan.Core.logData.behaviorTimer){mulan.Core.logData.behaviorData.push("teamclick")}if(k(s)){f(s);return }if(!k(s)){b(s);return }}function k(s){var t=baidu.G(s+"_teamTitle");if(t.className.indexOf("cl_teamExpand")!=-1){return true}else{return false}}function b(s){r.push(s);C(s,true);IM.Helper.sync("ui_clTabType","hi|Click")}function C(u,t){var v=baidu.G(u+"_teamTitle");if(v){var s=baidu.G(P(u));if(t){Z(u,function(){if(baidu.dom.children(s).length!=0){s.style.display="block"}else{s.style.display="none"}IM.Helper.sync("ui_clExpandTeam",baidu.json.stringify(r));IM.Helper.sync("teamExpandStatus",u+"|TeamExpand")})}else{Z(u,function(){if(baidu.dom.children(s).length!=0){s.style.display="block"}else{s.style.display="none"}})}baidu.addClass(v,"cl_teamExpand")}}function f(s){baidu.array.remove(r,s);IM.Helper.sync("ui_clExpandTeam",baidu.json.stringify(r));q(s);IM.Helper.sync("teamExpandStatus",s+"|TeamFold");IM.Helper.sync("ui_clTabType","hi|Click")}function q(t){var u=baidu.G(t+"_teamTitle");if(u){var s=baidu.G(P(t));baidu.removeClass(u,"cl_teamExpand");s.style.display="none"}baidu.array.remove(r,t)}function X(s){baidu.addClass(s,"cl_nodeHover")}function G(s){baidu.removeClass(s,"cl_nodeHover")}function R(u,t){var s=u.id.substring(3);webim.api.Contact.getUser(s,function(v){GrandCentral.call({source:"IM.ContactList",type:"startConversation",data:{uname:u.id.substring(3)}});IM.Helper.sync("contactNodeClick",n+"|"+new Date().getTime());if(n=="hi"||n=="new"){IM.Helper.sync("ui_clTabType",n+"|Click")}baidu.G("wi_chatBtn").style.display="block";if(mulan.Core.logData.behaviorTimer){mulan.Core.logData.behaviorData.push(t+"nodeclick")}})}function H(){GrandCentral.call({source:"IM.ContactPanel",type:"createConversation",data:{}})}function a(s){if(baidu.string.trim(s.value)==O){s.value=""}s.className="cl_searchFocus";if(mulan.Core.logData.behaviorTimer){mulan.Core.logData.behaviorData.push("searchclick")}}function g(s){if(baidu.string.trim(s.value)==O){s.value=""}s.className="cl_searchFocus"}function Y(s){if(s.value==""){s.className="cl_searchTip";s.value=O}else{s.className="cl_searchNormal"}}function S(s){var t=baidu.G("cl_search").getElementsByTagName("input")[0];baidu.hide(s);t.value=O;baidu.addClass(t,"cl_searchTip");W(n)}function J(){var t=baidu.G("cl_search").getElementsByTagName("input")[0];var s=t.value;window.setInterval(function(){var v=baidu.G("cl_search").getElementsByTagName("input")[0];var u=v.value;if(u==""||u==O){baidu.hide(baidu.G("cl_searchClose"));if(u!=s){if(n=="hi"){E()}if(n=="new"){L()}}s=u;return }else{baidu.show(baidu.G("cl_searchClose"));if(u!=s){s=u;M(n,u)}}},500)}function M(t,s){if(s==""||baidu.string.trim(s)==O){return }if(t=="hi"){webim.api.Contact.search(s,U);return }}function U(t){if(t.length==0){baidu.G("cl_container").innerHTML="<div id='cl_noSearchResult'>\u6ca1\u6709\u627e\u5230\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u8054\u7cfb\u4eba\u3002</div>";return }baidu.each(t,function(w,v){if(w.isBlocked==1){if(w.status=="offline"||w.status=="hide"){w.status="blockGray"}else{w.status="block"}}});if(n=="hi"){var s={teams:[{tid:10,name:"\u627e\u5230"}]};IM.Template.teamList(s,"cl_container");baidu.G("10_teamTitle").onclick=null;baidu.G("10_teamTitle").style.textIndent="5px";baidu.G("10_teamTitle").getElementsByTagName("span")[0].style.background="none";var u=baidu.G("10_teamTitle");baidu.addClass(u,"cl_teamExpand");var s={contactType:"hi",list:t};IM.Template.contactList(s,P(10))}}function h(x){x=window.event||x;var v=x.keyCode||x.which||x.charCode;var s=null;var z=baidu.G("cl_search").getElementsByTagName("input")[0];if(z.value==""||baidu.string.trim(z.value)==O||baidu.G("cl_noSearchResult")){return }if(v==13){B();baidu.event.stop(x)}if(v==38){var y=[];if(n=="hi"){divs=baidu.G("10_teamMembers").getElementsByTagName("div");for(var u=0,t=divs.length;u<t;u++){if(divs[u].className.indexOf("cl_contactNode")!=-1){y.push(divs[u])}}}var t=y.length;for(var u=0;u<t;u++){var w=y[u];if(w.className.indexOf("cl_nodeHover")!=-1){s=u;baidu.removeClass(w,"cl_nodeHover");break}}if(s!=null){if(s>0){baidu.addClass(y[s-1],"cl_nodeHover")}else{baidu.addClass(y[y.length-1],"cl_nodeHover")}}else{baidu.addClass(y[y.length-1],"cl_nodeHover")}}if(v==40){var y=[];if(n=="hi"){divs=baidu.G("10_teamMembers").getElementsByTagName("div");for(var u=0,t=divs.length;u<t;u++){if(divs[u].className.indexOf("cl_contactNode")!=-1){y.push(divs[u])}}}var t=y.length;for(var u=0;u<t;u++){var w=y[u];if(w.className.indexOf("cl_nodeHover")!=-1){s=u;baidu.removeClass(w,"cl_nodeHover")}}if(s!=null){if(s<y.length-1){baidu.addClass(y[s+1],"cl_nodeHover")}else{baidu.addClass(y[0],"cl_nodeHover")}}else{baidu.addClass(y[0],"cl_nodeHover")}}}function B(){var w=baidu.G("cl_search").getElementsByTagName("input")[0];var v=[];if(n=="hi"){divs=baidu.G("10_teamMembers").getElementsByTagName("div");for(var t=0,s=divs.length;t<s;t++){if(divs[t].className.indexOf("cl_contactNode")!=-1){v.push(divs[t])}}}var u=-1;for(var t=0,s=v.length;t<s;t++){if(v[t].className.indexOf("cl_nodeHover")!=-1){u=t;break}}if(u!=-1){GrandCentral.call({source:"IM.ContactList",type:"startConversation",data:{uname:v[u].id.substring(3)}});baidu.G("wi_chatBtn").style.display="block"}else{if(v[0]&&v[0].id){GrandCentral.call({source:"IM.ContactList",type:"startConversation",data:{uname:v[0].id.substring(3)}});baidu.G("wi_chatBtn").style.display="block"}}w.value=O;baidu.addClass(w,"cl_searchTip")}var T={init:p,typeTabClickHandler:W,typeTabHover:F,typeTabOut:I,close:m,teamClickHandler:K,nodeOverHandler:X,nodeOutHandler:G,nodeClickHandler:R,render:e,createDialog:H,keyClick:a,keyBlur:Y,keyFocus:g,closeKey:S,searchKeyDown:h,isOpen:D};baidu.lang.module("IM.ContactPanel",T)})();(function(){var A=null;GrandCentral.listen({source:"IM.ContactPanel",type:"createConversation"},function(J){C()});function F(K){var J={title:"\u521b\u5efa\u65b0\u4f1a\u8bdd"};IM.Template.createDialog(J,K);mulan.Core.listen({e:"active","from$ne":"webim"},function(L){G()});baidu.on(document,"click",function(N){N=window.event||N;var M=N.srcElement||N.target;var L=baidu.dom.contains(baidu.G("mulan_createConversation"),M);if(!L&&M!=document.getElementById("cl_createText")){G()}})}function C(){var K=document.getElementById("mulan_createConversation");K.style.display="block";var J=baidu.G("cc_selectBtn").value;A=window.setInterval(function(){var L=baidu.G("cc_selectBtn").value;if(J!=L){baidu.G("cc_errorTip").innerHTML=""}J=L},100);baidu.G("cc_selectBtn").focus()}function G(){var J=document.getElementById("mulan_createConversation");J.style.display="none";window.clearInterval(A);A=null;baidu.G("cc_selectBtn").value="";baidu.G("cc_errorTip").innerHTML=""}function B(){var J=baidu.G("cc_selectBtn").value;if(J==""){baidu.G("cc_errorTip").innerHTML="\u8bf7\u8f93\u5165\u5e10\u53f7\u3002";return }if(J==webim.api.System.getUsername()){baidu.G("cc_errorTip").innerHTML="\u60a8\u4e0d\u80fd\u4e0e\u81ea\u5df1\u804a\u5929\u3002";return }webim.api.Contact.getUser(J,function(K){if(!K){baidu.G("cc_errorTip").innerHTML="\u5e10\u53f7\u4e0d\u5b58\u5728\u3002"}else{GrandCentral.call({source:"IM.ContactList",type:"startConversation",data:{uname:J}});G()}})}function I(K){K=window.event||K;var J=K.keyCode||K.which||K.charCode;if(J==13){B();baidu.event.stop(K)}}function D(J){J.className="cc_btnFocus"}function E(J){J.className="cc_btnNormal"}var H={init:F,start:B,show:C,close:G,wordKeyPress:I,wordFocus:D,wordBlur:E};baidu.lang.module("IM.ContactPanel.CreateConversation",H)})();(function(){var b="cd_tabContainer";var E="cd_msgAndEditor";var K="closed";var H=null;var M=null;var I="";var J=false;var U=null;var d=null;var W=false;function Z(j){i(j);IM.ChatDialog.ChatRecord.init();IM.ChatDialog.Editor.init();IM.ChatDialog.TabControl.init();IM.Helper.getUIStatus("uiTabData",function(l){if(l==null){return }var k=baidu.json.decode(l);H=k.curUname;if(k.tabs.length==1){document.getElementById("cd_msgAndEditor").className="cd_noTab";document.getElementById("cd_tabContainer").style.display="none"}else{document.getElementById("cd_msgAndEditor").className="cd_multiTab";document.getElementById("cd_tabContainer").style.display="block"}if(!H){return }webim.api.Contact.getUser(H,function(m){IM.Helper.getUIStatus("ui_cdShow",function(n){n=n.split("|")[0];if(n=="1"){O()}if(n=="0"){C(true)}if(n=="-1"){B()}if(g()!="closed"){F(k.curUname,true)}})})});webim.api.Self.listen({e:"statusChange"},function(l){var k=l.status;if(k=="offline"){baidu.G("mulan_chatDialog").style.display="none";baidu.G("wi_chatBtn").style.display="none";return }if(k!="offline"){return }});GrandCentral.listen({source:"main",type:"statusChange"},function(l){var k=l.data.status;if(k=="offline"){baidu.G("mulan_chatDialog").style.display="none";baidu.G("wi_chatBtn").style.display="none";return }if(k!="offline"){return }});GrandCentral.listen({source:"IM.ChatDialog.TabControl",type:"onlyOneUser"},function(l){var k=l.data.uname;document.getElementById("cd_tabContainer").style.display="none";document.getElementById("cd_msgAndEditor").className="cd_noTab"});GrandCentral.listen({source:"IM.ChatDialog.TabControl",type:"multiUser"},function(l){var k=l.data.uname;baidu.show("cd_tabContainer");document.getElementById("cd_msgAndEditor").className="cd_multiTab"});IM.Helper.registerSync("ui_cdShow",function(k){H=k.split("|")[1];k=k.split("|")[0];if(k=="1"){O();mulan.Core.call({e:"pageMutex",from:"webim"});return }if(k=="0"){C();return }if(k=="-1"){B();return }});GrandCentral.listen({source:"IM.ContactList",type:"startConversation"},function(k){H=k.data.uname;if(g()!="maximum"){f()}});GrandCentral.listen({source:"IM.ChatDialog.TabControl",type:"currentUserChange"},function(k){H=k.data.uname;F(H);if(g()=="maximum"&&k.master){var l=document.getElementById("cd_editorArea");if(!l.disabled){l.focus()}}});GrandCentral.listen({e:"imWindowOpen"},function(k){var l=k.target;if(l=="mlList"||l=="setDialog"){if(g()=="maximum"){X()}}});mulan.Core.listen({e:"active","from$ne":"webim"},function(k){if(g()=="maximum"){X()}});webim.api.Message.listen({e:"startChat"},function(k){var l=k.username;webim.External.startChat(l)});webim.api.Message.listen({e:"newMessage"},function(m){var k=m.message.sender;var l=m.master;L(k,l)});webim.api.Contact.listen({e:"userChange"},function(l){var k=l.user;if(k.username==H){F(H,true)}})}function L(j,k){if(H==null){H=j}webim.api.Contact.getUser(j,function(m){if(j!=webim.api.System.getUsername()){Y(m)}if(webim.api.Self.getPreference("voice")==1){if(k){IM.Helper.playSound()}}var l=IM.Helper.getSafeHTML(m.showname);var n=l.length>9?l.substring(0,9)+"...":l;if(g()=="closed"){if(k){X()}else{C()}N(n+"\u6765\u6d88\u606f\u5566");baidu.G("wi_chatBtnIcon").className="wi_"+m.status;A();return }if(g()=="minimum"){N(n+"\u6765\u6d88\u606f\u5566");baidu.G("wi_chatBtnIcon").className="wi_"+m.status;A();return }})}function Y(j){if(!J){I=document.title}J=true;U=j.showname;window.clearInterval(d);var k=0,n=500;d=window.setInterval(function(){k++;if(k%2==0){document.title="\u3010\u65b0\u6d88\u606f\u3011"+j.showname+"\u6765\u6d88\u606f\u5566"}else{document.title="\u3000\u3000\u3000\u3000\u3000"+j.showname+"\u6765\u6d88\u606f\u5566"}},n);function m(){l();IM.Helper.sync("clearTitle",new Date().getTime());baidu.un(document,"mouseover",m);baidu.un(document,"click",m)}function l(){window.clearInterval(d);document.title=I;J=false}baidu.un(document,"mouseover",m);baidu.un(document,"click",m);baidu.on(document,"mouseover",m);baidu.on(document,"click",m);IM.Helper.registerSync("clearTitle",function(o){l()})}function g(){var k=null;var l=baidu.G("wi_chatBtn").style.display||"none";var j=baidu.G("mulan_chatDialog").style.display||"none";if(l=="none"&&j=="none"){k="closed"}if(l!="none"&&j=="none"){k="minimum"}if(l!="none"&&j!="none"){k="maximum"}return k}function F(j,k){webim.api.Contact.getUser(j,function(m){var o="";if(m.isBlocked==1){if(m.status=="offline"||m.status=="hide"){o="blockGray"}else{o="block"}}else{o=m.status}R(m.showname);S(o);baidu.G("wi_chatBtnIcon").className="wi_"+o;var l=IM.Helper.getSafeHTML(m.showname);var p=l.length>9?l.substring(0,9)+"...":l;if(g()=="maximum"){N("\u4e0e"+p+"\u804a\u5929\u4e2d")}if(g()!="maximum"){if(k){N("\u4e0e"+p+"\u804a\u5929\u4e2d")}else{N(p+"\u6765\u6d88\u606f\u5566");baidu.G("wi_chatBtnIcon").className="wi_"+m.status}}var n=document.getElementById("cd_tipContent");if(webim.api.Self.getPreference("tempMessagePolicy")=="reject"&&(m.relationship==1||m.relationship==2)){n.innerHTML='<span>\u60a8\u5c4f\u853d\u4e86\u6765\u81ea\u964c\u751f\u4eba\u7684\u6d88\u606f\u3002</span><a href="#" onclick="IM.ChatDialog.ChatRecord.changeTempPolicy();return false;">\u53d6\u6d88\u5c4f\u853d</a>'}else{n.innerHTML='<span id="cd_tipLogo"></span><p id="cd_tipText"><a id="cd_clientLink" onclick="webim.Logger.report({\'downloadclick\' : 1});" href="http://im.baidu.com/html/promo/webim.html" target="_blank">\u4e0b\u8f7d\u767e\u5ea6Hi</a><span>\u804a\u5929\u8f6f\u4ef6\uff0c\u4f53\u9a8c\u66f4\u4e30\u5bcc</span></p>'}})}function i(k){var j={title:"\u804a\u5929\u7a97\u53e3",onlineStatus:"online"};IM.Template.dialog(j,k);D(b);IM.ChatDialog.Editor.render(E)}function D(j){IM.ChatDialog.TabControl.render(j)}function f(){if(g()=="closed"){webim.Logger.report({dialogopen:"1"})}mulan.Core.call({e:"active",from:"webim"});GrandCentral.call({e:"imWindowOpen",target:"dialog"});IM.Helper.sync("ui_cdShow","1|"+H);O();var j=document.getElementById("cd_editorArea");if(!j.disabled){j.focus()}webim.Logger.report({dialog:"max"})}function O(){IM.ChatDialog.Pannel.isOpen=true;var j=document.getElementById("mulan_chatDialog");j.style.display="block";document.getElementById("wi_chatBtn").className="wi_chatBtnMax";P();F(H);GrandCentral.call({e:"dialogShow"})}function P(){baidu.G("wi_chatBtn").style.display="block"}function T(){baidu.G("wi_chatBtn").style.display="none"}function X(){IM.Helper.sync("ui_cdShow","0|"+H);C()}function C(j){IM.ChatDialog.Pannel.isOpen=false;var k=document.getElementById("mulan_chatDialog");document.getElementById("wi_chatBtn").className="wi_chatBtnMin";P();webim.api.Contact.getUser(H,function(m){var l=IM.Helper.getSafeHTML(m.showname);var n=l.length>9?l.substring(0,9)+"...":l;if(g()=="maximum"){N("\u4e0e"+n+"\u804a\u5929\u4e2d")}if(g()!="maximum"){if(j){N("\u4e0e"+n+"\u804a\u5929\u4e2d")}else{N(n+"\u6765\u6d88\u606f\u5566")}}});k.style.display="none";GrandCentral.call({e:"dialogMin"})}function V(){IM.Helper.sync("ui_cdShow","-1|"+H);B(true)}function B(j){IM.ChatDialog.Pannel.isOpen=false;var k=document.getElementById("mulan_chatDialog");document.getElementById("cd_tabContainer").style.display="none";document.getElementById("cd_msgAndEditor").className="cd_noTab";baidu.G("cd_clientTip").style.display="block";k.style.display="none";T();GrandCentral.call({e:"clickFaceBtn",type:"hide"});GrandCentral.call({source:"IM.ChatDialog.Pannel",type:"closeDialog",master:j,data:{}});H=null}function A(){var j=0;M=window.setInterval(function(){j++;if(j>6){window.clearInterval(M);M=null;return }var k=document.getElementById("wi_chatBtn");if(j%2==0){baidu.addClass(k,"wi_chatBtnBlink")}else{baidu.removeClass(k,"wi_chatBtnBlink")}},500)}function S(j){baidu.G("cd_statusIcon").className="cd_"+j+"Icon"}function R(j){baidu.G("cd_title").innerHTML="\u4e0e"+IM.Helper.getSafeHTML(j)+"\u804a\u5929\u4e2d"}function N(j){baidu.G("wi_chatBtnText").innerHTML=j;baidu.removeClass(baidu.G("wi_chatBtn"),"wi_chatBtnBlink")}function e(){window.clearInterval(M);M=null;baidu.removeClass(baidu.G("wi_chatBtn"),"wi_chatBtnBlink");if(g()=="minimum"){baidu.removeClass(baidu.G("wi_chatBtn"),"wi_chatBtnBlink");webim.api.Contact.getUser(H,function(k){var j=IM.Helper.getSafeHTML(k.showname);var l=j.length>9?j.substring(0,9)+"...":j;N("\u4e0e"+l+"\u804a\u5929\u4e2d");baidu.G("wi_chatBtnIcon").className="wi_"+k.status});f();webim.Logger.report({chatbtnclick:"1"});return }if(g()=="maximum"){X();webim.Logger.report({chatbtnclick:"0"});return }}function G(j){baidu.addClass(j,"wi_chatBtnHover");document.getElementById("wi_chatBtnClose").style.display="block"}function c(j){baidu.removeClass(j,"wi_chatBtnHover");document.getElementById("wi_chatBtnClose").style.display="none"}function a(){V();webim.Logger.report({chatbtnclose:"1"})}var Q={init:Z,close:V,min:X,show:f,chatBtnClick:e,chatBtnHover:G,chatBtnOut:c,chatBtnClose:a,isOpen:W};baidu.lang.module("IM.ChatDialog.Pannel",Q)})();(function(){var K="cd_chatRecord";var A=[];var J=null;function L(){IM.Helper.getUIStatus("uiTabData",function(O){if(O){var P=baidu.json.decode(O);J=P.curUname;B(J);window.setTimeout(N,100)}});GrandCentral.listen({source:"IM.ChatDialog.sendProcess",type:"sendOk"},function(O){var P=O.receiver;if(P==J){B(J)}});GrandCentral.listen({source:"IM.ChatDialog.TabControl",type:"currentUserChange"},function(O){J=O.data.uname;B(J)});webim.api.Message.listen({e:"newMessage"},function(Q){var R=Q.message;var P=R.sender;var S=R.receiver;var O=webim.api.System.getUsername();if(!J){J=P;B(J);return }if(P==O){B(S);return }if(P==J){B(J);return }});GrandCentral.listen({e:"dialogShow"},function(O){N()});GrandCentral.listen({source:"IM.ChatDialog.Pannel",type:"closeDialog"},function(O){J=null})}function I(O){baidu.each(O,function(T,R){var Q=T.sender;var P=webim.api.System.getUsername();if(Q!=P){webim.api.Contact.getUser(Q,function(U){T.showname=U.showname})}else{webim.api.Contact.getUser(P,function(U){T.showname=U.showname})}if(T.isOld==1){var S="yyyy-MM-dd HH:mm:ss"}if(T.isOld==0){var S="HH:mm:ss"}T.time=baidu.date.format(new Date(T.time),S);baidu.each(T.content,function(V,U){if(V.type=="face"){V.url=webim.api.Face.getByName(V.n).url}if(V.type=="text"){V.c=IM.Helper.getSafeHTML(V.c);V.c=V.c.replace(/\r\n|\n|\r/gi,"<br/>")}})})}function B(O){var P=webim.api.Message.getListByUsername(O);I(P);var Q={chatRecord:P,uname:O};IM.Template.chatRecord(Q,K);N()}function C(O){if(baidu.ie<8){if(O.readyState=="complete"||O.readyState=="loaded"){N();O.onreadystatechange=null;O.onload=null}}else{N()}}function N(){var O=baidu.G("cd_recordContainer");if(O.scrollTop!=O.scrollHeight){O.scrollTop=O.scrollHeight}}function G(){baidu.hide("cd_clientTip")}function D(){baidu.show("cd_clientTip")}function F(){baidu.addClass("cd_clientTip","cd_clientTipHover")}function E(){baidu.removeClass("cd_clientTip","cd_clientTipHover")}function H(){G();webim.api.Self.setPreference("tempMessagePolicy","allow",function(){GrandCentral.call({e:"tempPolicyChange",policy:"allow"})})}var M={init:L,closeTip:G,showClientTip:D,showTipClsBtn:F,closeTipClsBtn:E,changeTempPolicy:H,imgLoaded:C};baidu.lang.module("IM.ChatDialog.ChatRecord",M)})();(function(){var D=null;var I=null;var F=1000;function W(){IM.ChatDialog.FaceFrame.init();baidu.on(document,"click",function(f){var c=baidu.G("mulan_fixedPopLayer");f=window.event||f;var d=f.srcElement||f.target;var b=baidu.dom.contains(c,d);if(!b&&d!=c&&d!=baidu.G("cd_shortSend")){R()}});webim.api.Message.listen({e:"newMessage"},function(c){var d=c.message;var b=d.sender;var e=d.receiver;if(!D){D=b}});webim.api.Contact.listen({e:"userChange"},function(c){var b=c.user;if(b.username!=D){return }E(b.isBlocked);if(b.relationship==1||b.relationship==2){baidu.G("cd_addNewBtn").style.display="block"}else{baidu.G("cd_addNewBtn").style.display="none"}if(!b.isBlocked){if(webim.api.Self.getPreference("tempMessagePolicy")=="reject"&&(b.relationship==1||b.relationship==2)){N(1)}else{N(0)}}});GrandCentral.listen({e:"imWindowOpen",target:"dialog"},function(b){I=window.setInterval(function(){var d=baidu.G("cd_editorArea");var c=d.value.length;if(c==0){}else{}if(c>F){d.value=d.value.substring(0,F);d.scrollTop=d.scrollHeight}},200)});GrandCentral.listen({source:"IM.ChatDialog.Pannel",type:"closeDialog"},function(b){window.clearInterval(I);I=null;D=null;R()});GrandCentral.listen({e:"dialogMin"},function(b){window.clearInterval(I);I=null;R()});GrandCentral.listen({source:"IM.ChatDialog.sendProcess",type:"sendOk"},function(b){var c=baidu.G("cd_editorArea");c.value="";if(!c.disabled){c.focus()}});GrandCentral.listen({source:"IM.ChatDialog.TabControl",type:"currentUserChange"},function(b){var c=baidu.G("cd_editorArea");D=b.data.uname;c.value="";webim.api.Contact.getUser(D,function(d){var e=baidu.G("cd_addNewBtn");E(d.isBlocked);if(d.relationship==1||d.relationship==2){baidu.show(e);var f=webim.api.Self.getPreference("tempMessagePolicy");if(f=="reject"&&(d.relationship==1||d.relationship==2)){N(1)}}if(d.relationship==3){baidu.hide(e)}})});GrandCentral.listen({e:"faceItemClick"},function(b){var d=b.data;var c=baidu.G("cd_editorArea");IM.Helper.setCursorPos("cd_editorArea",IM.ChatDialog.Editor.cursorPosition);IM.Helper.insertAtCursor(c,"["+d+"]");baidu.removeClass("cd_faceBtn","cd_faceBtnOn");if(!c.disabled){c.focus();Z()}});GrandCentral.listen({e:"faceFrameHide"},function(b){baidu.removeClass("cd_faceBtn","cd_faceBtnOn")});GrandCentral.listen({e:"tempPolicyChange"},function(b){if(!D){return }webim.api.Contact.getUser(D,function(c){if(c.relationship==1||c.relationship==2){if(b.policy=="reject"){N(1)}if(b.policy=="allow"){if(document.getElementById("cd_setBtn").className.indexOf("cd_banBtnOn")==-1){N(0)}}}})});IM.Helper.getUIStatus("uiTabData",function(c){if(c==null){return }var b=baidu.json.decode(c);D=b.curUname;if(!D){return }webim.api.Contact.getUser(D,function(d){E(d.isBlocked);if(d.relationship==1||d.relationship==2){baidu.G("cd_addNewBtn").style.display="block";if(webim.api.Self.getPreference("tempMessagePolicy")=="reject"){N(1)}else{N(0)}}else{baidu.G("cd_addNewBtn").style.display="none"}})});baidu.on(baidu.G("cd_editorArea"),"focus",function(b){b=window.event||b;baidu.event.stop(b)})}function a(c){var b={};IM.Template.editor(b,c)}function G(){var b=baidu.G("cd_editorArea");if(b.value.length>0){GrandCentral.call({source:"IM.ChatDialog.Editor",type:"sendMessage",data:{uname:D,content:b.value}})}else{if(!b.disabled){b.focus()}}}function E(d){var b=document.getElementById("cd_setBtn");var c=document.getElementById("cd_editorArea");if(d==1){baidu.addClass(b,"cd_banBtnOn");b.title="\u89e3\u9664\u963b\u6b62";c.disabled=true;baidu.addClass("cd_editor","cd_editorDisable");baidu.addClass("cd_faceBtn","cd_faceBtnGray")}if(d==0){baidu.removeClass(b,"cd_banBtnOn");b.title="\u963b\u6b62\u8be5\u8054\u7cfb\u4eba";c.disabled=false;baidu.removeClass("cd_editor","cd_editorDisable");baidu.removeClass("cd_faceBtn","cd_faceBtnGray")}}function N(b){if(b==1){baidu.G("cd_editorArea").disabled=true;baidu.addClass("cd_editor","cd_editorDisable");baidu.addClass("cd_faceBtn","cd_faceBtnGray")}if(b==0){baidu.G("cd_editorArea").disabled=false;baidu.removeClass("cd_editor","cd_editorDisable");baidu.removeClass("cd_faceBtn","cd_faceBtnGray")}}function K(){R()}function Q(b){Z()}function T(d){d=window.event||arguments[0];var c=d.which||d.keyCode||d.charCode;var b=baidu.cookie.get("imSK");if(b=="1"){if((d.ctrlKey||d.metaKey)&&(c==13)){G();baidu.event.stop(d)}return false}if(b=="0"||!b){if(c==13&&!(d.ctrlKey||d.metaKey)){G();baidu.event.stop(d)}return false}}function H(){if(baidu.G("cd_msgAndEditor").className.indexOf("cd_noTab")!=-1){document.getElementById("mulan_fixedPopLayer").style.right="117px"}else{document.getElementById("mulan_fixedPopLayer").style.right="202px"}baidu.G("mulan_fixedPopLayer").style.display="block"}function R(){baidu.hide("mulan_fixedPopLayer")}function B(){var b=baidu.cookie.get("imSK");if(b=="1"){baidu.removeClass(baidu.G("enterItem"),"cd_keyOn");baidu.removeClass(baidu.G("ctrlAndEnterItem"),"cd_keyOn");baidu.addClass(baidu.G("ctrlAndEnterItem"),"cd_keyOn")}if(b=="0"||!b){baidu.removeClass(baidu.G("enterItem"),"cd_keyOn");baidu.removeClass(baidu.G("ctrlAndEnterItem"),"cd_keyOn");baidu.addClass(baidu.G("enterItem"),"cd_keyOn")}H()}function A(c){if(c=="enter"){baidu.cookie.set("imSK","0")}if(c=="CtrlAndEnter"){baidu.cookie.set("imSK","1")}R();var b=document.getElementById("cd_editorArea");if(!b.disabled){b.focus()}}function Y(b){if(b.className.indexOf("cd_faceBtnGray")!=-1){return }webim.Logger.report({facebtnclick:"1"});if(b.className.indexOf("cd_faceBtnOn")!=-1){GrandCentral.call({e:"clickFaceBtn",type:"hide"});baidu.removeClass(b,"cd_faceBtnOn")}else{GrandCentral.call({e:"clickFaceBtn",type:"show"});baidu.addClass(b,"cd_faceBtnOn")}}function C(c){var b=null;if(c.className.indexOf("cd_banBtnOn")!=-1){webim.api.Contact.getUser(D,function(d){if(d.relationship==1||d.relationship==2){if(webim.api.Self.getPreference("tempMessagePolicy")=="reject"){N(1)}else{N(0)}baidu.removeClass(baidu.G("cd_setBtn"),"cd_banBtnOn")}else{b=false;E(0)}});webim.Logger.report({unblockclick:"1"})}else{baidu.addClass(c,"cd_banBtnOn");b=true;E(1);webim.Logger.report({blockclick:"1"})}webim.api.Contact.blockUser(D,b,function(){})}function M(c){var b="http://msg.im.baidu.com/?username_peer="+encodeURIComponent(D);window.open(b,"_blank","");webim.Logger.report({recordclick:"1",to:D})}function U(b){GrandCentral.call({source:"IM.ChatDialog.Editor",type:"addContact",data:{uname:D}});webim.Logger.report({addcontactclick:"1"})}function J(b){baidu.addClass(b,"cd_sendHover")}function P(b){baidu.removeClass(b,"cd_sendHover")}function X(b){baidu.addClass(b,"cd_shortcutHover")}function O(b){baidu.removeClass(b,"cd_shortcutHover")}function S(){baidu.addClass("cd_editor","cd_editorFocus")}function V(){baidu.removeClass("cd_editor","cd_editorFocus")}function Z(){if(baidu.ie){IM.ChatDialog.Editor.cursorPosition=IM.Helper.getCursorPos("cd_editorArea")}}var L={cursorPosition:0,init:W,render:a,send:G,faceClick:Y,setClick:C,addNewClick:U,showShortSelect:B,selectShortcut:A,keySend:T,clickHandler:K,sendBtnHover:J,sendBtnOut:P,shortcutHover:X,shortcutOut:O,focus:S,saveCursorPos:Z,keyUp:Q,blur:V,recordClick:M};baidu.lang.module("IM.ChatDialog.Editor",L)})();(function(){var M="cd_faceFrame";var I="cd_faceContainer";var C="cd_faceHover";var K="cd_faceOut";var G=[];function N(){B();baidu.on(document,"click",function(S){var Q=baidu.G("cd_faceFrame");S=window.event||S;var R=S.srcElement||S.target;var P=baidu.dom.contains(Q,R);if(!P&&R!=baidu.G("cd_faceBtn")){F()}});GrandCentral.listen({e:"clickFaceBtn"},function(P){var Q=P.type;if(Q=="show"){L();return }if(Q=="hide"){F();return }})}function B(){G=[{faceType:"default",title:webim.api.Face.getListByType("default").title,faceUrl:"http://st1.im.baidu.com/m/iknow/mulan/images/faces.gif",items:webim.api.Face.getListByType("default").items},{faceType:"bear",title:webim.api.Face.getListByType("bear").title,faceUrl:"http://st1.im.baidu.com/m/iknow/mulan/images/faces_bear.gif",items:webim.api.Face.getListByType("bear").items}];var P={facesArray:G};IM.Template.faceFrame(P,M);var Q=G[0];Q.faceType="default";H(Q)}function H(P){IM.Template.faceList(P,I)}function L(){var P=baidu.G("cd_faceFrame");P.style.display="block"}function F(){var P=baidu.G("cd_faceFrame");baidu.hide(P);GrandCentral.call({e:"faceFrameHide"})}function A(R){var Q=baidu.G("cd_faceHeader").getElementsByTagName("div");if(R=="default"){baidu.removeClass(Q[1],"cd_faceTypeOn");baidu.removeClass(Q[0],"cd_faceTypeHover");baidu.addClass(Q[0],"cd_faceTypeOn");var P=G[0];H(P);return }if(R=="bear"){baidu.removeClass(Q[0],"cd_faceTypeOn");baidu.removeClass(Q[1],"cd_faceTypeHover");baidu.addClass(Q[1],"cd_faceTypeOn");var P=G[1];H(P);return }}function J(P){if(P.className.indexOf("cd_faceTypeOn")==-1){baidu.addClass(P,"cd_faceTypeHover")}}function E(P){baidu.removeClass(P,"cd_faceTypeHover")}function D(Q){var P=new Image();P.src=webim.api.Face.getByShortcut(Q).url;F();GrandCentral.call({e:"faceItemClick",data:Q})}var O={init:N,faceItemClick:D,switchFace:A,typeHover:J,typeOut:E};baidu.lang.module("IM.ChatDialog.FaceFrame",O)})();(function(){var M=null;var I=null;var E=null;var C=null;var J=null;var N=0;var Q=0;webim.api.Self.listen({e:"statusChange"},function(U){var T=U.status;if(T=="offline"){R()}});GrandCentral.listen({source:"main",type:"statusChange"},function(U){var T=U.data.status;if(T=="offline"){R()}});function R(){B()}GrandCentral.listen({source:"IM.ChatDialog.Editor",type:"sendMessage"},function(T){E=T.data.uname;M=T.data.content;I=webim.api.Message.buildMessage(E,M,{});F(E,M)});GrandCentral.listen({source:"IM.ChatDialog.Pannel",type:"closeDialog"},function(T){E=null});function F(T,U){if(!U||U.length==0){return }Q=N;webim.api.Message.send(T,I,P,C,O)}function P(T){C=null;if(T){GrandCentral.call({source:"IM.ChatDialog.sendProcess",type:"sendOk",receiver:E});K()}}function A(){baidu.G("sendAgainBtn").disabled=true;J=window.setInterval(function(){if(baidu.G("pop_sendVcode").value!=""){baidu.G("sendAgainBtn").disabled=false;baidu.G("sendVcodeError").style.display="none"}else{baidu.G("sendAgainBtn").disabled=true}},100);baidu.G("sendVcodeError").style.display="none";baidu.G("pop_sendVcode").focus()}function O(a,X,T,Z,Y){C=Z;var U={v_src:Z.v_src};var W=IM.Template.validateFrame(U);var V={title:"\u53d1\u9001\u6d88\u606f\u9a8c\u8bc1",onShow:A,onClose:B,onDestroy:B};IM.Helper.Popup.initPopup(W,V);IM.Helper.Popup.show();N=N+1;if(N>Q+1){baidu.G("sendVcodeError").style.display="block";baidu.G("sendVcodeError").innerHTML="\u9a8c\u8bc1\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002"}}function G(){C.v_code=baidu.G("pop_sendVcode").value;webim.api.Message.send(E,I,P,C,O)}function L(U){U=window.event||U;var T=U.keyCode||U.which||U.charCode;if(T==13){G()}}function S(){var T=baidu.G("pop_sendVcodeImg").src;baidu.G("pop_sendVcodeImg").src=T+"&"+(new Date()).getTime()}function B(){window.clearInterval(J);J=null}function K(){IM.Helper.Popup.close()}function D(){B();GrandCentral.call({source:"IM.ChatDialog.Editor",type:"addContact",data:{uname:E}})}var H={refreshVcode:S,sendAgain:G,closeFrame:B,startAddProcess:D,keyPress:L};baidu.lang.module("IM.ChatDialog.sendProcess",H)})();(function(){var I=null;var C=null;var L=null;webim.api.Self.listen({e:"statusChange"},function(U){var T=U.status;if(T=="offline"){R()}});GrandCentral.listen({source:"main",type:"statusChange"},function(U){var T=U.data.status;if(T=="offline"){R()}});function R(){K()}GrandCentral.listen({source:"IM.ChatDialog.Editor",type:"addContact"},function(U){var T=U.data.uname;Q(T)});function K(){window.clearInterval(I);I=null}function A(){baidu.G("pop_addBtn").disabled=true;I=window.setInterval(function(){if(baidu.G("pop_validateCode")&&baidu.G("pop_validateCode").value!=""){baidu.G("pop_addBtn").disabled=false;baidu.G("sendVcodeError").style.display="none"}else{baidu.G("pop_addBtn").disabled=true}},100)}function Q(T){webim.api.Contact.getTeamList(function(U){L=U;webim.api.Contact.prepareToAddContact(T,function(Y){C=Y;var V={uname:T,comment:"",teams:L,tid:0,v_url:Y.v_src};var X=IM.Template.addContact(V);var W={title:"\u6dfb\u52a0\u767e\u5ea6Hi\u8054\u7cfb\u4eba",onShow:A,onClose:K,onDestroy:K};IM.Helper.Popup.initPopup(X,W);IM.Helper.Popup.show()})})}function B(){var T=baidu.G("pop_username").innerHTML;var U=0;if(baidu.G("pop_teamSelect").options.length>0){U=baidu.G("pop_teamSelect").options[baidu.G("pop_teamSelect").selectedIndex].getAttribute("id").substring(4)}var V=baidu.G("pop_comment").value;C.v_code=baidu.G("pop_validateCode").value;webim.api.Contact.addAsContact(T,U,J,V,G,C)}function J(U,T){if(U){if(!T){O("\u60a8\u5df2\u6210\u529f\u52a0\u5bf9\u65b9\u4e3a\u8054\u7cfb\u4eba\u3002");baidu.G("cd_addNewBtn").style.display="none";return }if(T=="wait_agree"){O("\u53d1\u9001\u6210\u529f\uff0c\u7b49\u5f85\u5bf9\u65b9\u9a8c\u8bc1\u3002");baidu.G("cd_addNewBtn").style.display="none";return }}if(!U){switch(T){case"im_unopen":O("\u53d1\u9001\u6210\u529f\uff0c\u7b49\u5f85\u5bf9\u65b9\u9a8c\u8bc1\u3002");break;case"too_many":O("\u60a8\u7684\u597d\u53cb\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\u3002");break;case"user_not_found":O("\u7528\u6237\u4e0d\u5b58\u5728\u3002");break;case"already_be_my_friend":O("\u5bf9\u65b9\u5df2\u662f\u60a8\u7684\u597d\u53cb\uff0c\u4e0d\u80fd\u91cd\u590d\u6dfb\u52a0\u3002");break;default:break}}}function G(W,V,b,Y,U,a){var T={uname:W,comment:Y,teams:L,tid:V,v_url:a.v_src};var Z=IM.Template.addContact(T);var X={title:"\u6dfb\u52a0\u767e\u5ea6Hi\u8054\u7cfb\u4eba",onShow:A,onClose:K,onDestroy:K};IM.Helper.Popup.initPopup(Z,X);IM.Helper.Popup.show();baidu.G("sendVcodeError").style.display="block";baidu.G("sendVcodeError").innerHTML="\u9a8c\u8bc1\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002"}function O(W){var T={tipText:W};var V=IM.Template.addOk(T);var U={title:"\u6dfb\u52a0\u767e\u5ea6Hi\u8054\u7cfb\u4eba"};IM.Helper.Popup.initPopup(V,U);IM.Helper.Popup.show()}function S(){var T=baidu.G("pop_vcodeImg").src;baidu.G("pop_vcodeImg").src=T+"&"+(new Date()).getTime()}function P(T){var U=true;var W="";var V=function(){};webim.api.Contact.verifyContact(T,U,W,V);Q(T);webim.Logger.report({passandaddcontact:"1"})}function E(T){var U=true;var W="";var V=function(){};webim.api.Contact.verifyContact(T,U,W,V);webim.Logger.report({passcontact:"1"})}function M(T){var U=false;var W="";var V=function(){};webim.api.Contact.verifyContact(T,U,W,V);webim.Logger.report({rejectcontact:"1"})}function F(T){var U=false;var X="";var W=function(){};webim.api.Contact.verifyContact(T,U,X,W);var V=true;webim.api.Contact.blockUser(T,V,function(Y){if(Y){}});webim.Logger.report({rejectandblockcontact:"1"})}function N(U){U=window.event||U;var T=U.keyCode||U.which||U.charCode;if(T==13){if(baidu.G("pop_addBtn").disabled==false){B()}}}function D(U){U=window.event||U;var T=U.keyCode||U.which||U.charCode;if(T==13){IM.Helper.Popup.close()}}var H={close:K,addContact:B,refreshVcode:S,passAndAdd:P,passContact:E,rejectContact:M,rejectAndBlock:F,keyPress:N,addOkKeyPress:D};baidu.lang.module("IM.ChatDialog.AddContact",H)})();(function(){var b="cd_tabsWrap";var E=9;var k=23;var f=207;var R=0;var N=[];var g="";var K={tabs:N,curUname:g,top:0};var A={};var a=[];var I=false;function q(){IM.Helper.getUIStatus("uiTabData",function(v){if(v==null){return }K=baidu.json.decode(v);N=K.tabs;g=K.curUname;var u={tabs:N};IM.Template.contactTab(u,b);var w=document.getElementById("cd_tabsWrap");R=parseInt(w.offsetHeight);i();w.style.top=parseInt(K.top)+"px";if(N.length>9){S()}});IM.Helper.registerSync("tabChange",function(w){var v=w.split("|")[0];var u=w.split("|")[1];if(v==1){n(u)}if(v==0){G(u)}});IM.Helper.registerSync("selectTab",function(u){F(u)});IM.Helper.registerSync("tabPostionChange",function(u){if(u!=null){baidu.G("cd_tabsWrap").style.top=u+"px";S()}});GrandCentral.listen({source:"IM.ContactList",type:"startConversation"},function(v){var u=v.data.uname;o(u)});webim.api.Message.listen({e:"newMessage"},function(u){a.push(u);if(!I){p()}});GrandCentral.listen({source:"IM.ChatDialog.sendProcess",type:"sendOk"},function(u){A[u.receiver]=null});GrandCentral.listen({source:"IM.ChatDialog.Pannel",type:"closeDialog"},function(u){webim.Logger.report({tabtotal:N.length});J(u.master)});webim.api.Self.listen({e:"statusChange"},function(u){if(u.status=="offline"){J()}});GrandCentral.listen({source:"main",type:"statusChange"},function(u){if(u.data.status=="offline"){J()}});webim.api.Contact.listen({e:"userChange"},function(v){var u=v.user;baidu.each(N,function(x,w){if(x.uname==u.username){N[w].showname=u.showname;if(v.master){j()}baidu.G("cd_"+x.uname+"_tab").getElementsByTagName("span")[0].innerHTML=IM.Helper.getSafeHTML(u.showname)}})})}function X(z){I=true;var y=z.message;var w=y.sender;var AA=y.receiver;var v=webim.api.System.getUsername();if(w==v){p();return }else{if(g==null){g=w;if(z.master){j()}}}if(l(w)&&d(w)==0&&H(w)){p();return }if(l(w)&&d(w)==0&&!H(w)){var x=baidu.G("cd_"+w+"_tab");M(x,"cd_tabBlink",500);p();return }if(l(w)&&d(w)==-1&&!H(w)){var u=baidu.G("cd_tabUp");M(u,"cd_tabUpBlink",500);var x=baidu.G("cd_"+w+"_tab");M(x,"cd_tabBlink",500);p();return }if(l(w)&&d(w)==1&&!H(w)){var u=baidu.G("cd_tabDown");M(u,"cd_tabDownBlink",500);var x=baidu.G("cd_"+w+"_tab");M(x,"cd_tabBlink",500);p();return }if(!l(w)){L(w,function(){if(N.length==1){if(z.master){Q(w)}}else{var AB=baidu.G("cd_"+w+"_tab");M(AB,"cd_tabBlink",500);if(d(w)==1){if(z.master){T(-1);h}}}p()},z.master)}}function p(){if(a.length>0){var u=a.shift();X(u)}else{I=false}}function J(u){N=[];g=null;K={tabs:N,curUname:g,top:0};Z("cd_tabContainer");if(u){j()}}function o(u){n(u,true);IM.Helper.sync("tabChange","1|"+u)}function n(u,v){if(!l(u)){L(u,function(){},v);if(d(u)==1){t(-1)}F(u,v)}if(l(u)&&d(u)==0){F(u,v)}if(l(u)&&d(u)==-1){F(u,v);V(u)}if(l(u)&&d(u)==1){F(u,v);V(u)}var w=baidu.array.find(N,function(y,x){return y.uname==u});if(N.length==1){GrandCentral.call({source:"IM.ChatDialog.TabControl",type:"onlyOneUser",data:{uname:u,currentUname:g}})}else{GrandCentral.call({source:"IM.ChatDialog.TabControl",type:"multiUser",data:{uname:u}})}if(v){j()}}function j(){K={tabs:N,curUname:g,top:parseInt(baidu.getStyle("cd_tabsWrap","top"))};IM.Helper.sync("uiTabData",baidu.json.stringify(K))}function Z(w){var v=null;if(baidu.G("cd_tabsWrap")){v=baidu.getStyle("cd_tabsWrap","top");if(!v||v=="auto"){v=0}}b=w;var u={tabs:N};IM.Template.contactTab(u,w);if(v!=null){if(document.getElementById("cd_tabsWrap")){document.getElementById("cd_tabsWrap").style.top=parseInt(v)+"px"}}s();S()}function s(){var u=baidu.G("cd_tabsWrap");R=parseInt(u.offsetHeight)}function i(){if(N.length==1){GrandCentral.call({source:"IM.ChatDialog.TabControl",type:"onlyOneUser",data:{uname:g}})}else{GrandCentral.call({source:"IM.ChatDialog.TabControl",type:"multiUser",data:{uname:g}})}}function T(u){t(u);IM.Helper.sync("tabPostionChange",top+distance)}function t(u){var w=baidu.G("cd_tabsWrap");var x=u*k;var v=window.parseInt(baidu.getStyle(w,"top"));w.style.top=v+x+"px";S()}function S(){if(N.length<10){return }var u=document.getElementById("cd_tabUp");var v=document.getElementById("cd_tabDown");if(N.length>9&&d(N[N.length-1].uname)==0){baidu.addClass(v,"cd_tabDownGray");baidu.removeClass(u,"cd_tabUpGray");return }if(N.length>9&&d(N[0].uname)==0){baidu.addClass(u,"cd_tabUpGray");baidu.removeClass(v,"cd_tabDownGray");return }baidu.removeClass(u,"cd_tabUpGray");baidu.removeClass(v,"cd_tabDownGray")}function W(u){var x=baidu.G("cd_tabsWrap");var w=parseInt(baidu.getStyle(x,"top"));var y=baidu.G("cd_"+u+"_tab");if(d(u)==-1){var v=w-y.offsetTop+Math.abs(w);IM.Helper.sync("tabPostionChange",v)}if(d(u)==1){var v=w-(y.offsetTop-Math.abs(w)-f)-23;IM.Helper.sync("tabPostionChange",v)}}function V(u){var x=baidu.G("cd_tabsWrap");var w=parseInt(baidu.getStyle(x,"top"));var y=baidu.G("cd_"+u+"_tab");if(d(u)==-1){var v=w-y.offsetTop+Math.abs(w);x.style.top=v+"px"}if(d(u)==1){var v=w-(y.offsetTop-Math.abs(w)-f)-23;x.style.top=v+"px"}S()}function l(v){var u=baidu.array.find(N,function(x,w){return x.uname==v});return u&&true||false}function d(w){var z=baidu.G("cd_tabsWrap");var AA=baidu.G("cd_"+w+"_tab");var y=parseInt(baidu.getStyle(z,"top"));if(!AA){return 0}var x=0;var v=baidu.array.indexOf(N,function(AC,AB){return(AC.uname==w)});x=v*k;var u=0;if(x-Math.abs(y)<0){u=-1}if(x>=Math.abs(y)+f){u=1}return u}function H(u){var v=baidu.G("cd_"+u+"_tab");return v&&v.className.indexOf("cd_tabOn")!=-1}function M(v,w,u){var x=0;var y=window.setInterval(function(){x++;if(x>6){window.clearInterval(y);y=null;return }if(x%2==0){baidu.addClass(v,w)}else{baidu.removeClass(v,w)}},u)}function Q(u){F(u,true);IM.Helper.sync("selectTab",u)}function F(v,w){var AA=baidu.G("cd_editorArea").value;if(AA.length&&AA.length>0){A[g]=AA}else{A[g]=null}g=v;var z=document.getElementById("cd_tabsWrap");var AB=document.getElementById("cd_"+v+"_tab");if(AB){var y=z.getElementsByTagName("div");for(var x=0,u=y.length;x<u;x++){baidu.removeClass(y[x],"cd_tabOn")}baidu.removeClass(AB,"cd_tabHover");baidu.removeClass(AB,"cd_tabBlink");baidu.addClass(AB,"cd_tabOn")}baidu.array.each(N,function(AD,AC){AD.isActived=AD.uname==v?true:false});GrandCentral.call({source:"IM.ChatDialog.TabControl",type:"currentUserChange",master:w,data:{uname:v}});if(w){j()}}function L(u,w,v){webim.api.Contact.getUser(u,function(x){var z={uname:x.username,showname:x.showname,isActived:false,isBlink:false};var y=baidu.array.indexOf(N,function(AB,AA){return AB.isActived});N.splice(y+1,0,z);i();Z(b);if(v){j()}if(w&&typeof w=="function"){w()}})}function r(){var v=window.event||arguments[0];var w=v.target||v.srcElement;var u=w.id.substring(3);IM.Helper.sync("tabChange","0|"+u);G(u,true);baidu.event.stop(v)}function G(u,v){var w=-1;var x=-1;baidu.array.remove(N,function(z,y){if(z.uname==u){x=y;A[u]=null;if(baidu.dom.getAncestorByTag(baidu.G("cd_"+u),"div").className.indexOf("cd_tabOn")!=-1){if(y==N.length-1){w=y-1}else{w=y}}return true}});if(N.length==1){GrandCentral.call({source:"IM.ChatDialog.TabControl",type:"onlyOneUser",data:{uname:N[0].uname}})}Z("cd_tabContainer");if(w!=-1){F(N[w].uname)}else{F(g)}if(x>0){if(d(N[0].uname)==-1){t(1)}if(v){j()}return }if(x==0){if(d(N[N.length-1].uname)==1){t(-1)}if(v){j()}return }if(v){j()}}function P(u){if(u.className.indexOf("cd_tabOn")==-1||u.className.indexOf("cd_tabBlink")==-1){baidu.addClass(u,"cd_tabHover")}}function c(u){baidu.removeClass(u,"cd_tabHover")}function e(v){var u=v.getElementsByTagName("a")[0].id.substring(3);Q(u);if(A[u]){baidu.G("cd_editorArea").value=A[u]}}function m(x){var w=baidu.G("cd_tabsWrap");var v=baidu.G("cd_tabDown");baidu.removeClass(x,"cd_tabUpBlink");var u=baidu.getStyle(w,"top");if(parseInt(u)<0){w.style.top=(parseInt(u)+k)+"px";baidu.removeClass(v,"cd_tabDownGray");if(parseInt(baidu.getStyle(w,"top"))>=0){baidu.addClass(x,"cd_tabUpGray")}IM.Helper.sync("tabPostionChange",parseInt(u)+k)}}function Y(y){var x=baidu.G("cd_tabsWrap");var u=baidu.G("cd_tabUp");var w=baidu.G("cd_tabDown");baidu.removeClass(w,"cd_tabDownBlink");var v=baidu.getStyle(x,"top");var x=document.getElementById("cd_tabsWrap");R=parseInt(x.offsetHeight);if(parseInt(v)>(f-R)){x.style.top=(parseInt(v)-k)+"px";baidu.removeClass(u,"cd_tabUpGray");if(parseInt(baidu.getStyle(x,"top"))<=(f-R)){baidu.addClass(w,"cd_tabDownGray")}IM.Helper.sync("tabPostionChange",parseInt(v)-k)}}function C(u){if(u.className.indexOf("cd_tabUpBlink")!=-1){return }if(u.className.indexOf("cd_tabUpGray")!=-1){return }baidu.addClass(u,"cd_tabUpHover")}function B(u){baidu.removeClass(u,"cd_tabUpHover")}function D(u){if(u.className.indexOf("cd_tabDownBlink")!=-1){return }if(u.className.indexOf("cd_tabDownGray")!=-1){return }baidu.addClass(u,"cd_tabDownHover")}function U(u){baidu.removeClass(u,"cd_tabDownHover")}var O={init:q,render:Z,tabUp:m,tabDown:Y,itemOver:P,itemOut:c,itemClick:e,tabUpOver:C,tabUpOut:B,tabDownOver:D,tabDownOut:U,closeTab:r};baidu.lang.module("IM.ChatDialog.TabControl",O)})();(function(){var K="mulan_messageList";var C="ml_container";function M(V){U(V);IM.Helper.getUIStatus("ui_mlShow",function(W){if(W=="1"){D()}});mulan.Core.listen({e:"active","from$ne":"webim"},function(W){if(T()){I()}});GrandCentral.listen({e:"imWindowOpen","target$ne":"mlList"},function(W){if(T()){I()}});webim.api.Self.listen({e:"statusChange"},function(X){var W=X.status;if(W=="offline"){baidu.G("mulan_messageList").style.display="none";baidu.G("ml_popMsgNum").style.display="none";return }if(W=="online"){IMOld&&IMOld(0)}});GrandCentral.listen({source:"main",type:"statusChange"},function(X){var W=X.data.status;if(W=="offline"){baidu.G("mulan_messageList").style.display="none";baidu.G("ml_popMsgNum").style.display="none";return }if(W=="online"){IMOld&&IMOld(0)}});webim.api.Message.listen({e:"newSystemMessage"},function(Z){if(webim.api.Self.getPreference("voice")==1){if(Z.master){IM.Helper.playSound()}}var W=webim.api.Message.getSystemMessageList();var X={list:W};F(X,C);if(!E()){var Y=0;baidu.each(W,function(b,a){if(b.isRead==0){Y++}});N(Y);return }if(E()){return }});webim.api.Message.listen({e:"updateSystemMessage"},function(Y){var W=webim.api.Message.getSystemMessageList();var X={list:W};F(X,C)});GrandCentral.listen({source:"IM.MulanBar",type:"messageListClick"},function(W){if(T()){I();return }if(!T()){R();return }});GrandCentral.listen({source:"IM.MulanBar",type:"messageListen"},function(W){if(T()){return }if(!T()){B();return }});IM.Helper.registerSync("ui_mlShow",function(W){if(W=="1"){D();mulan.Core.call({e:"pageMutex",from:"webim"});return }if(W=="0"){Q();return }})}function U(Y){var W={title:"\u7cfb\u7edf\u6d88\u606f"};IM.Template.messageFrame(W,Y);var V=webim.api.Message.getSystemMessageList();var W={list:V};A(V);F(W,C);if(!E()){var X=0;baidu.each(V,function(a,Z){if(a.isRead==0){X++}});N(X)}}function A(V){var W=document.getElementById("mulan_messageList");if(V.length==0){W.className="ml_noMsg"}else{W.className=""}}function F(V,W){A(V.list);IM.Template.messageList(V,W);if(baidu.ie){baidu.G("ml_container").style.overflow="hidden";baidu.G("ml_container").style.overflow="auto"}}function E(){return baidu.G("mulan_messageList").style.display=="block"?true:false}function T(){var V=baidu.dom.getStyle(K,"display");return V=="none"?false:true}function R(){mulan.Core.call({e:"active",from:"webim"});GrandCentral.call({e:"imWindowOpen",target:"mlList"});var V=webim.api.Message.getSystemMessageList();D();webim.api.Message.readSystemMessage(V);IM.Helper.sync("ui_mlShow","1")}function D(){var V=document.getElementById("mulan_messageList");V.style.display="block";baidu.G("mulan-root").style.zoom=1;baidu.G("ml_popMsgNum").style.display="none";var W=webim.api.Message.getSystemMessageList();var X={list:W};F(X,C)}function B(){mulan.Core.call({e:"active",from:"webim"});GrandCentral.call({e:"imWindowOpen",target:"mlList"});var V=webim.api.Message.getSystemMessageList();D();webim.api.Message.readSystemMessage(V)}function I(){var V=webim.api.Message.getSystemMessageList();Q();webim.api.Message.readSystemMessage(V);IM.Helper.sync("ui_mlShow","0")}function Q(){var V=document.getElementById("mulan_messageList");baidu.removeClass(baidu.G("wi_mlBtn"),"wi_mlOn");baidu.hide(V)}function N(V){if(parseInt(V)>0){baidu.G("ml_popMsgNum").innerHTML=V;baidu.G("ml_popMsgNum").style.display="block"}}function L(){baidu.G("ml_popMsgNum").style.display="none"}function O(V){if(V.className.indexOf("ml_itemHighlight")==-1){baidu.addClass(V,"ml_itemHover")}}function P(V){if(V.className.indexOf("ml_itemHighlight")==-1){baidu.removeClass(V,"ml_itemHover")}}function G(Z,V){webim.api.Message.readSystemMessage(Z);if(V=="friendaddnotify"){var Y=webim.api.Message.operateSystemMessage(Z)}var W=webim.api.Message.getSystemMessageList();var X={list:W};F(X,C)}function S(){webim.Logger.report({msgpopclick:"1"});R()}function J(V){GrandCentral.call({source:"IM.ContactList",type:"startConversation",data:{uname:V}})}var H={init:M,render:U,close:I,nodeOverHandler:O,nodeOutHandler:P,imMsgClick:G,popClick:S,startConversation:J,isShow:T};baidu.lang.module("IM.MessageList",H)})();(function(){var G="mulan_settingDialog";var J="sd_status";var A=false;var R=false;var I=false;var L={title:"\u8bbe\u7f6e",closeTip:"\u6536\u8d77\u8bbe\u7f6e\u7a97\u53e3",sound:null,stranger:null};var N={status:null,statusText:"\u66f4\u6539\u5728\u7ebf\u72b6\u6001:"};function K(T){S();IM.Helper.getUIStatus("ui_sdShow",function(U){if(U=="1"){C()}});mulan.Core.listen({e:"rootClose"},function(){E()});mulan.Core.listen({e:"active","from$ne":"webim"},function(U){if(Q()){E()}});GrandCentral.listen({e:"imWindowOpen","target$ne":"setDialog"},function(U){if(Q()){E()}});IM.Helper.registerSync("ui_sdShow",function(U){if(U=="1"){C();mulan.Core.call({e:"pageMutex",from:"webim"});return }if(U=="0"){O();return }});GrandCentral.listen({source:"IM.MulanBar",type:"setDialogClick"},function(U){if(Q()){E();return }if(!Q()){P();return }});webim.api.Self.listen({e:"statusChange"},function(U){S()});GrandCentral.listen({source:"main",type:"statusChange"},function(U){if(U.data.status=="offline"){L.sound=L.sound==null?1:L.sound;L.stranger=L.stranger||"reject";IM.Template.settingFrame(L,G);N.status="offline";IM.Template.setStatus(N,J);baidu.G("sd_sound").disabled=true;baidu.G("sd_stranger").disabled=true}else{S()}});webim.api.Self.listen({e:"preferenceChange"},function(U){S();if(U.preference.key=="tempMessagePolicy"){GrandCentral.call({e:"tempPolicyChange",policy:U.preference.value})}});GrandCentral.listen({e:"tempPolicyChange"},function(U){S()})}function S(){var U=webim.api.Self.getPreference("voice");if(U!=null){L.sound=U}else{L.sound=1}var T=webim.api.Self.getPreference("tempMessagePolicy");if(T!=null){L.stranger=T}else{L.stranger="reject"}IM.Template.settingFrame(L,G);N.status=webim.api.Self.getStatus();IM.Template.setStatus(N,J);if(N.status=="offline"){baidu.G("sd_sound").disabled=true;baidu.G("sd_stranger").disabled=true}if(N.status!="offline"){baidu.G("sd_sound").disabled=false;baidu.G("sd_stranger").disabled=false}}function Q(){var T=baidu.getStyle(G,"display");return T=="none"?false:true}function P(){IM.Helper.sync("ui_sdShow","1");mulan.Core.call({e:"active",from:"webim"});GrandCentral.call({e:"imWindowOpen",target:"setDialog"});C()}function C(){IM.SettingDialog.isOpen=true;baidu.setStyle(G,"display","block")}function E(){IM.Helper.sync("ui_sdShow","0");O()}function O(){IM.SettingDialog.isOpen=false;baidu.hide(G);baidu.removeClass(baidu.G("wi_sdBtn"),"wi_sdOn")}function H(U){if(U=="online"&&A){return }else{A=true;window.setTimeout(function(){A=false},1000)}if(U=="hide"&&R){return }else{R=true;window.setTimeout(function(){R=false},1000)}var T=null;if(webim.api.System.getStatus()=="offline"){T="offline"}else{T=webim.api.Self.getStatus()}if(T==U){return }if(T=="offline"&&U!="offline"){baidu.G("sd_statusSelect").innerHTML="<div id='sd_statusLoading'>\u6b63\u5728\u8fde\u63a5</div>"}webim.api.Self.setStatus(U,function(V){if(V){GrandCentral.call({source:"main",type:"statusChange",data:{status:U}});webim.Logger.report({statusswitch:U})}})}function F(V,T){var U=V;var W=null;if(U=="voice"){W=T.checked?1:0;L.sound=W;webim.Logger.report({voiceset:W})}if(U=="tempMessagePolicy"){W=T.checked?"reject":"allow";L.stranger=W;webim.Logger.report({tempMessagePolicyset:W})}webim.api.Self.setPreference(U,W,function(X){if(X&&U=="tempMessagePolicy"){GrandCentral.call({e:"tempPolicyChange",policy:W})}})}function B(T){if(T.className.indexOf("sd_statusOn")==-1){baidu.addClass(T,"sd_statusHover")}}function M(T){baidu.removeClass(T,"sd_statusHover")}var D={init:K,render:S,close:E,switchStatus:H,setPreference:F,statusItemHover:B,statusItemOut:M,isOpen:I};baidu.lang.module("IM.SettingDialog",D)})();(function(){var F="wi_clBtn";var I="wi_mlBtn";var H="wi_sdBtn";webim.api.Self.listen({e:"statusChange"},function(S){var R=S.status.value;N(R)});webim.api.Message.listen({e:"newSystemMessage"},function(S){var R=S.message;if(!IM.ContactPanel.isOpen&&!IM.ChatDialog.Pannel.isOpen&&!IM.SettingDialog.isOpen&&!mulan.app.myBaidu.isOpen&&!IM.MessageList.isShow()){if(R.type&&R.type=="sysmsg"&&R.content.pid&&R.content.pid==1){M(baidu.G("wi_mlBtn"))}}});GrandCentral.listen({source:"main",type:"statusChange"},function(S){var R=S.data.status;N(R)});GrandCentral.listen({e:"imWindowOpen","target$ne":"mlList"},function(R){baidu.removeClass(I,"wi_mlOn")});GrandCentral.listen({e:"imWindowOpen"},function(R){if(R.target!="clList"&&R.target!="dialog"){baidu.removeClass(F,"wi_clOn")}});GrandCentral.listen({e:"imWindowOpen","target$ne":"setDialog"},function(R){baidu.removeClass(H,"wi_sdOn")});function P(R){B(R);IM.Helper.init();IM.ContactPanel.init("mulan_contactList");IM.ContactPanel.CreateConversation.init("mulan_createConversation");IM.MessageList.init("mulan_messageList");IM.SettingDialog.init("mulan_settingDialog");IM.ChatDialog.Pannel.init("mulan_chatDialog");IM.Helper.Popup.init();IM.Helper.getUIStatus("ui_clShow",function(S){if(S=="1"){baidu.addClass(F,"wi_clOn")}});IM.Helper.getUIStatus("ui_mlShow",function(S){if(S=="1"){baidu.addClass(I,"wi_mlOn")}});IM.Helper.getUIStatus("ui_sdShow",function(S){if(S=="1"){baidu.addClass(H,"wi_sdOn")}});IM.Helper.registerSync("ui_clShow",function(S){if(S=="1"){baidu.removeClass(I,"wi_mlOn");baidu.addClass(F,"wi_clOn");baidu.removeClass(H,"wi_sdOn");return }if(S=="0"){baidu.removeClass(F,"wi_clOn");return }});IM.Helper.registerSync("ui_mlShow",function(S){if(S=="1"){baidu.addClass(I,"wi_mlOn");baidu.removeClass(F,"wi_clOn");baidu.removeClass(H,"wi_sdOn");return }if(S=="0"){baidu.removeClass(I,"wi_mlOn");return }});IM.Helper.registerSync("ui_sdShow",function(S){if(S=="1"){baidu.removeClass(I,"wi_mlOn");baidu.removeClass(F,"wi_clOn");baidu.addClass(H,"wi_sdOn");return }if(S=="0"){baidu.removeClass(H,"wi_sdOn");return }})}function B(T){var S={chatText:"\u4e0e\u597d\u53cb\u804a\u5929"};IM.Template.mulanBar(S,T);var R=webim.api.Self.getStatus();N(R)}function N(S){if(S=="offline"){var U=baidu.G("wi_clBtn");var R=baidu.G("wi_mlBtn");var T=baidu.G("wi_sdIcon");U.style.display="none";R.style.display="none";T.className="wi_offline";baidu.removeClass(U,"wi_clHover");baidu.removeClass(U,"wi_clOn");baidu.removeClass(R,"wi_mlHover");baidu.removeClass(R,"wi_mlOn");baidu.removeClass(T,"wi_sdHover");baidu.removeClass(T,"wi_sdOn");return }if(S!="offline"){baidu.G("wi_mlBtn").style.display="block";baidu.G("wi_clBtn").style.display="block";if(S=="hide"){document.getElementById("wi_sdIcon").className="wi_hide"}else{document.getElementById("wi_sdIcon").className="wi_online"}return }}function G(S){if(baidu.G(F).className.indexOf("wi_clOn")!=-1){webim.Logger.report({clbtnclick:"0"});baidu.removeClass(F,"wi_clOn")}else{webim.Logger.report({clbtnclick:"1"});baidu.removeClass(S,"wi_clHover");baidu.addClass(F,"wi_clOn");baidu.removeClass(I,"wi_mlOn");baidu.removeClass(H,"wi_sdOn");mulan.Core.logData.behaviorData=[];mulan.Core.logData.behaviorTimer=window.setTimeout(function(){webim.Logger.report({clickbehavior:baidu.json.stringify(mulan.Core.logData.behaviorData)})},5000)}GrandCentral.call({source:"IM.MulanBar",type:"contactListClick"});var R=baidu.G("mulan_tipWrap");R.style.display="none"}function C(R){if(R.className.indexOf("wi_clOn")==-1){baidu.addClass(R,"wi_clHover");var S=baidu.G("mulan_tipWrap");S.style.display="block";S.style.right="90px";S.getElementsByTagName("td")[0].innerHTML="\u597d\u53cb\u5217\u8868"}}function L(R){var S=baidu.G("mulan_tipWrap");S.style.display="none";baidu.removeClass(R,"wi_clHover")}function D(S){if(baidu.G(I).className.indexOf("wi_mlOn")!=-1){webim.Logger.report({mlbtnclick:"0"});baidu.removeClass(I,"wi_mlOn")}else{webim.Logger.report({mlbtnclick:"1"});baidu.removeClass(S,"wi_mlHover");baidu.addClass(I,"wi_mlOn");baidu.removeClass(F,"wi_clOn");baidu.removeClass(H,"wi_sdOn")}GrandCentral.call({source:"IM.MulanBar",type:"messageListClick"});var R=baidu.G("mulan_tipWrap");R.style.display="none"}function M(S){if(baidu.G(I).className.indexOf("wi_mlOn")!=-1){baidu.removeClass(I,"wi_mlOn")}else{baidu.removeClass(S,"wi_mlHover");baidu.addClass(I,"wi_mlOn");baidu.removeClass(F,"wi_clOn");baidu.removeClass(H,"wi_sdOn")}GrandCentral.call({source:"IM.MulanBar",type:"messageListen"});var R=baidu.G("mulan_tipWrap");R.style.display="none"}function J(R){if(R.className.indexOf("wi_mlOn")==-1){baidu.addClass(R,"wi_mlHover");var S=baidu.G("mulan_tipWrap");S.style.display="block";S.style.right="5px";S.getElementsByTagName("td")[0].innerHTML="\u7cfb\u7edf\u6d88\u606f"}}function O(R){var S=baidu.G("mulan_tipWrap");S.style.display="none";baidu.removeClass(R,"wi_mlHover")}function E(S){if(baidu.G(H).className.indexOf("wi_sdOn")!=-1){webim.Logger.report({setbtnclick:"0"});baidu.removeClass(H,"wi_sdOn")}else{webim.Logger.report({setbtnclick:"1"});baidu.removeClass(S,"wi_sdHover");baidu.addClass(H,"wi_sdOn");baidu.removeClass(F,"wi_clOn");baidu.removeClass(I,"wi_mlOn")}GrandCentral.call({source:"IM.MulanBar",type:"setDialogClick"});var R=baidu.G("mulan_tipWrap");R.style.display="none"}function A(R){if(R.className.indexOf("wi_sdOn")==-1){baidu.addClass(R,"wi_sdHover");var S=baidu.G("mulan_tipWrap");S.style.display="block";S.style.right="-5px";S.getElementsByTagName("td")[0].innerHTML="\u8bbe\u7f6e"}}function K(R){var S=baidu.G("mulan_tipWrap");S.style.display="none";baidu.removeClass(R,"wi_sdHover")}var Q={init:P,contactListClick:G,clHover:C,clOut:L,messageListClick:D,mlHover:J,mlOut:O,setClick:E,setHover:A,setOut:K};baidu.lang.module("IM.MulanBar",Q)})();(function(){function B(F,E){if(webim.api.System.getStatus()=="offline"){var D="webim\u5df2\u79bb\u7ebf";var C=0;if(E){E(false,C,D)}return }if(F==null||F==undefined||F==""){var D="\u8bf7\u8f93\u5165\u5e10\u53f7";var C=1;if(E){E(false,C,D)}return }if(F==webim.api.System.getUsername()){var D="\u4e0d\u80fd\u4e0e\u81ea\u5df1\u4f1a\u8bdd";var C=2;if(E){E(false,C,D)}return }webim.api.Contact.getUser(F,function(I){if(I==0){var H="\u5e10\u53f7\u4e0d\u5b58\u5728";var G=3;if(E){E(false,G,H)}}else{if(I==-1){var H="webim\u5df2\u79bb\u7ebf";var G=0;if(E){E(false,G,H)}return }else{GrandCentral.call({source:"IM.ContactList",type:"startConversation",data:{uname:F}});if(E){E(true)}}}})}var A={startChat:B};baidu.lang.module("webim.External",A)})();(function(){function D(){function Z(c){return c in Y?Y[c]:this[c]}var Y=arguments[0];var a=[];var X=Z("IM");function b(d){var c=[];c.push("\n");c.push(W(X.Helper.tr(d)));c.push("\n");return c.join("")}if("tr" in Y){b=Y.tr}Z=function(d){return"&#"+d.charCodeAt()+";"};function W(c){return String(c).replace(/[<>&"]/g,Z)}a.push("\n");a.push('\n<div id="mulan_webimWrapper">\n<div id="mulan_webim">\n<div class="wi_sdNormal" id="wi_sdBtn" onclick="IM.MulanBar.setClick(this);" onmouseout="IM.MulanBar.setOut(this);" onmouseover="IM.MulanBar.setHover(this);">\n<div id="wi_sdWrap"><div class="wi_online" id="wi_sdIcon"></div></div>\n</div>\n<div class="wi_mlNormal" id="wi_mlBtn" onclick="IM.MulanBar.messageListClick(this);" onmouseout="IM.MulanBar.mlOut(this);" onmouseover="IM.MulanBar.mlHover(this);">\n<div id="wi_mlWrap"><div id="wi_mlIcon"></div></div>\n</div>\n<div class="wi_clNormal" id="wi_clBtn" onclick="IM.MulanBar.contactListClick(this);" onmouseout="IM.MulanBar.clOut(this);" onmouseover="IM.MulanBar.clHover(this);">\n<div id="wi_clWrap"><div id="wi_clIcon"></div>');a.push(W(b("chatText")));a.push('</div>\n</div>\n<div id="wi_chatBtn" onclick="IM.ChatDialog.Pannel.chatBtnClick();" onmouseout="IM.ChatDialog.Pannel.chatBtnOut(this);" onmouseover="IM.ChatDialog.Pannel.chatBtnHover(this);">\n<div class="wi_offline" id="wi_chatBtnIcon"></div>\n<div id="wi_chatBtnText"></div>\n<a hidefocus="true" href="#" id="wi_chatBtnClose" onclick="IM.ChatDialog.Pannel.chatBtnClose();" title="\u5173\u95ed"></a>\n</div>\n</div>\n<div id="mulan_contactList"></div>\n<div id="mulan_messageList"></div>\n<div id="mulan_settingDialog"></div>\n<div id="mulan_chatDialog"></div>\n<div id="mulan_createConversation"></div>\n<div id="ml_popMsgNum" onclick="IM.MessageList.popClick();"></div>\n<div id="mulan_flashContainer"></div>\n<div id="mulan_fixedPopLayer">\n<div id="cd_shortSelect">\n<div id="enterItem" onclick="IM.ChatDialog.Editor.selectShortcut(\'enter\');" onmouseout="IM.ChatDialog.Editor.shortcutOut(this);" onmouseover="IM.ChatDialog.Editor.shortcutHover(this);"><span></span>\u6309Enter\u53d1\u9001</div>\n<div id="ctrlAndEnterItem" onclick="IM.ChatDialog.Editor.selectShortcut(\'CtrlAndEnter\');" onmouseout="IM.ChatDialog.Editor.shortcutOut(this);" onmouseover="IM.ChatDialog.Editor.shortcutHover(this);"><span></span>\u6309Ctrl+Enter\u53d1\u9001</div>\n</div>\n</div>\n<div class="tips-holder" id="mulan_tipWrap">\n<table cellpadding="0" cellspacing="0">\n<tbody>\n<tr>\n<td class="mulan_tips">\n<nobr></nobr>\n</td>\n</tr>\n<tr>\n<td class="mulan_arrow"></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function M(){function Z(c){return c in Y?Y[c]:this[c]}var Y=arguments[0];var a=[];var X=Z("IM");function b(d){var c=[];c.push("\n");c.push(W(X.Helper.tr(d)));c.push("\n");return c.join("")}if("tr" in Y){b=Y.tr}Z=function(d){return"&#"+d.charCodeAt()+";"};function W(c){return String(c).replace(/[<>&"]/g,Z)}a.push("\n");a.push('\n<h2 id="cl_header">\n<span>');a.push(W(b("clTitle")));a.push('</span>\n<a hidefocus="true" href="#" id="cl_clsBtn" onclick="IM.ContactPanel.close();return false;" title="\u6536\u8d77\u597d\u53cb\u5217\u8868"></a>\n</h2>\n<div id="cl_tabContainer">\n<span id="cl_im" onclick="IM.ContactPanel.typeTabClickHandler(\'hi\');" onmouseout="IM.ContactPanel.typeTabOut(this);" onmouseover="IM.ContactPanel.typeTabHover(this);" title="\u767e\u5ea6Hi\u8054\u7cfb\u4eba">Hi\u8054\u7cfb\u4eba</span>\n<span id="cl_latest" onclick="IM.ContactPanel.typeTabClickHandler(\'new\');return false;" onmouseout="IM.ContactPanel.typeTabOut(this);" onmouseover="IM.ContactPanel.typeTabHover(this);" title="\u6700\u8fd1\u8054\u7cfb\u4eba"><div></div></span>\n</div>\n<div id="cl_search">\n<input class="cl_searchTip" onblur="IM.ContactPanel.keyBlur(this);" onclick="IM.ContactPanel.keyClick(this);" onfocus="IM.ContactPanel.keyFocus(this);" onkeydown="IM.ContactPanel.searchKeyDown(event);" type="text" value="\u641c\u7d22\u8054\u7cfb\u4eba"/>\n<a hidefocus="true" href="#" id="cl_searchClose" onclick="IM.ContactPanel.closeKey(this);return false;" title="\u70b9\u51fb\u6b64\u5904\u6e05\u9664\u6587\u672c"></a>\n</div>\n<div id="cl_container"></div>\n<div id="cl_bottom">\n<span id="cl_createIcon"></span>\n<span id="cl_createText" onclick="IM.ContactPanel.createDialog();">');a.push(W(b("createText")));a.push("</span>\n</div>\n");a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function B(){function i(l){return l in b?b[l]:this[l]}var b=arguments[0];var f=[];var d=i("teamName");var e=i("teams");var h=i("item");var Z=i("IM");function a(l){var k=[];k.push("\n");k.push(c(Z.Helper.tr(l)));k.push("\n");return k.join("")}if("tr" in b){a=b.tr}function Y(m,l){if(l){var k=[];for(l in m){k.push(l)}return k}l=typeof m;return l=="number"?new Array(m):l=="string"?m.split(""):m instanceof Array?m:Y(m,1)}i=function(k){return"&#"+k.charCodeAt()+";"};function c(k){return String(k).replace(/[<>&"]/g,i)}f.push("\n");f.push("\n");var j=e;var W=0;j=Y(j);for(;W<j.length;W++){var h=j[W];f.push('\n<div class="cl_teamContainer">\n');if(!h.name){f.push("\n");var d="\u6211\u7684\u8054\u7cfb\u4eba";f.push("\n")}else{f.push("\n");var d=h.name;f.push("\n")}f.push("\n");if(h.tid!=10){f.push("\n");var g=f;f=[];f.push("(");f.push(h.onlineCount);f.push("/");f.push(h.userCount);f.push(")");var X=f.join("");f=g;f.push("\n")}else{f.push("\n");var g=f;f=[];var X=f.join("");f=g;f.push("\n")}f.push('\n<h3 id="');f.push(c(h.tid));f.push('_teamTitle" onclick="IM.ContactPanel.teamClickHandler(\'');f.push(c(h.tid));f.push('\');" title="');f.push(c(d));f.push(c(X));f.push('">\n<span></span>');f.push(c(d));f.push(c(X));f.push('\n</h3>\n<div class="cl_teamMembers" id="');f.push(c(h.tid));f.push('_teamMembers"></div>\n</div>\n')}f.push("\n");f=f.join("");b=arguments[1];return b?(b.tagName&&b||document.getElementById(b)).innerHTML=f:f}function R(){function g(i){return i in a?a[i]:this[i]}var a=arguments[0];var c=[];var f=g("item");var Z=g("list");var Y=g("contactType");function X(k,j){if(j){var i=[];for(j in k){i.push(j)}return i}j=typeof k;return j=="number"?new Array(k):j=="string"?k.split(""):k instanceof Array?k:X(k,1)}g=function(i){return"&#"+i.charCodeAt()+";"};function d(i){return String(i).replace(/[<>&"]/g,g)}c.push("\n");var h=Z;var W=0;h=X(h);for(;W<h.length;W++){var f=h[W];c.push("\n");if(f.showtype==1||!f.showtype){c.push("\n");var b=f.showname;c.push("\n")}else{c.push("\n");var e=c;c=[];c.push(f.showname);c.push("<");c.push(f.username);c.push(">");var b=c.join("");c=e;c.push("\n")}c.push('\n<div class="cl_contactNode" id="cl_');c.push(d(f.username));c.push('" onclick="IM.ContactPanel.nodeClickHandler(this, \'');c.push(d(Y));c.push("');webim.Logger.report({'");c.push(d(Y));c.push("nodeclick' : &#34;");c.push(d(f.status=="offline"?"offline":"online"));c.push('&#34;});" onmouseout="IM.ContactPanel.nodeOutHandler(this);" onmouseover="IM.ContactPanel.nodeOverHandler(this);"');var e=b;if(e!=null){c.push(' title="',d(e),'"')}c.push('>\n<div class="cl_');c.push(d(f.status));c.push('"></div>');c.push(d(f.showname));c.push("\n");if(f.relationship==1||f.relationship==2){c.push('\n<span class="cl_gray">(\u672a\u9a8c\u8bc1)</span>\n')}c.push("\n</div>\n")}c.push("\n");c=c.join("");a=arguments[1];return a?(a.tagName&&a||document.getElementById(a)).innerHTML=c:c}function P(){function Z(c){return c in Y?Y[c]:this[c]}var Y=arguments[0];var a=[];var X=Z("IM");function b(d){var c=[];c.push("\n");c.push(W(X.Helper.tr(d)));c.push("\n");return c.join("")}if("tr" in Y){b=Y.tr}Z=function(d){return"&#"+d.charCodeAt()+";"};function W(c){return String(c).replace(/[<>&"]/g,Z)}a.push("\n");a.push('\n<h2 id="cc_header">\n<span>');a.push(W(b("createNewText")));a.push('</span>\n<a hidefocus="true" href="#" id="cc_clsBtn" onclick="IM.ContactPanel.CreateConversation.close();return false;" title="\u5173\u95ed"></a>\n</h2>\n<div id="cc_container">\n<input class="cc_btnNormal" id="cc_selectBtn" onblur="IM.ContactPanel.CreateConversation.wordBlur(this);" onfocus="IM.ContactPanel.CreateConversation.wordFocus(this);" onkeypress="IM.ContactPanel.CreateConversation.wordKeyPress(event);" type="text" value=""/>\n<a hidefocus="true" href="#" id="cc_startBtn" onclick="IM.ContactPanel.CreateConversation.start();return false;" title="\u5173\u95ed">');a.push(W(b("createBtnText")));a.push('</a>\n<span id="cc_errorTip"></span>\n</div>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function O(){function f(h){return h in Z?Z[h]:this[h]}var Z=arguments[0];var b=[];var e=f("item");var Y=f("list");function X(j,i){if(i){var h=[];for(i in j){h.push(i)}return h}i=typeof j;return i=="number"?new Array(j):i=="string"?j.split(""):j instanceof Array?j:X(j,1)}f=function(h){return"&#"+h.charCodeAt()+";"};function c(h){return String(h).replace(/[<>&"]/g,f)}b.push("\n");var g=Y;var W=0;g=X(g);for(;W<g.length;W++){var e=g[W];b.push("\n");if(e.showtype==1||!e.showtype){b.push("\n");var a=e.showname;b.push("\n")}else{b.push("\n");var d=b;b=[];b.push(e.showname);b.push("<");b.push(e.username);b.push(">");var a=b.join("");b=d;b.push("\n")}b.push("\n");if(e.status!="offline"){b.push('\n<div class="cl_contactNode" id="cl_');b.push(c(e.username));b.push('" onclick="IM.ContactPanel.nodeClickHandler(this, \'tb\');webim.Logger.report({\'tbnodeclick\' : \'online\'});" onmouseout="IM.ContactPanel.nodeOutHandler(this);" onmouseover="IM.ContactPanel.nodeOverHandler(this);"');var d=a;if(d!=null){b.push(' title="',c(d),'"')}b.push('>\n<div class="cl_');b.push(c(e.status));b.push('"></div>');b.push(c(e.showname));b.push("\n");if(e.relationship==1||e.relationship==2){b.push('\n<span class="cl_gray">(\u672a\u9a8c\u8bc1)</span>\n')}b.push("\n</div>\n")}b.push("\n")}b.push("\n");b=b.join("");Z=arguments[1];return Z?(Z.tagName&&Z||document.getElementById(Z)).innerHTML=b:b}function F(){function Z(d){return d in Y?Y[d]:this[d]}var Y=arguments[0];var a=[];var X=Z("IM");var c=Z("title");function b(e){var d=[];d.push("\n");d.push(W(X.Helper.tr(e)));d.push("\n");return d.join("")}if("tr" in Y){b=Y.tr}Z=function(d){return"&#"+d.charCodeAt()+";"};function W(d){return String(d).replace(/[<>&"]/g,Z)}a.push("\n");a.push('\n<div id="ml_header">\n<h2 id="ml_title">');a.push(W(c));a.push('</h2>\n<a hidefocus="true" href="#" id="ml_clsBtn" onclick="IM.MessageList.close();return false;" title="\u6536\u8d77\u7cfb\u7edf\u6d88\u606f\u5217\u8868"></a>\n</div>\n<div id="ml_container"></div>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function E(){function l(i){return i in c?c[i]:this[i]}var c=arguments[0];var e=[];var f=l("itemClass");var a=l("list");var k=l("item");var Z=l("i");var Y=l("pIcon");function X(o,n){if(n){var i=[];for(n in o){i.push(n)}return i}n=typeof o;return n=="number"?new Array(o):n=="string"?o.split(""):o instanceof Array?o:X(o,1)}l=function(i){return"&#"+i.charCodeAt()+";"};function d(i){return String(i).replace(/[<>&"]/g,l)}e.push("\n");var m=a;var W=0;m=X(m);for(;W<m.length;W++){var k=m[W];e.push("\n");var f=k.isRead==0?"ml_itemHighlight":" ";e.push('\n<div class="ml_msgItem ');e.push(d(f));e.push('" onmouseout="IM.MessageList.nodeOutHandler(this);" onmouseover="IM.MessageList.nodeOverHandler(this);">\n');if(k.type=="friendaddnotify"){e.push('\n<div class="ml_msgItemIconArea">\n<span class="ml_msgItemIcon ml_msgItemBaiduHi"></span>\n</div>\n<h2>\n<a href="#" onclick="IM.MessageList.imMsgClick(');e.push(d(k.mid));e.push(");IM.MessageList.startConversation('");e.push(d(k.from));e.push('\');return false;" target="_blank">"');e.push(d(k.from));e.push('"</a>\u8bf7\u6c42\u6dfb\u52a0\u60a8\u4e3a\u8054\u7cfb\u4eba\n</h2>\n<div class="ml_msgItemContent">\n<p><nobr>\u9a8c\u8bc1\u4fe1\u606f\uff1a</nobr>');e.push(d(k.content.detail));e.push("</p>\n");if(k.operationCount==0){e.push('\n<a href="#" onclick="IM.ChatDialog.AddContact.passAndAdd(\'');e.push(d(k.from));e.push("');IM.MessageList.imMsgClick('");e.push(d(k.mid));e.push("', '");e.push(d(k.type));e.push('\');return false;">\u901a\u8fc7\u5e76\u52a0\u5bf9\u65b9\u4e3a\u8054\u7cfb\u4eba</a>\n<a href="#" onclick="IM.ChatDialog.AddContact.passContact(\'');e.push(d(k.from));e.push("');IM.MessageList.imMsgClick('");e.push(d(k.mid));e.push("', '");e.push(d(k.type));e.push('\');return false;">\u901a\u8fc7</a><br/>\n<a href="#" onclick="IM.ChatDialog.AddContact.rejectContact(\'');e.push(d(k.from));e.push("');IM.MessageList.imMsgClick('");e.push(d(k.mid));e.push("', '");e.push(d(k.type));e.push('\');return false;">\u62d2\u7edd</a>\n<a href="#" onclick="IM.ChatDialog.AddContact.rejectAndBlock(\'');e.push(d(k.from));e.push("');IM.MessageList.imMsgClick('");e.push(d(k.mid));e.push("', '");e.push(d(k.type));e.push("');return false;\">\u62d2\u7edd\u5e76\u963b\u6b62</a>\n")}e.push("\n");if(k.operationCount>0){e.push("\n<span>\u901a\u8fc7\u5e76\u52a0\u5bf9\u65b9\u4e3a\u8054\u7cfb\u4eba</span>\n<span>\u901a\u8fc7</span><br/>\n<span>\u62d2\u7edd</span>\n<span>\u62d2\u7edd\u5e76\u963b\u6b62</span>\n")}e.push("\n</div>\n")}e.push("\n");if(k.type=="addfriendresponse"){e.push('\n<div class="ml_msgItemIconArea">\n<span class="ml_msgItemIcon ml_msgItemBaiduHi"></span>\n</div>\n');if(k.content.agree==0){e.push('\n<h2>\n<a href="#" onclick="IM.MessageList.imMsgClick(\'');e.push(d(k.mid));e.push("');IM.MessageList.startConversation('");e.push(d(k.from));e.push('\');return false;" target="_blank">');e.push(d(k.from));e.push('</a>\u62d2\u7edd\u4e86\u60a8\u7684\u8bf7\u6c42\n</h2>\n<div class="ml_msgItemContent">\n<p>');e.push(d(k.content.detail));e.push("</p>\n</div>\n")}e.push("\n");if(k.content.agree==1){e.push('\n<h2>\n<a href="#" onclick="IM.MessageList.imMsgClick(\'');e.push(d(k.mid));e.push("');IM.MessageList.startConversation('");e.push(d(k.from));e.push('\');return false;" target="_blank">');e.push(d(k.from));e.push("</a>\u901a\u8fc7\u4e86\u60a8\u7684\u8bf7\u6c42\n</h2>\n")}e.push("\n")}e.push("\n");if(k.type=="sysmsg"){e.push("\n");if(k.content.pid){e.push("\n");if(k.content.pid==1){e.push("\n");var Y="ml_msgItemIknow";e.push("\n");var b="\u77e5\u9053";e.push("\n")}e.push("\n");if(k.content.pid==2){e.push("\n");var Y="ml_msgItemBaike";e.push("\n");var b="\u767e\u79d1";e.push("\n")}e.push("\n");if(k.content.pid==3){e.push("\n");var Y="ml_msgItemTieba";e.push("\n");var b="\u8d34\u5427";e.push("\n")}e.push("\n");if(k.content.pid==4){e.push("\n");var Y="ml_msgItemYoua";e.push("\n");var b="\u6709\u554a";e.push("\n")}e.push("\n");if(k.content.pid==5){e.push("\n");var Y="ml_msgItemBaiduHi";e.push("\n");var j=e;e=[];var b=e.join("");e=j;e.push("\n")}e.push("\n");if(k.content.pid==7){e.push("\n");var Y="ml_msgItemSpace";e.push("\n");var b="\u7a7a\u95f4";e.push("\n")}e.push('\n<div class="ml_msgItemIconArea">\n<span class="ml_msgItemIcon ');e.push(d(Y));e.push('"></span>\n<p>');e.push(d(b));e.push("</p>\n</div>\n<h2>\n");e.push(d(k.content.title));e.push("\n</h2>\n");if(k.content.digest&&k.content.digest.length>0){e.push('\n<div class="ml_msgItemContent">\n');var h=k.content.digest;var j=0;h=X(h);for(;j<h.length;j++){var Z=h[j];e.push("\n<p>\n");if(Z.url){e.push("\n<a");var g=Z.url;if(g!=null){e.push(' href="',d(g),'"')}e.push(" onclick=\"IM.MessageList.imMsgClick('");e.push(d(k.mid));e.push("');webim.Logger.report({'msgclick' : '");e.push(d(k.content.pid));e.push("' + '|' + '");e.push(d(k.content.nid));e.push('\'});return true;" target="_blank">');e.push(d(Z.content));e.push("</a>\n")}e.push("\n");if(!Z.url){e.push("\n");e.push(d(Z.content));e.push("\n")}e.push("\n</p>\n")}e.push("\n");if(k.content.url){e.push('\n<div class="ml_msgItemMore"><a');var j=k.content.url;if(j!=null){e.push(' href="',d(j),'"')}e.push(" onclick=\"webim.Logger.report({'msgdetailclick' : '");e.push(d(k.content.pid));e.push("' + '|' + '");e.push(d(k.content.nid));e.push('\'});" target="_blank">\u67e5\u770b\u8be6\u60c5&gt;&gt;</a></div>\n')}e.push("\n</div>\n")}e.push("\n")}else{e.push('\n<div class="ml_msgItemIconArea">\n<span class="ml_msgItemIcon ml_msgItemBaiduHi"></span>\n</div>\n<h2>');e.push(d(k.content.title));e.push('</h2>\n<div class="ml_msgItemContent">\n<p>');e.push(k.content.detail);e.push("</p>\n</div>\n")}e.push("\n")}e.push("\n</div>\n")}if(!W){e.push('\n<p id="noMsgTip">\u6ca1\u6709\u65b0\u7cfb\u7edf\u6d88\u606f\u3002</p>\n')}e.push("\n");e=e.join("");c=arguments[1];return c?(c.tagName&&c||document.getElementById(c)).innerHTML=e:e}function V(){function f(g){return g in b?b[g]:this[g]}var b=arguments[0];var d=[];var Z=f("closeTip");var e=f("sound");var X=f("IM");var Y=f("stranger");function a(h){var g=[];g.push("\n");g.push(c(X.Helper.tr(h)));g.push("\n");return g.join("")}if("tr" in b){a=b.tr}f=function(g){return"&#"+g.charCodeAt()+";"};function c(g){return String(g).replace(/[<>&"]/g,f)}d.push("\n");d.push('\n<h2 id="sd_header">\n<span id="sd_titleText">');d.push(c(a("settingFrameTitle")));d.push('</span>\n<a hidefocus="true" href="#" id="sd_clsBtn" onclick="IM.SettingDialog.close();return false;"');var W=Z;if(W!=null){d.push(' title="',c(W),'"')}d.push('></a>\n</h2>\n<div id="sd_container">\n<p>\n');if(e==1){d.push('\n<input checked="checked" id="sd_sound" name="sd_sound" onclick="IM.SettingDialog.setPreference(\'voice\', this);" type="checkbox"/>\n')}d.push("\n");if(e==0){d.push('\n<input id="sd_sound" name="sd_sound" onclick="IM.SettingDialog.setPreference(\'voice\', this);" type="checkbox"/>\n')}d.push('\n<label for="sd_sound">');d.push(c(a("soundSetText")));d.push("</label>\n</p>\n<p>\n");if(Y=="reject"){d.push('\n<input checked="checked" id="sd_stranger" name="sd_stranger" onclick="IM.SettingDialog.setPreference(\'tempMessagePolicy\', this);" type="checkbox"/>\n')}d.push("\n");if(Y=="allow"){d.push('\n<input id="sd_stranger" name="sd_stranger" onclick="IM.SettingDialog.setPreference(\'tempMessagePolicy\', this);" type="checkbox"/>\n')}d.push('\n<label for="sd_stranger">');d.push(c(a("strangerSetText")));d.push('</label>\n</p>\n<div id="sd_status"></div>\n</div>\n');d=d.join("");b=arguments[1];return b?(b.tagName&&b||document.getElementById(b)).innerHTML=d:d}function S(){function h(i){return i in d?d[i]:this[i]}var d=arguments[0];var f=[];var g=h("onlineClass");var b=h("hideClass");var Y=h("statusText");var Z=h("IM");var X=h("offlineClass");var a=h("status");function c(j){var i=[];i.push("\n");i.push(e(Z.Helper.tr(j)));i.push("\n");return i.join("")}if("tr" in d){c=d.tr}h=function(i){return"&#"+i.charCodeAt()+";"};function e(i){return String(i).replace(/[<>&"]/g,h)}f.push("\n");f.push('\n<div id="sd_statusControl">\n<p id="sd_statusText">');f.push(e(Y));f.push('</p>\n</div>\n<div id="sd_statusSelect">\n<ul>\n');if(a=="online"){f.push("\n");var g="sd_statusOn";f.push("\n")}f.push("\n");if(a=="hide"){f.push("\n");var b="sd_statusOn";f.push("\n")}f.push("\n");if(a=="offline"){f.push("\n");var X="sd_statusOn";f.push("\n")}f.push("\n<li");var W=g;if(W!=null){f.push(' class="',e(W),'"')}f.push(' id="sd_onlineIcon" onclick="IM.SettingDialog.switchStatus(\'online\');" onmouseout="IM.SettingDialog.statusItemOut(this);" onmouseover="IM.SettingDialog.statusItemHover(this);">\n<span></span>');f.push(e(c("onlineText")));f.push("\n</li>\n<li");var W=b;if(W!=null){f.push(' class="',e(W),'"')}f.push(' id="sd_busyIcon" onclick="IM.SettingDialog.switchStatus(\'hide\');" onmouseout="IM.SettingDialog.statusItemOut(this);" onmouseover="IM.SettingDialog.statusItemHover(this);">\n<span></span>');f.push(e(c("busyText")));f.push("\n</li>\n<li");var W=X;if(W!=null){f.push(' class="',e(W),'"')}f.push(' id="sd_offlineIcon" onclick="IM.SettingDialog.switchStatus(\'offline\');" onmouseout="IM.SettingDialog.statusItemOut(this);" onmouseover="IM.SettingDialog.statusItemHover(this);">\n<span></span>');f.push(e(c("offlineText")));f.push("\n</li>\n</ul>\n</div>\n");f=f.join("");d=arguments[1];return d?(d.tagName&&d||document.getElementById(d)).innerHTML=f:f}function U(){function Z(e){return e in Y?Y[e]:this[e]}var Y=arguments[0];var a=[];var X=Z("IM");var b=Z("onlineStatus");var d=Z("title");function c(f){var e=[];e.push("\n");e.push(W(X.Helper.tr(f)));e.push("\n");return e.join("")}if("tr" in Y){c=Y.tr}Z=function(e){return"&#"+e.charCodeAt()+";"};function W(e){return String(e).replace(/[<>&"]/g,Z)}a.push("\n");a.push('\n<h2 id="cd_header">\n<div class="cd_');a.push(W(b));a.push('Icon" id="cd_statusIcon"></div>\n<div id="cd_title">');a.push(W(d));a.push('</div>\n<a hidefocus="true" href="#" id="cd_minBtn" onclick="IM.ChatDialog.Pannel.min();webim.Logger.report({\'dialogmin\' : \'1\'});return false;" title="\u6700\u5c0f\u5316"></a>\n<a hidefocus="true" href="#" id="cd_clsBtn" onclick="IM.ChatDialog.Pannel.close();webim.Logger.report({\'dialogclose\' : \'1\'});return false;" title="\u5173\u95ed"></a>\n</h2>\n<div id="cd_container">\n<div class="cd_noTab" id="cd_msgAndEditor"></div>\n<div id="cd_tabContainer"></div>\n</div>\n<div id="cd_faceFrame"></div>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function H(){function Z(c){return c in Y?Y[c]:this[c]}var Y=arguments[0];var a=[];var X=Z("IM");function b(d){var c=[];c.push("\n");c.push(W(X.Helper.tr(d)));c.push("\n");return c.join("")}if("tr" in Y){b=Y.tr}Z=function(d){return"&#"+d.charCodeAt()+";"};function W(c){return String(c).replace(/[<>&"]/g,Z)}a.push("\n");a.push('\n<div id="cd_msgArea">\n<div id="cd_recordContainer">\n<div id="cd_clientTip" onmouseout="IM.ChatDialog.ChatRecord.closeTipClsBtn();" onmouseover="IM.ChatDialog.ChatRecord.showTipClsBtn();">\n<div id="cd_tipContent">\n<span id="cd_tipLogo"></span>\n<p id="cd_tipText">\n<a href="http://im.baidu.com/html/promo/webim.html" onclick="webim.Logger.report({\'downloadclick\' : 1});" target="_blank">');a.push(W(b("imlink")));a.push("</a>\n<span>");a.push(W(b("imTipText")));a.push('</span>\n</p>\n</div>\n<a hidefocus="true" href="#" id="cd_tipClose" onclick="IM.ChatDialog.ChatRecord.closeTip();webim.Logger.report({\'dialogtipclose\' : 1});return false;" title="\u5173\u95ed"></a>\n</div>\n<div id="cd_chatRecord"></div>\n</div>\n</div>\n<div id="cd_editorToolBar">\n<div class="cd_faceBtnNormal" id="cd_faceBtn" onclick="IM.ChatDialog.Editor.faceClick(this);" title="\u8868\u60c5"></div>\n<div id="cd_setBtn" onclick="IM.ChatDialog.Editor.setClick(this);" title="\u963b\u6b62\u8be5\u8054\u7cfb\u4eba"></div>\n<div id="cd_recordBtn" onclick="IM.ChatDialog.Editor.recordClick(this);" title="\u67e5\u770b\u6f2b\u6e38\u804a\u5929\u8bb0\u5f55"></div>\n<div id="cd_addNewBtn" onclick="IM.ChatDialog.Editor.addNewClick(this);">');a.push(W(b("addContact")));a.push('</div>\n</div>\n<div class="cd_editorNormal" id="cd_editor">\n<textarea id="cd_editorArea" onblur="IM.ChatDialog.Editor.blur();" onclick="IM.ChatDialog.Editor.clickHandler();IM.ChatDialog.Editor.saveCursorPos();" onfocus="IM.ChatDialog.Editor.focus();" onkeydown="IM.ChatDialog.Editor.keySend(event);" onkeyup="IM.ChatDialog.Editor.keyUp(event);"></textarea>\n<span class="cd_sendNormal" id="cd_sendBtn" onclick="IM.ChatDialog.Editor.send();" onmouseout="IM.ChatDialog.Editor.sendBtnOut(this);" onmouseover="IM.ChatDialog.Editor.sendBtnHover(this);">');a.push(W(b("sendText")));a.push('</span>\n<span id="cd_shortSend" onclick="IM.ChatDialog.Editor.showShortSelect();"></span>\n</div>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function A(){function f(h){return h in a?a[h]:this[h]}var a=arguments[0];var b=[];var Y=f("facesArray");var Z=f("className");var e=f("item");function X(j,i){if(i){var h=[];for(i in j){h.push(i)}return h}i=typeof j;return i=="number"?new Array(j):i=="string"?j.split(""):j instanceof Array?j:X(j,1)}f=function(h){return"&#"+h.charCodeAt()+";"};function c(h){return String(h).replace(/[<>&"]/g,f)}b.push('\n<div id="cd_faceHeader">\n');var g=Y;var W=0;g=X(g);for(;W<g.length;W++){var e=g[W];b.push("\n");var Z=e.faceType=="default"&&"cd_faceTypeOn"||"";b.push("\n<div");var d=Z;if(d!=null){b.push(' class="',c(d),'"')}b.push(" onclick=\"IM.ChatDialog.FaceFrame.switchFace('");b.push(c(e.faceType));b.push('\');" onmouseout="IM.ChatDialog.FaceFrame.typeOut(this);" onmouseover="IM.ChatDialog.FaceFrame.typeHover(this);">\n');b.push(c(e.title));b.push("\n</div>\n")}b.push('\n</div>\n<div id="cd_faceContainer"></div>\n');b=b.join("");a=arguments[1];return a?(a.tagName&&a||document.getElementById(a)).innerHTML=b:b}function C(){function b(i){return i in o?o[i]:this[i]}var o=arguments[0];var k=[];var q=b("faceType");var p=b("faceUrl");var X=b("row");var W=b("col");var a=b("items");var d=b("faceItem");function Z(r,j){if(j){var i=[];for(j in r){i.push(j)}return i}j=typeof r;return j=="number"?new Array(r):j=="string"?r.split(""):r instanceof Array?r:Z(r,1)}b=function(i){return"&#"+i.charCodeAt()+";"};function Y(i){return String(i).replace(/[<>&"]/g,b)}k.push("\n<table>\n");var l=6;var n=0;l=Z(l);o={lastIndex:l.length-1};for(;n<l.length;n++){o.index=n;var m=l[n];var X=o;k.push("\n<tr>\n");var f=8;var h=0;f=Z(f);var e=o;o={lastIndex:f.length-1};for(;h<f.length;h++){o.index=h;var g=f[h];var W=o;k.push("\n");var d=a[X.index*8+W.index];k.push('\n<td onclick="IM.ChatDialog.FaceFrame.faceItemClick(&#34;');k.push(Y(d&&d.shortcut));k.push('&#34;);">\n');if(d){k.push("\n<a");var c=d.name;if(c!=null){k.push(' title="',Y(c),'"')}k.push(">\n");if(q=="default"){k.push("\n<span style=\"background:url('");k.push(Y(p));k.push("') 0 ");k.push(Y(-(X.index*8+W.index)*19));k.push('px no-repeat;"></span>\n')}k.push("\n");if(q=="bear"){k.push("\n<span style=\"width:24px;height:24px;margin:2px auto;background:url('");k.push(Y(p));k.push("') 0 ");k.push(Y(-(X.index*8+W.index)*24));k.push('px no-repeat;"></span>\n')}k.push("\n</a>\n")}else{k.push("\xa0")}k.push("\n</td>\n")}o=e;k.push("\n</tr>\n")}k.push("\n</table>\n");k=k.join("");o=arguments[1];return o?(o.tagName&&o||document.getElementById(o)).innerHTML=k:k}function T(){function e(g){return g in Y?Y[g]:this[g]}var Y=arguments[0];var a=[];var Z=e("tabs");var d=e("item");function X(i,h){if(h){var g=[];for(h in i){g.push(h)}return g}h=typeof i;return h=="number"?new Array(i):h=="string"?i.split(""):i instanceof Array?i:X(i,1)}e=function(g){return"&#"+g.charCodeAt()+";"};function b(g){return String(g).replace(/[<>&"]/g,e)}a.push('\n<div id="cd_tabs">\n<div id="cd_tabsWrap">\n');var f=Z;var W=0;f=X(f);for(;W<f.length;W++){var d=f[W];a.push("\n");if(d.isActived){a.push('\n<div class="cd_tabItem cd_tabOn" id="cd_');a.push(b(d.uname));a.push('_tab" onclick="IM.ChatDialog.TabControl.itemClick(this);" onmouseout="IM.ChatDialog.TabControl.itemOut(this);" onmouseover="IM.ChatDialog.TabControl.itemOver(this);">\n<span class="cd_tabUname"');var c=d.showname;if(c!=null){a.push(' title="',b(c),'"')}a.push(">");a.push(b(d.showname));a.push('</span>\n<a class="cd_tabClose" id="cd_');a.push(b(d.uname));a.push('" onclick="IM.ChatDialog.TabControl.closeTab(event);" title="\u5173\u95ed"></a>\n</div>\n')}a.push("\n");if(d.isBlink){a.push('\n<div class="cd_tabItem cd_tabBlink" id="cd_');a.push(b(d.uname));a.push('_tab" onclick="IM.ChatDialog.TabControl.itemClick(this);" onmouseout="IM.ChatDialog.TabControl.itemOut(this);" onmouseover="IM.ChatDialog.TabControl.itemOver(this);">\n<span class="cd_tabUname"');var c=d.showname;if(c!=null){a.push(' title="',b(c),'"')}a.push(">");a.push(b(d.showname));a.push('</span>\n<a class="cd_tabClose" id="cd_');a.push(b(d.uname));a.push('" onclick="IM.ChatDialog.TabControl.closeTab(event);" title="\u5173\u95ed"></a>\n</div>\n')}a.push("\n");if(!d.isActived&&!d.isBlink){a.push('\n<div class="cd_tabItem" id="cd_');a.push(b(d.uname));a.push('_tab" onclick="IM.ChatDialog.TabControl.itemClick(this);" onmouseout="IM.ChatDialog.TabControl.itemOut(this);" onmouseover="IM.ChatDialog.TabControl.itemOver(this);">\n<span class="cd_tabUname"');var c=d.showname;if(c!=null){a.push(' title="',b(c),'"')}a.push(">");a.push(b(d.showname));a.push('</span>\n<a class="cd_tabClose" id="cd_');a.push(b(d.uname));a.push('" onclick="IM.ChatDialog.TabControl.closeTab(event);" title="\u5173\u95ed"></a>\n</div>\n')}a.push("\n")}a.push("\n</div>\n</div>\n");if(Z.length>9){a.push('\n<div id="cd_tabControl">\n<span class="cd_tabUpNormal" id="cd_tabUp" onclick="IM.ChatDialog.TabControl.tabUp(this);" onmouseout="IM.ChatDialog.TabControl.tabUpOut(this);" onmouseover="IM.ChatDialog.TabControl.tabUpOver(this);"></span>\n<span class="cd_tabDownNormal" id="cd_tabDown" onclick="IM.ChatDialog.TabControl.tabDown(this);" onmouseout="IM.ChatDialog.TabControl.tabDownOut(this);" onmouseover="IM.ChatDialog.TabControl.tabDownOver(this);"></span>\n</div>\n')}a.push("\n");a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function K(){function j(i){return i in Z?Z[i]:this[i]}var Z=arguments[0];var b=[];var h=j("item");var e=j("chatRecord");var Y=j("i");var f=j("uname");function X(m,l){if(l){var i=[];for(l in m){i.push(l)}return i}l=typeof m;return l=="number"?new Array(m):l=="string"?m.split(""):m instanceof Array?m:X(m,1)}j=function(i){return"&#"+i.charCodeAt()+";"};function a(i){return String(i).replace(/[<>&"]/g,j)}b.push("\n");var k=e;var W=0;k=X(k);for(;W<k.length;W++){var h=k[W];b.push('\n<div class="cd_chatRecordTitle">\n');if(h.sender==f){b.push('\n<span class="cd_chatRecordUname">');b.push(a(h.showname));b.push("</span>\n")}b.push("\n");if(h.sender!=f){b.push('\n<span class="cd_chatRecordUname cd_selfName">');b.push(a(h.showname));b.push("</span>\n")}b.push('\n<span class="cd_chatRecordDate">');b.push(a(h.time));b.push('</span>\n</div>\n<div class="cd_chatRecordBody">\n');var d=h.content;var g=0;d=X(d);for(;g<d.length;g++){var Y=d[g];b.push("\n");if(Y.type=="text"){b.push(Y.c)}b.push("\n");if(Y.type=="face"){b.push("\n<img");var c=Y.n;if(c!=null){b.push(' alt="',a(c),'"')}b.push(' onload="IM.ChatDialog.ChatRecord.imgLoaded(this);" onreadystatechange="IM.ChatDialog.ChatRecord.imgLoaded(this);"');var c=Y.url;if(c!=null){b.push(' src="',a(c),'"')}b.push("/>\n")}b.push("\n");if(Y.type=="cface"){b.push("[\u56fe\u7247]")}b.push("\n");if(Y.type=="img"){b.push("[\u56fe\u7247]")}b.push("\n");if(Y.type=="url"){b.push("<a");var c=Y.ref;if(c!=null){b.push(' href="',a(c),'"')}b.push(' target="_blank">');b.push(a(Y.ref));b.push("</a>")}b.push("\n")}b.push("\n</div>\n")}b.push("\n");b=b.join("");Z=arguments[1];return Z?(Z.tagName&&Z||document.getElementById(Z)).innerHTML=b:b}function Q(){function Y(b){return b in X?X[b]:this[b]}var X=arguments[0];var Z=[];var a=Y("title");Y=function(b){return"&#"+b.charCodeAt()+";"};function W(b){return String(b).replace(/[<>&"]/g,Y)}Z.push('\n<div id="pop_wrap">\n<div id="pop_content">\n<div id="pop_title">\n<h2>');Z.push(W(a));Z.push('</h2>\n<a id="pop_close" onclick="IM.Helper.Popup.close();" title="\u5173\u95ed"></a>\n</div>\n<div id="pop_body"></div>\n</div>\n<div id="pop_shadow"></div>\n</div>\n');Z=Z.join("");X=arguments[1];return X?(X.tagName&&X||document.getElementById(X)).innerHTML=Z:Z}function J(){function j(l){return l in d?d[l]:this[l]}var d=arguments[0];var g=[];var b=j("comment");var f=j("teams");var a=j("tid");var X=j("v_url");var i=j("item");var Z=j("IM");var h=j("uname");function c(m){var l=[];l.push("\n");l.push(e(Z.Helper.tr(m)));l.push("\n");return l.join("")}if("tr" in d){c=d.tr}function Y(n,m){if(m){var l=[];for(m in n){l.push(m)}return l}m=typeof n;return m=="number"?new Array(n):m=="string"?n.split(""):n instanceof Array?n:Y(n,1)}j=function(l){return"&#"+l.charCodeAt()+";"};function e(l){return String(l).replace(/[<>&"]/g,j)}g.push("\n");g.push('\n<div>\n<p>\u60a8\u5c06\u6dfb\u52a0<span id="pop_username">');g.push(e(h));g.push('</span>\u4e3a\u8054\u7cfb\u4eba\u3002</p>\n<p id="pop_validate">\u5bf9\u65b9\u9700\u8981\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\uff0c\u8bf7\u8f93\u5165\u9a8c\u8bc1\u4fe1\u606f\uff1a</p>\n<textarea id="pop_comment" onkeypress="IM.ChatDialog.AddContact.keyPress(event);">');g.push(e(b));g.push('</textarea>\n<p class="pop_tipText">(60\u5b57\u4ee5\u5185)</p>\n<p id="pop_addToTeam">\u6dfb\u52a0\u5230\u5206\u7ec4\uff1a</p>\n<select id="pop_teamSelect" onkeypress="IM.ChatDialog.AddContact.keyPress(event);">\n');var k=f;var W=0;k=Y(k);for(;W<k.length;W++){var i=k[W];g.push("\n");if(i.tid==a){g.push('\n<option id="pop_');g.push(e(i.tid));g.push('" selected="selected">');g.push(e(i.name));if(!i.name){g.push(e(c("defaultTeam")))}g.push("</option>\n")}else{g.push('\n<option id="pop_');g.push(e(i.tid));g.push('">');g.push(e(i.name));if(!i.name){g.push(e(c("defaultTeam")))}g.push("</option>\n")}g.push("\n")}g.push('\n</select>\n<div id="pop_validateText">\n<p>\u9a8c\u8bc1\u7801\uff1a</p>\n<input id="pop_validateCode" onkeypress="IM.ChatDialog.AddContact.keyPress(event);" type="text"/>\n<img alt="" height="40" id="pop_vcodeImg"');var W=X;if(W!=null){g.push(' src="',e(W),'"')}g.push(' width="120"/>\n<a href="#" onclick="IM.ChatDialog.AddContact.refreshVcode();return false;">\u770b\u4e0d\u6e05\uff1f</a>\n<span id="sendVcodeError"></span>\n</div>\n<div id="pop_buttonDiv">\n<input id="pop_addBtn" onclick="IM.ChatDialog.AddContact.addContact();" type="button" value="\u6dfb\u52a0"/>\n<input onclick="IM.Helper.Popup.close();" type="button" value="\u53d6\u6d88"/>\n</div>\n</div>\n');g=g.join("");d=arguments[1];return d?(d.tagName&&d||document.getElementById(d)).innerHTML=g:g}function I(){function Z(b){return b in Y?Y[b]:this[b]}var Y=arguments[0];var a=[];var W=Z("tipText");Z=function(b){return"&#"+b.charCodeAt()+";"};function X(b){return String(b).replace(/[<>&"]/g,Z)}a.push('\n<div id="pop_addOk" onkeypress="IM.ChatDialog.AddContact.addOkKeyPress(event);">\n<span></span>\n<p>');a.push(X(W));a.push('</p>\n<div><input onclick="IM.Helper.Popup.close();" type="button" value="\u786e\u5b9a"/></div>\n</div>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}function G(){function Y(c){return c in X?X[c]:this[c]}var X=arguments[0];var a=[];var Z=Y("v_src");Y=function(d){return"&#"+d.charCodeAt()+";"};function W(c){return String(c).replace(/[<>&"]/g,Y)}a.push('\n<div id="pop_validateFrame">\n<p>\u60a8\u5df2\u5728\u77ed\u65f6\u95f4\u5185\u5411\u975e\u597d\u53cb\u53d1\u9001\u4e86\u591a\u6761\u4fe1\u606f\uff0c\u8bf7\u586b\u5199\u4ee5\u4e0b\u9a8c\u8bc1\u7801\u7ee7\u7eed\uff0c\u6216<a href="#" onclick="IM.ChatDialog.sendProcess.startAddProcess();return false;">\u6dfb\u52a0TA\u4e3a\u597d\u53cb</a></p>\n<div id="pop_validateText">\n<p>\u9a8c\u8bc1\u7801\uff1a</p>\n<input id="pop_sendVcode" onkeypress="IM.ChatDialog.sendProcess.keyPress(event);" type="text"/>\n<img alt="" id="pop_sendVcodeImg"');var b=Z;if(b!=null){a.push(' src="',W(b),'"')}a.push('/>\n<a href="#" onclick="IM.ChatDialog.sendProcess.refreshVcode();return false;">\u770b\u4e0d\u6e05\uff1f</a>\n<span id="sendVcodeError"></span>\n</div>\n<div id="pop_buttonDiv">\n<input id="sendAgainBtn" onclick="IM.ChatDialog.sendProcess.sendAgain();" type="button" value="\u786e\u5b9a"/>\n<input onclick="IM.Helper.Popup.close();" type="button" value="\u53d6\u6d88"/>\n</div>\n</div>\n');a=a.join("");X=arguments[1];return X?(X.tagName&&X||document.getElementById(X)).innerHTML=a:a}function N(){function Z(c){return c in Y?Y[c]:this[c]}var Y=arguments[0];var a=[];var W=Z("tipText");var b=Z("left");Z=function(d){return"&#"+d.charCodeAt()+";"};function X(c){return String(c).replace(/[<>&"]/g,Z)}a.push('\n<table cellpadding="0" cellspacing="0">\n<tbody>\n<tr>\n<td class="mulan_tips">\n<nobr>');a.push(X(W));a.push('</nobr>\n</td>\n</tr>\n<tr>\n<td class="mulan_arrow" style="background-position:');a.push(X(b));a.push(' 0;"></td>\n</tr>\n</tbody>\n</table>\n');a=a.join("");Y=arguments[1];return Y?(Y.tagName&&Y||document.getElementById(Y)).innerHTML=a:a}var L={mulanBar:D,contactFrame:M,teamList:B,contactList:R,followList:O,messageFrame:F,messageList:E,settingFrame:V,setStatus:S,dialog:U,contactTab:T,createDialog:P,faceFrame:A,faceList:C,editor:H,chatRecord:K,popup:Q,addContact:J,addOk:I,validateFrame:G,tipBox:N};baidu.lang.module("IM.Template",L)})();(function(){var K=null;var L=null;var I=null;function F(){I=chinese}function N(){K=webim.model.DataService;L=K.T.Runtime;P("im_uiStatusChange",function(S){GrandCentral.call({e:"syncEvent",type:S})});baidu.on(window,"blur",function(U){U=window.event||U;var T=document.getElementById("cd_faceFrame");if(T){T.style.display="none";var S=document.getElementById("cd_faceBtn");if(S.className.indexOf("cd_faceBtnOn")!=-1){baidu.removeClass(S,"cd_faceBtnOn")}}var V=document.getElementById("mulan_createConversation");if(V){V.style.display="none"}})}function A(S){return I[S]}function D(){var S=baidu.swf.getMovie("mulanSound");if(S.asPlaySystemRing){S.asPlaySystemRing("msg")}}function G(S,T){L.save({key:S,value:T})}function P(S,U){var T=L.getBaseTable();L.listen({type:[T.ACTION_ADD,T.ACTION_UPDATE],value:S},function(V){U(L.get(S).value)})}function C(S,T){}function E(S,U){var T=L.get(S);if(T){U(T.value)}else{U(null)}}function M(S){S=S||"";if(S&&S!=""){S=S.replace(/&lt;/g,"LESS_THAN_REPLACEMENT").replace(/&gt;/g,"GREATER_THAN_REPLACEMENT");S=S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;");S=S.replace(/LESS_THAN_REPLACEMENT/g,"&lt;").replace(/GREATER_THAN_REPLACEMENT/g,"&gt;")}return S}function R(W,V){if(document.selection){W.focus();sel=document.selection.createRange();sel.text=V;sel.select()}else{if(W.selectionStart||W.selectionStart=="0"){var U=W.selectionStart;var T=W.selectionEnd;var S=W.scrollTop;W.value=W.value.substring(0,U)+V+W.value.substring(T,W.value.length);if(S>0){W.scrollTop=S}W.focus();W.selectionStart=U+V.length;W.selectionEnd=U+V.length}else{W.value+=V;W.focus()}}}function J(Z){if(baidu.ie){var W=baidu.G(Z);var T=document.selection.createRange();var X=T.text;var Y,S;if(T.parentElement().id==W.id){var U=document.body.createTextRange();U.moveToElementText(W);for(Y=0;U.compareEndPoints("StartToStart",T)<0;Y++){U.moveStart("character",1)}for(var V=0;V<=Y;V++){if(W.value.charAt(V)=="\n"){Y++}}var U=document.body.createTextRange();U.moveToElementText(W);for(S=0;U.compareEndPoints("StartToEnd",T)<0;S++){U.moveStart("character",1)}for(var V=0;V<=S;V++){if(W.value.charAt(V)=="\n"){S++}}}return Y}}function B(V,U){if(baidu.ie){var S=document.getElementById(V);var T=S.createTextRange();T.collapse(true);T.moveStart("character",U);T.select()}}function O(W,X,S,T){if(baidu.G(W)){return }var Y=document.createElement("div");Y.id=W;Y.className="mulan-tips-holder";Y.style.position="absolute";var V=baidu.dom.getPosition(X);offLest=T&&T.left||10;offTop=T&&T.top||30;Y.style.left=(V.left-offLest)+"px";Y.style.top=(V.top-offTop)+"px";var U={left:(T&&T.arrLeft||8)+"px",tipText:S};Y.innerHTML=IM.Template.tipBox(U);document.body.appendChild(Y);baidu.on(window,"scroll",function(){if(baidu.G(W)){baidu.G(W).style.display="none"}})}function Q(S){if(baidu.G(S)){baidu.dom.remove(S)}}F();var H={tr:A,playSound:D,sync:G,getSafeHTML:M,getUIStatus:E,saveUIStatus:C,registerSync:P,insertAtCursor:R,getCursorPos:J,setCursorPos:B,showTip:O,closeTip:Q,init:N};baidu.lang.module("IM.Helper",H)})();(function(){var D={};function F(){var H=document.createElement("div");H.setAttribute("id","ml_maskDiv");document.body.appendChild(H);baidu.setStyle(H,"opacity","0.3");baidu.setStyle("ml_maskDiv","height",parseInt(baidu.page.getHeight())+"px");baidu.hide(H);var I=document.createElement("div");I.setAttribute("id","ml_popupDiv");document.body.appendChild(I);baidu.setStyle("ml_popupDiv","height",parseInt(baidu.page.getHeight())+"px");baidu.hide(I);webim.api.Self.listen({e:"statusChange"},function(K){var J=K.status;if(J=="offline"){destroy()}});GrandCentral.listen({source:"main",type:"statusChange"},function(K){var J=K.data.status;if(J=="offline"){E()}})}function G(J,I){if(D.onDestroy){D.onDestroy()}D=I;var H={title:I.title};IM.Template.popup(H,"ml_popupDiv");baidu.G("pop_body").innerHTML=J;baidu.setStyle("pop_shadow","opacity","0.3");baidu.setStyle("pop_shadow","z-index","11");if(baidu.ie==6){baidu.on(window,"scroll",C)}baidu.on(window,"resize",C)}function C(){var J=baidu.page.getViewWidth();var H=baidu.page.getViewHeight();var M=baidu.G("pop_content").offsetWidth;var N=baidu.G("pop_content").offsetHeight;var I=(typeof document.compatMode!="undefined"&&/CSS.Compat/.test(document.compatMode))?false:true;if(baidu.ie==6||baidu.ie&&I){var L=(J/2-M/2)+"px";baidu.setStyle("pop_shadow","height",baidu.G("pop_content").offsetHeight+"px");baidu.setStyle("pop_wrap","position","absolute");baidu.setStyle("pop_wrap","left",L);baidu.setStyle("pop_wrap","bottom","auto");var K=H-N-100;baidu.G("pop_wrap").style.setExpression("top","eval((document.documentElement.scrollTop || document.body.scrollTop) + "+K+") + 'px'")}if(baidu.ie!=6){var M=baidu.G("pop_content").offsetWidth;baidu.setStyle("pop_shadow","height",baidu.G("pop_content").offsetHeight+"px");baidu.setStyle("pop_wrap","left",(J/2-M/2)+"px")}}function B(){document.getElementById("ml_maskDiv").style.display="block";document.getElementById("ml_popupDiv").style.display="block";C();if(D.onShow){D.onShow()}}function E(){document.getElementById("ml_maskDiv").style.display="none";document.getElementById("ml_popupDiv").style.display="none";baidu.un(window,"scroll",C);baidu.un(window,"resize",C);if(D.onClose){D.onClose()}}var A={init:F,initPopup:G,show:B,close:E};baidu.lang.module("IM.Helper.Popup",A)})();(function(){function C(E){baidu.page.loadCssFile("http://st1.im.baidu.com/m/iknow/mulan/styles/mulan.css");IM.MulanBar.init(E);var D=true;window.setTimeout(function(){D=true},3000);baidu.on(window,"load",function(){D=true});window.isReady=function(){return D};baidu.swf.create({id:"mulanSound",name:"mulanSound",url:"http://st0.im.baidu.com/m/iknow/mulan/flash/sound.swf?t="+new Date().getTime(),width:"2",height:"2",allowscriptaccess:"always",allowfullscreen:true,wmode:"transparent",errorMessage:"\u8bf7\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684FlashPlayer",ver:"9.0.0"},"mulan_flashContainer");baidu.on(document,"click",function(H){H=window.event||H;var G=H.srcElement||H.target;var F=baidu.dom.contains(baidu.G("mulan_webimWrapper"),G);if(!F){GrandCentral.call({source:"IM.Global",type:"documentClick"})}});webim.api.Self.listen({e:"statusChange"},function(G){var F=G.status.value;GrandCentral.call({source:"main",type:"statusChange",data:{status:F}})});webim.api.System.listen({e:"statusChange"},function(G){var F="";if(G.data=="offline"){F="offline"}else{F=webim.api.Self.getStatus()}GrandCentral.call({source:"main",type:"statusChange",data:{status:F}})});C=function(){}}function B(G,F,E){var D=webim.api.System;window.mulanlogdata.apistart=new Date().getTime();D.init(F,{Service:{iframeUrl:"http://web.im.baidu.com/m/tieba/webim-api/package.html"}},function(){window.mulanlogdata.apiok=new Date().getTime();if(E){E(F)}C(G);window.mulanlogdata.appok=new Date().getTime()})}var A={init:C,main:B};baidu.lang.module("mulan.webim",A)})()})();