baidu.sio.callByServer=function(A,F){var D=document.createElement("SCRIPT"),B="bd__cbs__",E=typeof F,C;if("string"==E){C=F}else{if("function"==E){while(1){C=B+Math.floor(Math.random()*2147483648).toString(36);if(!window[C]){window[C]=function(){try{F.apply(window,arguments)}finally{if(D.clearAttributes){D.clearAttributes()}else{for(var G in D){if(D.hasOwnProperty(G)){delete D[G]}}}if(D&&D.parentNode){D.parentNode.removeChild(D)}D=null;window[C]=null}};break}}}}if("string"==typeof C){A=A.replace(/(\?|&)callback=[^&]*/,"\x241callback="+C);if(A.search(/(\?|&)callback=/)<0){A+=(A.indexOf("?")<0?"?":"&");A+="callback="+C}}D.setAttribute("type","text/javascript");D.setAttribute("src",A);document.getElementsByTagName("head")[0].appendChild(D)};(function(){var A="0729";var T=[],P=null,E=0,N={};function O(a,Y,Z,W,X){var U="";if(W){U=W.caller.toString()}if(typeof (Y)=="object"){Y=baidu.json.encode(Y)}var V={mark:Z,level:a,value:Y,caller:U,trace:X,time:new Date()};T.push(V);if(D.onData){if(P){if(P(V)){D.onData(V)}}else{D.onData(V)}}}function G(W,X,U,V){O("log",W,X,U,V)}function R(W,X,U,V){O("info",W,X,U,V)}function K(W,X,U,V){O("error",W,X,U,V)}function F(V,W){var U=[];if(V){baidu.each(T,function(X){if(X[V]==W){U.push(X)}})}else{U=T}return U}function L(V){webim.Logger.__mulan_report_img_holder=webim.Logger.__mulan_report_img_holder||[];var U=new Image();baidu.object.extend(V,C());U.src="http://st3.im.baidu.com/nop.html?"+baidu.url.jsonToQuery(V,function(W){return encodeURIComponent(W)});webim.Logger.__mulan_report_img_holder.push(U)}function J(U,W){var V=new Date().getTime();N[U]=N[U]||[];N[U].push({mark:W,time:V});return V}function Q(X,Z){var V=N[X];if(V){for(var Y=0,U=V.length;Y<U;Y++){var W=V[Y];if(W.mark===Z){return W.time}}}return null}function I(W){var X=[];if(W){var U=N[W];X.push(V+": "+baidu.json.encode(U))}else{for(var V in N){var U=N[V];X.push(V+": "+baidu.json.encode(U))}}return X.join("\n")}function C(){var U={};U.domain=window.location.host;U.ie=baidu.browser.ie||"";U.opera=baidu.browser.ie||"";U.firefox=baidu.browser.firefox||"";U.chrome=baidu.browser.chrome||"";U.safari=baidu.browser.safari||"";U.logv=A;U.app="mulan";if(webim&&webim.Core){U.username=webim.Core.getUsername();U.guid=webim.Core.guid}return U}function S(){T=[]}function B(U){P=U}function M(){E++;return E}function H(){}var D;if(baidu.url.getQueryValue(window.location.href,"mulandebug")){D={log:G,info:R,error:K,dump:F,setTime:J,getTime:Q,dumpTime:I,report:L,reset:S,setFilter:B,trace:M}}else{D={log:H,info:H,error:H,dump:H,setTime:H,getTime:H,dumpTime:H,report:L,reset:H,setFilter:H,trace:H}}baidu.lang.module("webim.Logger",D)})();(function(){var D=window.GrandCentral={};var B=D.Operators={};B[""]=function(F,E){if(F instanceof Array){return B["in"].apply(this,arguments)}else{return B.eq.apply(this,arguments)}};B.eq=function(H,J){if(arguments.length<2){return false}if(H===null||H===undefined||J===null||J===undefined){return(J===H)}switch(H.constructor){case String:case Number:case Boolean:if(H.constructor!=J.constructor){return false}return J==H&&J.constructor==H.constructor;default:if(H instanceof Array){if(!(J instanceof Array)){return false}if(J.length!=H.length){return false}for(var F=0;F<H.length;F++){if(!B.eq(H[F],J[F])){return false}}return true}else{if(!(J instanceof Object)){return false}for(var K in H){var G=K.lastIndexOf("$");var M;var I;var L=H[K];var E;if(G<0){M=K;E=""}else{M=K.substr(0,G);E=K.substr(G+1)}if(B[E]){if(M in J){I=J[M];if(!B[E](L,I)){return false}}else{if(!B[E](L)){return false}}}else{throw"operator doesn't exist: "+E}}return true}}};B.ne=function(F,E){return arguments.length==2&&!B.eq(F,E)};B.lt=function(F,E){return arguments.length==2&&E<F};B.lte=function(F,E){return arguments.length==2&&E<=F};B.gt=function(F,E){return arguments.length==2&&E>F};B.gte=function(F,E){return arguments.length==2&&E>=F};B["in"]=function(G,F){if(arguments.length<2){return false}for(var E=0;E<G.length;E++){if(B.eq(G[E],F)){return true}}return false};B.nin=function(F,E){return arguments.length==2&&!B["in"](F,E)};B.all=function(I,H){if(arguments.length<2){return false}if(!(H instanceof Array)){return false}var G;for(var F=0;F<I.length;F++){G=false;for(var E=0;E<H.length;E++){if(B.eq(I[F],H[E])){G=true;break}}if(!G){return false}}return true};B.exists=function(F,E){if(F===true){return arguments.length==2}else{if(F===false){return arguments.length==1}}return false};var C=function(E){return function(F){if(arguments.length>0){return B[""](E,F)}else{return B[""](E)}}};var A=function(F){var E=[];F.listen=function(H,G){if(!(H instanceof Function)){H=C(H)}E.push({filter:H,handler:G});return F};F.call=function(H){for(var G=0;G<E.length;G++){if(E[G].filter.apply(this,arguments)){E[G].handler(H)}}return F}};D.extend=function(E){new A(E);return E};D.extend(D)})();var IETransport=function(B,C,A){this.peer=B;this.role=C;this.cfg=A||{};this.net={};this.listen={toOuter:function(){},toInner:function(){}};this.connect()};IETransport.prototype={connect:function(){var D=this;if(this.role=="outer"){try{this.net=this.peer.opener=this.listen}catch(B){var C=window.setInterval(function(){if(D.peer.opener){D.peer.opener=D.listen;D.net=D.peer.opener;window.clearInterval(C)}},100)}}if(this.role=="inner"){if(window.opener){this.net=window.opener}else{var A=window.setInterval(function(){if(window.opener){D.net=window.opener;window.clearInterval(A)}},100)}}},send:function(A){if(this.role=="inner"){this.net.toInner(A)}if(this.role=="outer"){this.net.toOuter(A)}},register:function(D){var C=this;if(this.role=="inner"){try{this.net=window.opener;this.net.toOuter=D}catch(A){var B=window.setInterval(function(){C.net=window.opener;if(C.net){C.net.toOuter=D;window.clearInterval(B)}},100)}}if(this.role=="outer"){try{this.net.toInner=D}catch(A){}}}};var NativeMessageTransport=function(B,C,D,A){this.peerDomain=B||"*";this.peer=C||{};this.role=D||"";this.config=A||{};this.receiver=function(){};this._connect()};NativeMessageTransport.prototype={_connect:function(){var A=this;var B=window.postMessage?window:document;baidu.on(B,"message",function(E){E=B.event||E;var C=E.origin;if(A.config.origin&&A.config.origin!=C){throw Error("CrossPageChannel: No secure origin")}else{var D=E.data;A.receiver(baidu.json.decode(D))}})},send:function(C){var B=this.peer;var A=B.postMessage?B:B.document;A.postMessage(baidu.json.encode(C),this.peerDomain)},register:function(A){this.receiver=A}};var IframeRelayTransport=function(B,C,A){this.relayURI=B;this.role=C;this.config=A||{};this.relayIframe=null;this.receiver=null;this.connect()};IframeRelayTransport.prototype={connect:function(){var B=this;var C=document.createElement("div");C.innerHTML='<iframe src=""></iframe>';this.relayIframe=C.childNodes[0];C=null;var A=this.relayIframe.style;A.visibility="hidden";A.width=A.height="0px";A.position="absolute";window.xpcRelay=function(D){B.receiver(baidu.json.decode(D))}},send:function(B){var A=this.relayURI;A+="#"+encodeURIComponent(baidu.json.encode(B));this.relayIframe.src=A;document.body.appendChild(this.relayIframe)},register:function(A){this.receiver=A}};var CrossPageChannel=function(A){this.config=A||{};this.transport=null;this.peerWindowObject=null;this.iframeElement=null;this.listener={};this.sendBuffer=[];this.sendFlag=0;this.maxSegment=10000;this.pingTimeout=0.1*1000;this.pingTimer=null;this.receiveAssemble=[];this.ready=false;this._connect()};CrossPageChannel.prototype={_connect:function(){var B=this;if(!this.config.iframeId){this.peerWindowObject=window.parent}if(this.config.iframeId){var A=this.config.iframeId;this.iframeElement=document.getElementById(A);if(this.iframeElement){B.peerWindowObject=B.iframeElement.contentWindow;if(!B.peerWindowObject){B.peerWindowObject=window.frames[A]}}}this._createTransport();this._ping()},_ping:function(D){D=D||0;var B=this,A={port:"_ping",ack:0,seq:0,content:""};try{if(D%50==0){webim.Logger.report({debug:1,xpcPing:1,count:D})}this.transport.send(A)}catch(C){webim.Logger.report({info:1,xpcPingError:1,e:baidu.json.encode(C),role:this._getRole()})}finally{if(D<100){this.pingTimer=setTimeout(function(){if(!B.ready){B._ping(++D)}},this.pingTimeout)}else{webim.Logger.report({error:1,xpcInitFailed:1,count:D,role:this._getRole()})}}},_getRole:function(){return window.parent==this.peerWindowObject?"inner":"outer"},_createTransport:function(){var A=this;if(window.postMessage||document.postMessage){this.transport=new NativeMessageTransport(this.config.peerURI,this.peerWindowObject,this._getRole(),A.config)}else{if(baidu.ie&&baidu.ie<=7){if(this._getRole()=="outer"){this.transport=new IETransport(window.frames[this.config.iframeId],this._getRole(),{})}else{this.transport=new IETransport(window.frames[this.config.iframeId],this._getRole(),{})}}else{this.maxSegment=2000;this.transport=new IframeRelayTransport(this.config.relayURI,this._getRole(),{})}}this.transport.register(function(B){A._receiver(A,B)})},_receiver:function(F,G){var C=G.port;var H=G.ack;var B=G.seq;var E=G.content;if(H==2){if(!F.ready){F.ready=true;clearTimeout(F.pingTimer);F.pingTimer=null}F._send()}if(H==0){var A={port:"_self",ack:2,seq:0,content:""};F.transport.send(A);if(B>0){F.receiveAssemble.push(E)}if(B==0){if(F.listener[C]){F.listener[C](E)}}if(B==-1){F.receiveAssemble.push(E);var D=F.receiveAssemble.join("");F.receiveAssemble=[];if(F.listener[C]){F.listener[C](D)}}}},_send:function(){if(!this.ready){return }if(this.sendBuffer.length>0){this.sendFlag=1;var A=this.sendBuffer.shift();this.transport.send(A)}else{this.sendFlag=0}},send:function(B,E){var G=Math.ceil(E.length/this.maxSegment);if(G>1){for(var D=0;D<G;D++){var C=E.substring(D*this.maxSegment,(D+1)*this.maxSegment);var A=D+1;if(D==G-1){A=-1}var F={port:B,ack:0,seq:A,content:C};this.sendBuffer.push(F)}}else{var F={port:B,ack:0,seq:0,content:E};this.sendBuffer.push(F)}if(this.sendFlag==0){this._send()}},register:function(A,B){this.listener[A]=B},unRegister:function(A){delete this.listener[A]}};(function(){var E;var C=function(G){return"PS"+G.replace(/_/g,"__").replace(/ /g,"_s")};var B={searchList:["userData","localStorage","cookie"],methods:["init","get","set","remove"],status:{SUCCESS:0,FAILURE:1,OVERFLOW:2,FATAL:3},option:{}};var D={localStorage:{size:10*1024*1024,test:function(){return window.localStorage?true:false},methods:{init:function(){this.store=window.localStorage},expand:function(G){return C(this.name)+C(G)},set:function(I,M,K,J){var G=B.status.SUCCESS;I=this.expand(I);var L;if(J&&J.expires){L=J.expires+"|"+M}else{L="0|"+M}try{this.store.setItem(I,L)}catch(H){G=B.status.OVERFLOW;webim.Logger.report({error:1,storageError:1,method:"set",storage:"localStorage",e:baidu.json.encode(H),key:I,valueLength:M?M.length:0,username:username,guid:guid})}if(K){K.call(this,G,M)}},get:function(J,K){var G=B.status.SUCCESS;J=this.expand(J);try{var L=this.store.getItem(J);if(L==null){G=B.status.FAILURE}else{var N=L.indexOf("|");var M=L.substring(0,N);var H=(new Date()).getTime();if(M>H||M=="0"){L=L.substring(N+1,L.length)}else{L=null;this.store.removeItem(J);G=B.status.FAILURE}}}catch(I){G=B.status.FATAL;webim.Logger.report({error:1,storageError:1,method:"get",storage:"localStorage",e:baidu.json.encode(I),key:J,username:username,guid:guid})}if(K){K.call(this,G,L)}},remove:function(I,J){var G=B.status.SUCCESS;var K=null;I=this.expand(I);try{var L=this.store.getItem(I);var M=L.indexOf("|");K=L.substring(M+1,L.length);if(L==null){G=B.status.FAILURE}else{this.store.removeItem(I)}}catch(H){G=B.status.FATAL;webim.Logger.report({error:1,storageError:1,method:"remove",storage:"localStorage",e:baidu.json.encode(H),key:I,username:username,guid:guid})}if(J){J.call(this,G,K)}}}},userData:{size:64*1024,test:function(){return window.ActiveXObject?true:false},methods:{init:function(){var H="_storage_data_";var I=H+C(this.name);this.el=document.createElement("div");this.el.id=I;this.el.style.display="none";this.el.addBehavior("#default#userData");document.body.insertBefore(this.el,document.body.firstChild);var G=this;baidu.on(window,"unload",function(){G.el=null})},expand:function(G){return C(this.name)+C(G)},set:function(I,M,K,J){I=this.expand(I);var G=B.status.SUCCESS;try{var L;if(J&&J.expires){this.el.expires=(new Date(J.expires+8*60*60*1000)).toUTCString();L=J.expires+"|"+M}else{L="0|"+M}this.el.setAttribute(I,L);this.el.save(I)}catch(H){G=B.status.OVERFLOW;webim.Logger.report({error:1,storageError:1,method:"set",storage:"userData",e:baidu.json.encode(H),key:I,valueLength:M?M.length:0,username:username,guid:guid});M=null}if(K){K.call(this,G,M)}},get:function(J,K){J=this.expand(J);var G=B.status.SUCCESS;try{this.el.load(J);var L=this.el.getAttribute(J);if(L){var N=L.indexOf("|");var M=L.substring(0,N);var H=(new Date()).getTime();if(M>H||M=="0"){L=L.substring(N+1,L.length)}else{L=null;G=B.status.FAILURE}}if(L==null){G=B.status.FAILURE;this.remove(J)}}catch(I){G=B.status.FATAL;webim.Logger.report({error:1,storageError:1,method:"get",storage:"userData",e:baidu.json.encode(I),key:J,username:username,guid:guid})}if(K){K.call(this,G,L)}},remove:function(I,J){I=this.expand(I);var G=B.status.SUCCESS;var K=null;try{this.el.load(I);K=this.el.getAttribute(I);if(K==null){G=B.status.FAILURE}else{var L=K.indexOf("|");K=K.substring(L+1,K.length);this.el.expires=new Date(315532799000).toUTCString();this.el.removeAttribute(I);this.el.save(I)}}catch(H){G=B.status.FAILURE;webim.Logger.report({error:1,storageError:1,method:"remove",storage:"userData",e:baidu.json.encode(H),key:I,username:username,guid:guid})}if(J){J.call(this,G,K)}}}},cookie:{size:4*1024,test:function(){return true},methods:{expand:function(G){return this.name+G},get:function(H,I){var G=B.status.SUCCESS;H=this.expand(H);var J=baidu.cookie.get(H);if(J==null){G=B.status.FAILURE}if(I){I.call(this,G,J)}},set:function(H,K,J,I){var G=B.status.SUCCESS;H=this.expand(H);if(I&&I.expires){I.expires=new Date(expires)}baidu.cookie.set(H,K,I);if(J){J.call(this,G,K)}},remove:function(H,I){var G=B.status.SUCCESS;H=this.expand(H);var J=baidu.cookie.get(H);baidu.cookie.remove(H);if(J==null){G=B.status.FAILURE}if(I){I.call(this,G,J)}}}}};var F=function(){var J=function(){};A.type=null;A.size=-1;for(var I=0,H=B.methods.length;I<H;I++){A.Store.prototype[B.methods[I]]=J}if(B.option.backend){var G=B.option.backend;if(D[G]&&D[G].test()){A.type=G;A.size=D[G].size;for(key in D[G].methods){A.Store.prototype[key]=D[G].methods[key]}}else{for(var I=0,H=B.searchList.length;!A.type&&I<H;I++){var G=D[B.searchList[I]];if(G.test()){A.type=B.searchList[I];A.size=G.size;for(key in G.methods){A.Store.prototype[key]=G.methods[key]}}}}}else{for(var I=0,H=B.searchList.length;!A.type&&I<H;I++){var G=D[B.searchList[I]];if(G.test()){A.type=B.searchList[I];A.size=G.size;for(key in G.methods){A.Store.prototype[key]=G.methods[key]}}}}};var A={version:"1.0",type:null,size:-1,getSupportList:function(){var G=[];for(var I=0,H=B.searchList.length;I<H;I++){if(D[B.searchList[I]].test()){G.push(B.searchList[I])}}return G},Store:function(G,I){var H=/^[a-z][a-z0-9_ -]+$/i;if(!H.exec(G)){throw new Error("Invalid name")}if(!A.type){throw new Error("No suitable storage found")}this.name=G;B.option=I||{};B.option.domain=I.domain||location.hostname||"localhost.localdomain";B.option.expires=B.option.expires||365*2;B.option.path=B.option.path||"/";this.init()},set:function(G,J,I,H){if(!E){E=new baidu.more.storage.Store("fastmulan",{})}E.set(G,J,I,H)},get:function(G,I,H){if(!E){E=new baidu.more.storage.Store("fastmulan",{})}E.get(G,I,H)},remove:function(G,H){if(!E){E=new baidu.more.storage.Store("fastmulan",{})}E.remove(G,H)}};F();baidu.lang.module("more.storage",A,baidu)})();(function(){var L=0,F={},C,M,K,N,D;function O(R,Q,S,T){S=S||{};M=R;K=Q;N=S.observeInterval||1*1000;D=S.maxLength||100;C=S.syncKey||"systemsync";syncPort=S.syncPort||1002;H(function(){if(M){M.register(syncPort,function(U){switch(U.method){case"send":case"call":P(U.key,U.value);break;case"register":case"listen":G(U.key,function(V){M.send(syncPort,{callback:U.callback,value:V})});break}})}I();if(T){T()}})}var J=0;function I(){J++;setTimeout(function(){K.get(C,function(Q,S){if(Q==0||Q==1){try{if(S){var U=baidu.json.decode(S);var R=U.length>0?U[0][0]:0;E(U,R)}}catch(T){webim.Logger.report({error:1,syncObserveError:1,e:baidu.json.encode(T)})}finally{I()}}else{webim.Logger.report({error:1,syncError:1,count:J})}})},N)}function E(W,T){if(T>L){var Q=T-L;if(Q<D){for(var R=Q-1;R>=0;R--){var Y=W[R];if(Y){var U=Y[1],X=Y[2];var S=F[U];if(S){try{S(X)}catch(V){}}}else{webim.Logger.report({error:1,syncLost:1,lostByRescueFragment:1})}}}else{webim.Logger.report({error:1,syncLost:Q-D});for(var R=D-1;R>=0;R--){var Y=W[R];var U=Y[1],X=Y[2];var S=F[U];if(S){try{S(X)}catch(V){}}}}L=T}else{}}function H(Q){K.get(C,function(R,S){if(S){var T=baidu.json.decode(S);L=T.length>0?T[0][0]:0;Q()}else{Q()}})}function P(Q,R){K.get(C,function(S,T){var W=[];if(T){W=baidu.json.decode(T)}var V=W.length>0?(W[0][0]):0;var U=V+1;E(W,V);L=U;W.unshift([U,Q,R]);W=W.slice(0,D);K.set(C,baidu.json.encode(W),function(X,Y){if(X==2||X==3){webim.Logger.report({info:1,syncSetError:1,key:Q,valueLength:Y?Y.length:0,arrayLength:W?W.length:0,arrayByteLength:W?W.join("").length:0,status:X})}if(X==2){W=[W[0]];K.set(C,baidu.json.encode(W),function(Z,a){if(Z==0||Z==1){webim.Logger.report({info:1,syncSetRescueOK:1,key:Q,valueLength:a?a.length:0,arrayLength:W?W.length:0,arrayByteLength:W?W.join("").length:0,status:Z})}else{if(Z==2||Z==3){webim.Logger.report({error:1,syncSetRescueError:1,key:Q,valueLength:a?a.length:0,arrayLength:W?W.length:0,arrayByteLength:W?W.join("").length:0,status:Z})}}})}})})}function G(Q,R){F[Q]=R}function B(Q){if(F[Q]){delete F[Q]}}var A={init:O,call:P,listen:G,unListen:B,send:P,register:G,unRegister:B,getMaxIndex:function(){return L}};baidu.lang.module("more.sync",A,baidu)})();